

============================== 2023-04-14 11:25:43.398351 | 5ed58607-38cf-40af-9569-9286d04034b1 ==============================
[0m11:25:43.398351 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:25:43.401000 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:25:43.401393 [debug] [MainThread]: Tracking: tracking
[0m11:25:43.409390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a4be66e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a4be4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a4be51e0>]}
[0m11:25:43.426576 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:25:43.427522 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:25:43.429164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5ed58607-38cf-40af-9569-9286d04034b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a4be4430>]}
[0m11:25:44.195435 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m11:25:44.257585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ed58607-38cf-40af-9569-9286d04034b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a4910a30>]}
[0m11:25:44.263682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ed58607-38cf-40af-9569-9286d04034b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a4be5510>]}
[0m11:25:44.264114 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:25:44.264552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ed58607-38cf-40af-9569-9286d04034b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a498e200>]}
[0m11:25:44.265760 [info ] [MainThread]: 
[0m11:25:44.267911 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:25:44.269589 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:25:44.270079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:45.603639 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:25:45.604387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:25:45.920495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ed58607-38cf-40af-9569-9286d04034b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a4a01930>]}
[0m11:25:45.921444 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:25:45.922380 [info ] [MainThread]: 
[0m11:25:45.927721 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m11:25:45.928283 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m11:25:45.929123 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m11:25:45.929498 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m11:25:45.932370 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m11:25:45.933604 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-04-14 11:25:45.929716 => 2023-04-14 11:25:45.933517
[0m11:25:45.934027 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m11:25:45.951792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:25:46.297238 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m11:25:46.299068 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club.coffee_shop.orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club.coffee_shop.customers` as customers 
left join customer_orders
    on customer_id = customer_orders.customer_id
    );
  
[0m11:30:50.805594 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club.coffee_shop.orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club.coffee_shop.customers` as customers 
left join customer_orders
    on customer_id = customer_orders.customer_id
    );
  
[0m11:30:50.806730 [debug] [Thread-1 (]: BigQuery adapter: Operation did not complete within the designated timeout of 300 seconds.
[0m11:30:50.807382 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-04-14 11:25:45.934396 => 2023-04-14 11:30:50.807260
[0m11:30:50.811060 [debug] [Thread-1 (]: Runtime Error in model customers (models/customers.sql)
  Operation did not complete within the designated timeout of 300 seconds.
[0m11:30:50.811553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ed58607-38cf-40af-9569-9286d04034b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a493a4d0>]}
[0m11:30:50.812127 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_kimwkho.customers .................... [[31mERROR[0m in 304.88s]
[0m11:30:50.814899 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m11:30:50.816851 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:30:50.817509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:50.817771 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m11:30:50.817999 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m11:30:50.818281 [info ] [MainThread]: 
[0m11:30:50.818640 [info ] [MainThread]: Finished running 1 table model in 0 hours 5 minutes and 6.55 seconds (306.55s).
[0m11:30:50.819083 [debug] [MainThread]: Command end result
[0m11:30:50.826775 [info ] [MainThread]: 
[0m11:30:50.827424 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:30:50.827961 [info ] [MainThread]: 
[0m11:30:50.828705 [error] [MainThread]: [33mRuntime Error in model customers (models/customers.sql)[0m
[0m11:30:50.829274 [error] [MainThread]:   Operation did not complete within the designated timeout of 300 seconds.
[0m11:30:50.830017 [info ] [MainThread]: 
[0m11:30:50.830572 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:30:50.831369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a494e200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a4910a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f90a49106a0>]}
[0m11:30:50.831943 [debug] [MainThread]: Flushing usage events


============================== 2023-04-14 11:35:29.253078 | 15b73c57-0187-48f0-96eb-5afdf5141843 ==============================
[0m11:35:29.253078 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:35:29.256596 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:35:29.257148 [debug] [MainThread]: Tracking: tracking
[0m11:35:29.259768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9180ec100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9180ed7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9180ed450>]}
[0m11:35:29.275747 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:35:29.287124 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:35:29.298561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '15b73c57-0187-48f0-96eb-5afdf5141843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9180ec2e0>]}
[0m11:35:30.060547 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m11:35:30.113862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15b73c57-0187-48f0-96eb-5afdf5141843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9180ae140>]}
[0m11:35:30.120479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15b73c57-0187-48f0-96eb-5afdf5141843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff917af2320>]}
[0m11:35:30.121112 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:35:30.121857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b73c57-0187-48f0-96eb-5afdf5141843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff91805b280>]}
[0m11:35:30.123102 [info ] [MainThread]: 
[0m11:35:30.125308 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:35:30.126749 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:35:30.127260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:31.551032 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:35:31.551839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:31.873396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b73c57-0187-48f0-96eb-5afdf5141843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff917af27a0>]}
[0m11:35:31.874295 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:35:31.874807 [info ] [MainThread]: 
[0m11:35:31.879590 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m11:35:31.880080 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m11:35:31.880829 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m11:35:31.881156 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m11:35:31.884014 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m11:35:31.884875 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-04-14 11:35:31.881445 => 2023-04-14 11:35:31.884765
[0m11:35:31.885351 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m11:35:31.908559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:32.216235 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m11:35:32.217482 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club.coffee_shop.orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club.coffee_shop.customers` as customers 
left join customer_orders
    on customer_id = customer_orders.customer_id
    );
  
[0m11:43:06.949916 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Query exceeded resource limits. This query used 676120 CPU seconds but would charge only 22M Analysis bytes. This exceeds the ratio supported by the on-demand pricing model. Please consider moving this workload to the flat-rate reservation pricing model, which does not have this limit. 676120 CPU seconds were used, and this query must use less than 5600 CPU seconds.')
[0m11:50:15.005482 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:867c2e0c-80ff-464c-a095-efb8d6054145&page=queryresults
[0m11:50:15.006683 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-04-14 11:35:31.885640 => 2023-04-14 11:50:15.006569
[0m11:50:15.009836 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Query exceeded resource limits. This query used 673506 CPU seconds but would charge only 22M Analysis bytes. This exceeds the ratio supported by the on-demand pricing model. Please consider moving this workload to the flat-rate reservation pricing model, which does not have this limit. 673506 CPU seconds were used, and this query must use less than 5600 CPU seconds.
  compiled Code at target/run/coffee_shop_kimwkho/models/customers.sql
[0m11:50:15.010379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b73c57-0187-48f0-96eb-5afdf5141843', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9180a0c40>]}
[0m11:50:15.011026 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model dbt_kimwkho.customers .................... [[31mERROR[0m in 883.13s]
[0m11:50:15.013121 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m11:50:15.014977 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:50:15.015596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:15.015835 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m11:50:15.016149 [info ] [MainThread]: 
[0m11:50:15.016592 [info ] [MainThread]: Finished running 1 table model in 0 hours 14 minutes and 44.89 seconds (884.89s).
[0m11:50:15.017241 [debug] [MainThread]: Command end result
[0m11:50:15.024734 [info ] [MainThread]: 
[0m11:50:15.025251 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:50:15.025722 [info ] [MainThread]: 
[0m11:50:15.026202 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m11:50:15.026703 [error] [MainThread]:   Query exceeded resource limits. This query used 673506 CPU seconds but would charge only 22M Analysis bytes. This exceeds the ratio supported by the on-demand pricing model. Please consider moving this workload to the flat-rate reservation pricing model, which does not have this limit. 673506 CPU seconds were used, and this query must use less than 5600 CPU seconds.
[0m11:50:15.027151 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/customers.sql
[0m11:50:15.027634 [info ] [MainThread]: 
[0m11:50:15.028134 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:50:15.028736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff917ff0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9180a0130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9180a16f0>]}
[0m11:50:15.029083 [debug] [MainThread]: Flushing usage events


============================== 2023-04-14 13:20:45.354947 | d2a00ed8-7064-4046-88fc-4cbf787f7f7b ==============================
[0m13:20:45.354947 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:20:45.367979 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'exclude': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:20:45.368379 [debug] [MainThread]: Tracking: tracking
[0m13:20:45.375800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ee95600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ee950c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ee955a0>]}
[0m13:20:45.416186 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:20:45.620456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:20:45.620943 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:20:45.627328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2a00ed8-7064-4046-88fc-4cbf787f7f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ec509d0>]}
[0m13:20:45.639309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2a00ed8-7064-4046-88fc-4cbf787f7f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ec18e80>]}
[0m13:20:45.639759 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:20:45.640209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2a00ed8-7064-4046-88fc-4cbf787f7f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb171e5ab60>]}
[0m13:20:45.641508 [info ] [MainThread]: 
[0m13:20:45.642203 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:20:45.642957 [debug] [MainThread]: Command end result
[0m13:20:45.648592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ec18ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ec18280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb16ec180d0>]}
[0m13:20:45.649037 [debug] [MainThread]: Flushing usage events


============================== 2023-04-14 13:22:41.314056 | 065c977f-829c-4b38-9c4e-43f0b2e7f4bd ==============================
[0m13:22:41.314056 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:22:41.316611 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'exclude': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:22:41.317099 [debug] [MainThread]: Tracking: tracking
[0m13:22:41.321863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36cddd000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36cddc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36cddcfa0>]}
[0m13:22:41.336558 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:22:41.386840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:22:41.387790 [debug] [MainThread]: Partial parsing: added file: coffee_shop_kimwkho://models/monthly_customers.sql
[0m13:22:41.402291 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
[0m13:22:41.423629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '065c977f-829c-4b38-9c4e-43f0b2e7f4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36c5f6530>]}
[0m13:22:41.491029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '065c977f-829c-4b38-9c4e-43f0b2e7f4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36cd5b3a0>]}
[0m13:22:41.491670 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:22:41.492176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065c977f-829c-4b38-9c4e-43f0b2e7f4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36fd00790>]}
[0m13:22:41.493896 [info ] [MainThread]: 
[0m13:22:41.496250 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:22:41.497991 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:22:41.498654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:47.124528 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m13:22:47.125206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:47.426127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '065c977f-829c-4b38-9c4e-43f0b2e7f4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36fdea560>]}
[0m13:22:47.427190 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:22:47.427763 [info ] [MainThread]: 
[0m13:22:47.450958 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m13:22:47.451629 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m13:22:47.452855 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m13:22:47.453219 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m13:22:47.456243 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m13:22:47.456847 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-04-14 13:22:47.453665 => 2023-04-14 13:22:47.456745
[0m13:22:47.457207 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m13:22:47.487734 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m13:22:47.488528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:22:47.489319 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as elect
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students.dbt_kimwkho.customers`
 
group by 1;


[0m13:22:47.826369 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "elect" at [6:6]')
[0m13:22:48.246435 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0aa64336-d990-4e33-88c7-3506bfa59827&page=queryresults
[0m13:22:48.248505 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-04-14 13:22:47.457448 => 2023-04-14 13:22:48.248343
[0m13:22:48.287465 [debug] [Thread-1 (]: Database Error in model monthly_customers (models/monthly_customers.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "elect" at [6:6]
  compiled Code at target/run/coffee_shop_kimwkho/models/monthly_customers.sql
[0m13:22:48.288002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '065c977f-829c-4b38-9c4e-43f0b2e7f4bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36cba0220>]}
[0m13:22:48.288589 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.monthly_customers ............. [[31mERROR[0m in 0.84s]
[0m13:22:48.291024 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m13:22:48.293158 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:22:48.293873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:48.294136 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m13:22:48.294471 [info ] [MainThread]: 
[0m13:22:48.295140 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m13:22:48.295917 [debug] [MainThread]: Command end result
[0m13:22:48.310072 [info ] [MainThread]: 
[0m13:22:48.310841 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:22:48.311487 [info ] [MainThread]: 
[0m13:22:48.312487 [error] [MainThread]: [33mDatabase Error in model monthly_customers (models/monthly_customers.sql)[0m
[0m13:22:48.313092 [error] [MainThread]:   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "elect" at [6:6]
[0m13:22:48.313727 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/monthly_customers.sql
[0m13:22:48.314686 [info ] [MainThread]: 
[0m13:22:48.315360 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:22:48.316440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36fdea560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36e7f38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa36cd5b250>]}
[0m13:22:48.316879 [debug] [MainThread]: Flushing usage events


============================== 2023-04-14 13:23:02.735166 | fed4b7ce-5efb-47e8-b632-479a1e2ce31e ==============================
[0m13:23:02.735166 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:23:02.739354 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'exclude': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:23:02.740719 [debug] [MainThread]: Tracking: tracking
[0m13:23:02.751271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d05be1120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d05be05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d05be10c0>]}
[0m13:23:02.766811 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:23:02.797712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:23:02.798222 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/monthly_customers.sql
[0m13:23:02.810951 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
[0m13:23:02.833864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fed4b7ce-5efb-47e8-b632-479a1e2ce31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d053f67a0>]}
[0m13:23:02.927451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fed4b7ce-5efb-47e8-b632-479a1e2ce31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d05b627a0>]}
[0m13:23:02.928012 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:23:02.928481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed4b7ce-5efb-47e8-b632-479a1e2ce31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d05b1b670>]}
[0m13:23:02.929986 [info ] [MainThread]: 
[0m13:23:02.932693 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:02.933879 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:23:02.934516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:04.150017 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m13:23:04.150589 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:04.485871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed4b7ce-5efb-47e8-b632-479a1e2ce31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d05b620e0>]}
[0m13:23:04.486934 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:23:04.487513 [info ] [MainThread]: 
[0m13:23:04.493482 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m13:23:04.494035 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m13:23:04.495032 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m13:23:04.495393 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m13:23:04.497114 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m13:23:04.498088 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-04-14 13:23:04.495652 => 2023-04-14 13:23:04.498004
[0m13:23:04.498418 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m13:23:04.528391 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m13:23:04.529183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:04.529907 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students.dbt_kimwkho.customers`
 
group by 1;


[0m13:23:05.326251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f8c2d661-f071-4af0-b262-ea07cd81dd27&page=queryresults
[0m13:23:05.343988 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-04-14 13:23:04.498649 => 2023-04-14 13:23:05.343915
[0m13:23:05.344853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed4b7ce-5efb-47e8-b632-479a1e2ce31e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d059b1570>]}
[0m13:23:05.345481 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m13:23:05.347987 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m13:23:05.349986 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:05.350590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:05.350836 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m13:23:05.351137 [info ] [MainThread]: 
[0m13:23:05.351661 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m13:23:05.352259 [debug] [MainThread]: Command end result
[0m13:23:05.366611 [info ] [MainThread]: 
[0m13:23:05.367176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:05.367729 [info ] [MainThread]: 
[0m13:23:05.368270 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:23:05.369298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d08b55240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d05cbf850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d059c9ff0>]}
[0m13:23:05.369778 [debug] [MainThread]: Flushing usage events


============================== 2023-04-14 13:23:49.089925 | 765c7866-aa83-4063-8ae4-bb38f4fd5f47 ==============================
[0m13:23:49.089925 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:23:49.094377 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'exclude': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:23:49.095341 [debug] [MainThread]: Tracking: tracking
[0m13:23:49.104421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8025fedb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8025fed150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8025feeaa0>]}
[0m13:23:49.119572 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:23:49.154306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:23:49.154665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:23:49.160568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '765c7866-aa83-4063-8ae4-bb38f4fd5f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8025fb4d90>]}
[0m13:23:49.167814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '765c7866-aa83-4063-8ae4-bb38f4fd5f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8025f7d2a0>]}
[0m13:23:49.168255 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:23:49.168693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765c7866-aa83-4063-8ae4-bb38f4fd5f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8025f7d2d0>]}
[0m13:23:49.171149 [info ] [MainThread]: 
[0m13:23:49.173268 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:49.174568 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:23:49.175157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:50.318677 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m13:23:50.319334 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:50.654584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '765c7866-aa83-4063-8ae4-bb38f4fd5f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8025fec910>]}
[0m13:23:50.655757 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:23:50.656401 [info ] [MainThread]: 
[0m13:23:50.662259 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m13:23:50.662768 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m13:23:50.663856 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m13:23:50.664206 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m13:23:50.666356 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m13:23:50.666967 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-04-14 13:23:50.664446 => 2023-04-14 13:23:50.666865
[0m13:23:50.667376 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m13:23:50.764045 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m13:23:50.764932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:50.765779 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students.dbt_kimwkho.customers`
 
group by 1;


[0m13:23:51.625373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e09e4012-28c1-4649-ae5e-1b955e5fb725&page=queryresults
[0m13:23:51.651213 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-04-14 13:23:50.667607 => 2023-04-14 13:23:51.651132
[0m13:23:51.652165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '765c7866-aa83-4063-8ae4-bb38f4fd5f47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8025fb4130>]}
[0m13:23:51.652814 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m13:23:51.654923 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m13:23:51.657095 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:23:51.657839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:51.658149 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m13:23:51.658461 [info ] [MainThread]: 
[0m13:23:51.659041 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m13:23:51.659822 [debug] [MainThread]: Command end result
[0m13:23:51.666448 [info ] [MainThread]: 
[0m13:23:51.667367 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:51.668877 [info ] [MainThread]: 
[0m13:23:51.669838 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:23:51.670580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8026004220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8026004280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8026004190>]}
[0m13:23:51.670946 [debug] [MainThread]: Flushing usage events


============================== 2023-04-14 13:24:18.917539 | 8779becc-e547-46a4-8bd8-b3ff439bbbff ==============================
[0m13:24:18.917539 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:24:18.920303 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'exclude': ['customers.sql'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:24:18.920842 [debug] [MainThread]: Tracking: tracking
[0m13:24:18.926083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4866f9180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4866f8640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4866f9150>]}
[0m13:24:18.941675 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:24:18.997192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:24:18.998941 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/monthly_customers.sql
[0m13:24:19.026613 [debug] [MainThread]: 1699: static parser successfully parsed monthly_customers.sql
[0m13:24:19.050450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8779becc-e547-46a4-8bd8-b3ff439bbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc486102740>]}
[0m13:24:19.117156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8779becc-e547-46a4-8bd8-b3ff439bbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc486876740>]}
[0m13:24:19.117831 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:24:19.118333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8779becc-e547-46a4-8bd8-b3ff439bbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc48981c790>]}
[0m13:24:19.120052 [info ] [MainThread]: 
[0m13:24:19.122825 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:24:19.127210 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:24:19.128660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:20.375338 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m13:24:20.376053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:20.687332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8779becc-e547-46a4-8bd8-b3ff439bbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc486c44700>]}
[0m13:24:20.688333 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:24:20.689297 [info ] [MainThread]: 
[0m13:24:20.694561 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m13:24:20.695089 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m13:24:20.696033 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m13:24:20.696380 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m13:24:20.699709 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m13:24:20.700496 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-04-14 13:24:20.696618 => 2023-04-14 13:24:20.700412
[0m13:24:20.700877 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m13:24:20.729967 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m13:24:20.730846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:20.731578 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students`.`dbt_kimwkho`.`customers`
 
group by 1;


[0m13:24:21.541034 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7d7de2f1-dd7f-4c2a-856d-adb7750d963c&page=queryresults
[0m13:24:21.559508 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-04-14 13:24:20.701108 => 2023-04-14 13:24:21.559437
[0m13:24:21.560333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8779becc-e547-46a4-8bd8-b3ff439bbbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4866c9510>]}
[0m13:24:21.560910 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m13:24:21.563130 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m13:24:21.565341 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:24:21.565968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:21.566215 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m13:24:21.566529 [info ] [MainThread]: 
[0m13:24:21.567047 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m13:24:21.567641 [debug] [MainThread]: Command end result
[0m13:24:21.581380 [info ] [MainThread]: 
[0m13:24:21.581996 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:21.582457 [info ] [MainThread]: 
[0m13:24:21.582930 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:24:21.583579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4899eb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc489865db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4866def80>]}
[0m13:24:21.584040 [debug] [MainThread]: Flushing usage events


============================== 2023-04-14 13:28:02.442117 | 5dcc5db3-1b51-4fda-aed7-6ce1117176eb ==============================
[0m13:28:02.442117 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:28:02.444822 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:28:02.445583 [debug] [MainThread]: Tracking: tracking
[0m13:28:02.450006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde924f8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f1f47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f1f4370>]}
[0m13:28:02.466826 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:28:02.502404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:02.502836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:02.508825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dcc5db3-1b51-4fda-aed7-6ce1117176eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f1b9780>]}
[0m13:28:02.515278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dcc5db3-1b51-4fda-aed7-6ce1117176eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f0f1c30>]}
[0m13:28:02.515796 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:28:02.516311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dcc5db3-1b51-4fda-aed7-6ce1117176eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde924f8850>]}
[0m13:28:02.517926 [info ] [MainThread]: 
[0m13:28:02.520107 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:28:02.521832 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:28:02.522531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:03.790541 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m13:28:03.791237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:04.062211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dcc5db3-1b51-4fda-aed7-6ce1117176eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f173b80>]}
[0m13:28:04.063217 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:28:04.063773 [info ] [MainThread]: 
[0m13:28:04.068944 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m13:28:04.069510 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m13:28:04.070441 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m13:28:04.070770 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m13:28:04.073724 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m13:28:04.074424 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-04-14 13:28:04.070983 => 2023-04-14 13:28:04.074160
[0m13:28:04.074785 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m13:28:04.090097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:04.485982 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m13:28:04.487230 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club.coffee_shop.orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club.coffee_shop.customers` as customers 
left join customer_orders
    on customer_id = customer_orders.customer_id
    );
  
[0m13:37:56.983893 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club.coffee_shop.orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club.coffee_shop.customers` as customers 
left join customer_orders
    on customer_id = customer_orders.customer_id
    );
  
[0m13:37:56.984847 [debug] [Thread-1 (]: BigQuery adapter: Operation did not complete within the designated timeout of 600 seconds.
[0m13:37:56.985385 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-04-14 13:28:04.075238 => 2023-04-14 13:37:56.985291
[0m13:37:56.988439 [debug] [Thread-1 (]: Runtime Error in model customers (models/customers.sql)
  Operation did not complete within the designated timeout of 600 seconds.
[0m13:37:56.988878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dcc5db3-1b51-4fda-aed7-6ce1117176eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde91358310>]}
[0m13:37:56.989452 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_kimwkho.customers .................... [[31mERROR[0m in 592.92s]
[0m13:37:56.991592 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m13:37:56.992873 [debug] [Thread-3 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m13:37:56.993257 [info ] [Thread-3 (]: 2 of 2 SKIP relation dbt_kimwkho.monthly_customers ............................. [[33mSKIP[0m]
[0m13:37:56.993867 [debug] [Thread-3 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m13:37:56.995849 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:37:56.996609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:56.996847 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m13:37:56.997461 [info ] [MainThread]: 
[0m13:37:56.997889 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 9 minutes and 54.48 seconds (594.48s).
[0m13:37:56.998511 [debug] [MainThread]: Command end result
[0m13:37:57.005003 [info ] [MainThread]: 
[0m13:37:57.005532 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:37:57.005989 [info ] [MainThread]: 
[0m13:37:57.006471 [error] [MainThread]: [33mRuntime Error in model customers (models/customers.sql)[0m
[0m13:37:57.006980 [error] [MainThread]:   Operation did not complete within the designated timeout of 600 seconds.
[0m13:37:57.007436 [info ] [MainThread]: 
[0m13:37:57.008214 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m13:37:57.008819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde92365240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f173b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde8f173be0>]}
[0m13:37:57.009171 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 07:21:30.990612 | a15eeebd-572c-4d1c-9c32-a78cad004b89 ==============================
[0m07:21:30.990612 [info ] [MainThread]: Running with dbt=1.4.5
[0m07:21:30.997456 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:21:30.999165 [debug] [MainThread]: Tracking: tracking
[0m07:21:31.002634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2de3f1120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2de3f05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2de3f10c0>]}
[0m07:21:31.028569 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m07:21:31.204212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:21:31.204894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:21:31.213327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a15eeebd-572c-4d1c-9c32-a78cad004b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2de3b1120>]}
[0m07:21:31.221328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a15eeebd-572c-4d1c-9c32-a78cad004b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2de2ed5d0>]}
[0m07:21:31.221890 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m07:21:31.222433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a15eeebd-572c-4d1c-9c32-a78cad004b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e15179a0>]}
[0m07:21:31.224235 [info ] [MainThread]: 
[0m07:21:31.227331 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:21:31.228920 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m07:21:31.230039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:21:37.352900 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m07:21:37.354196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:21:37.676152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a15eeebd-572c-4d1c-9c32-a78cad004b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2de3f0250>]}
[0m07:21:37.678141 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m07:21:37.679004 [info ] [MainThread]: 
[0m07:21:37.722205 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m07:21:37.723413 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m07:21:37.726825 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m07:21:37.727411 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m07:21:37.734334 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m07:21:37.735736 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-04-17 07:21:37.727934 => 2023-04-17 07:21:37.735570
[0m07:21:37.736309 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m07:21:37.759022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:21:38.335869 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m07:21:38.337970 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club.coffee_shop.orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club.coffee_shop.customers` as customers 
left join customer_orders
    on customer_id = customer_orders.customer_id
    );
  
[0m07:22:01.745660 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m07:30:14.312564 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Query exceeded resource limits. This query used 755219 CPU seconds but would charge only 22M Analysis bytes. This exceeds the ratio supported by the on-demand pricing model. Please consider moving this workload to the flat-rate reservation pricing model, which does not have this limit. 755219 CPU seconds were used, and this query must use less than 5600 CPU seconds.')
[0m07:39:27.516589 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f3796aed-080a-4397-abf4-ec4c10718a35&page=queryresults
[0m07:39:27.518377 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-04-17 07:21:37.736709 => 2023-04-17 07:39:27.518191
[0m07:39:27.590022 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Query exceeded resource limits. This query used 760641 CPU seconds but would charge only 22M Analysis bytes. This exceeds the ratio supported by the on-demand pricing model. Please consider moving this workload to the flat-rate reservation pricing model, which does not have this limit. 760641 CPU seconds were used, and this query must use less than 5600 CPU seconds.
  compiled Code at target/run/coffee_shop_kimwkho/models/customers.sql
[0m07:39:27.591288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a15eeebd-572c-4d1c-9c32-a78cad004b89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2de253c70>]}
[0m07:39:27.592276 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_kimwkho.customers .................... [[31mERROR[0m in 1069.87s]
[0m07:39:27.596359 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m07:39:27.596951 [info ] [MainThread]: 
[0m07:39:27.597535 [info ] [MainThread]: [33mExited because of keyboard interrupt.[0m
[0m07:39:27.598096 [info ] [MainThread]: 
[0m07:39:27.598628 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m07:39:27.599208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:39:27.599771 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m07:39:27.600133 [info ] [MainThread]: 
[0m07:39:27.600866 [info ] [MainThread]: Finished running  in 0 hours 17 minutes and 56.38 seconds (1076.38s).
[0m07:39:27.601447 [debug] [MainThread]: Flushing usage events
[0m07:39:28.042226 [info ] [MainThread]: ctrl-c


============================== 2023-04-18 11:34:11.017088 | e9f4f71e-9f6e-4183-beae-744c1a3b2c3b ==============================
[0m11:34:11.017088 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:34:11.026606 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:34:11.027397 [debug] [MainThread]: Tracking: tracking
[0m11:34:11.039554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f488a22dd80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4886ff04c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4886ff0970>]}
[0m11:34:11.059200 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:34:11.165753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:11.166517 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/customers.sql
[0m11:34:11.179934 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m11:34:11.202633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9f4f71e-9f6e-4183-beae-744c1a3b2c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48869f00d0>]}
[0m11:34:11.283583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9f4f71e-9f6e-4183-beae-744c1a3b2c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f488716aad0>]}
[0m11:34:11.284183 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:34:11.284752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9f4f71e-9f6e-4183-beae-744c1a3b2c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4887123af0>]}
[0m11:34:11.286907 [info ] [MainThread]: 
[0m11:34:11.289102 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:34:11.290582 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:34:11.290995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:15.586908 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:34:15.587918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:15.942851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9f4f71e-9f6e-4183-beae-744c1a3b2c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4888bfb910>]}
[0m11:34:15.943937 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:34:15.944469 [info ] [MainThread]: 
[0m11:34:15.965735 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m11:34:15.966252 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m11:34:15.967103 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m11:34:15.967430 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m11:34:15.971071 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m11:34:15.971802 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-04-18 11:34:15.967639 => 2023-04-18 11:34:15.971694
[0m11:34:15.972220 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m11:34:15.986859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:16.321880 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m11:34:16.323031 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club.coffee_shop.orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club.coffee_shop.customers` as customers 
left join customer_orders
    on customers.customer_id = customer_orders.customer_id
    );
  
[0m11:34:17.248201 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name customer_id not found inside customers at [30:18]')
[0m11:34:18.385888 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1837d02b-33cb-417e-a37e-17b41c7206df&page=queryresults
[0m11:34:18.387747 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-04-18 11:34:15.972504 => 2023-04-18 11:34:18.387606
[0m11:34:18.421240 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Name customer_id not found inside customers at [30:18]
  compiled Code at target/run/coffee_shop_kimwkho/models/customers.sql
[0m11:34:18.422004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9f4f71e-9f6e-4183-beae-744c1a3b2c3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4886fb9630>]}
[0m11:34:18.422804 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dbt_kimwkho.customers .................... [[31mERROR[0m in 2.46s]
[0m11:34:18.425329 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m11:34:18.426760 [debug] [Thread-3 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m11:34:18.427342 [info ] [Thread-3 (]: 2 of 2 SKIP relation dbt_kimwkho.monthly_customers ............................. [[33mSKIP[0m]
[0m11:34:18.427882 [debug] [Thread-3 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m11:34:18.430392 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:34:18.431045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:18.431280 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m11:34:18.431553 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m11:34:18.431904 [info ] [MainThread]: 
[0m11:34:18.432332 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 7.14 seconds (7.14s).
[0m11:34:18.433271 [debug] [MainThread]: Command end result
[0m11:34:18.448501 [info ] [MainThread]: 
[0m11:34:18.449173 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:34:18.449794 [info ] [MainThread]: 
[0m11:34:18.450442 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m11:34:18.451483 [error] [MainThread]:   Name customer_id not found inside customers at [30:18]
[0m11:34:18.452005 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/customers.sql
[0m11:34:18.453051 [info ] [MainThread]: 
[0m11:34:18.453696 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:34:18.455322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4888bfb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48872caa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48875269b0>]}
[0m11:34:18.456554 [debug] [MainThread]: Flushing usage events


============================== 2023-04-18 11:34:35.004175 | 524f00a0-4732-443c-b24b-38d63abfc51b ==============================
[0m11:34:35.004175 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:34:35.009609 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:34:35.010164 [debug] [MainThread]: Tracking: tracking
[0m11:34:35.015945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a983cc850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a950ec310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a950ec580>]}
[0m11:34:35.031854 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:34:35.064526 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:34:35.065256 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/customers.sql
[0m11:34:35.078791 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m11:34:35.100804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '524f00a0-4732-443c-b24b-38d63abfc51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a94af00d0>]}
[0m11:34:35.190161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '524f00a0-4732-443c-b24b-38d63abfc51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a95266bf0>]}
[0m11:34:35.190934 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m11:34:35.191550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '524f00a0-4732-443c-b24b-38d63abfc51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a95222e90>]}
[0m11:34:35.194350 [info ] [MainThread]: 
[0m11:34:35.199391 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:34:35.200899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:34:35.201599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:34:36.902670 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:34:36.903310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:34:37.179751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '524f00a0-4732-443c-b24b-38d63abfc51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a96fcf9d0>]}
[0m11:34:37.181523 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:34:37.183217 [info ] [MainThread]: 
[0m11:34:37.203458 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m11:34:37.205186 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m11:34:37.207286 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m11:34:37.207616 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m11:34:37.212026 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m11:34:37.213083 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-04-18 11:34:37.207902 => 2023-04-18 11:34:37.212996
[0m11:34:37.213463 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m11:34:37.228155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:34:37.546375 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m11:34:37.547838 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club.coffee_shop.orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club.coffee_shop.customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id
    );
  
[0m11:34:43.063495 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8ca537cc-427a-4a04-aeff-314c3b1bd7db&page=queryresults
[0m11:34:43.080363 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-04-18 11:34:37.213742 => 2023-04-18 11:34:43.080279
[0m11:34:43.081255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524f00a0-4732-443c-b24b-38d63abfc51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a950b56c0>]}
[0m11:34:43.081866 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_kimwkho.customers ........................ [[32mCREATE TABLE (174.4k rows, 21.3 MB processed)[0m in 5.87s]
[0m11:34:43.083899 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m11:34:43.085184 [debug] [Thread-4 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m11:34:43.085641 [info ] [Thread-4 (]: 2 of 2 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m11:34:43.086589 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m11:34:43.086922 [debug] [Thread-4 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m11:34:43.095323 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m11:34:43.095879 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-04-18 11:34:43.087134 => 2023-04-18 11:34:43.095788
[0m11:34:43.096263 [debug] [Thread-4 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m11:34:43.121749 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m11:34:43.122701 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:34:43.123305 [debug] [Thread-4 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students`.`dbt_kimwkho`.`customers`
 
group by 1;


[0m11:34:43.960757 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:56adf86d-86db-488e-a67b-7241701d61d0&page=queryresults
[0m11:34:43.963896 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-04-18 11:34:43.096466 => 2023-04-18 11:34:43.963810
[0m11:34:43.965002 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '524f00a0-4732-443c-b24b-38d63abfc51b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9508d420>]}
[0m11:34:43.965755 [info ] [Thread-4 (]: 2 of 2 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m11:34:43.966896 [debug] [Thread-4 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m11:34:43.969351 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:34:43.969991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:34:43.970228 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m11:34:43.970425 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m11:34:43.970671 [info ] [MainThread]: 
[0m11:34:43.971526 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 8.77 seconds (8.77s).
[0m11:34:43.972437 [debug] [MainThread]: Command end result
[0m11:34:43.979697 [info ] [MainThread]: 
[0m11:34:43.980295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:34:43.980899 [info ] [MainThread]: 
[0m11:34:43.981573 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:34:43.984905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a952676d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a95632b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a96fcf9d0>]}
[0m11:34:43.985643 [debug] [MainThread]: Flushing usage events


============================== 2023-04-18 11:44:54.205734 | 6f778703-5d17-4498-922f-ddbcf81fc9a2 ==============================
[0m11:44:54.205734 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:44:54.208353 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:44:54.208706 [debug] [MainThread]: Tracking: tracking
[0m11:44:54.219254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcfae48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcfae4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcfae47f0>]}
[0m11:44:54.235402 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:44:54.277050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:44:54.277819 [debug] [MainThread]: Partial parsing: added file: coffee_shop_kimwkho://models/customers.yml
[0m11:44:54.278361 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/customers.sql
[0m11:44:54.293813 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m11:44:54.459364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcfe55a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcfe559f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8fcfe55a80>]}
[0m11:44:54.460001 [debug] [MainThread]: Flushing usage events
[0m11:44:54.891090 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop_kimwkho.customers' (models/customers.sql) depends on a node named 'orders' which was not found


============================== 2023-04-18 11:46:59.817645 | b22e755c-f51d-444a-aedf-4d6a62515013 ==============================
[0m11:46:59.817645 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:46:59.822192 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:46:59.822612 [debug] [MainThread]: Tracking: tracking
[0m11:46:59.829505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7066ff4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7066ff4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7066ff4f70>]}
[0m11:46:59.846329 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:46:59.880057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m11:46:59.880745 [debug] [MainThread]: Partial parsing: added file: coffee_shop_kimwkho://models/customers.yml
[0m11:46:59.881249 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/customers.sql
[0m11:46:59.894599 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m11:47:00.051529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b22e755c-f51d-444a-aedf-4d6a62515013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7066f7e230>]}
[0m11:47:00.058617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b22e755c-f51d-444a-aedf-4d6a62515013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7066f73fa0>]}
[0m11:47:00.059103 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m11:47:00.059541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b22e755c-f51d-444a-aedf-4d6a62515013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f706a162d40>]}
[0m11:47:00.060971 [info ] [MainThread]: 
[0m11:47:00.063270 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:47:00.064546 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:47:00.065198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:47:01.263015 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:47:01.263763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:47:01.545017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b22e755c-f51d-444a-aedf-4d6a62515013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7066f61630>]}
[0m11:47:01.546213 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:47:01.547447 [info ] [MainThread]: 
[0m11:47:01.557060 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m11:47:01.557932 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m11:47:01.558877 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m11:47:01.559225 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m11:47:01.563203 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m11:47:01.563800 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-04-18 11:47:01.559437 => 2023-04-18 11:47:01.563693
[0m11:47:01.564217 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m11:47:01.579307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:47:01.932473 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m11:47:01.933926 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club`.`coffee_shop`.`customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id
    );
  
[0m11:47:08.885168 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:03f60111-7d99-49ea-9543-0bcb4709e8fd&page=queryresults
[0m11:47:08.904255 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-04-18 11:47:01.564426 => 2023-04-18 11:47:08.904173
[0m11:47:08.905219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b22e755c-f51d-444a-aedf-4d6a62515013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7066f97d90>]}
[0m11:47:08.905891 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_kimwkho.customers ........................ [[32mCREATE TABLE (174.4k rows, 21.3 MB processed)[0m in 7.35s]
[0m11:47:08.907893 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m11:47:08.909315 [debug] [Thread-3 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m11:47:08.909883 [info ] [Thread-3 (]: 2 of 2 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m11:47:08.910832 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m11:47:08.911180 [debug] [Thread-3 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m11:47:08.914506 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m11:47:08.915325 [debug] [Thread-3 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-04-18 11:47:08.911378 => 2023-04-18 11:47:08.915248
[0m11:47:08.915691 [debug] [Thread-3 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m11:47:08.936181 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m11:47:08.937131 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:47:08.937629 [debug] [Thread-3 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students`.`dbt_kimwkho`.`customers`
 
group by 1;


[0m11:47:10.075889 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c4f56c06-cbad-4baa-891c-2bc642989573&page=queryresults
[0m11:47:10.078505 [debug] [Thread-3 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-04-18 11:47:08.915974 => 2023-04-18 11:47:10.078433
[0m11:47:10.079502 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b22e755c-f51d-444a-aedf-4d6a62515013', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7066f970a0>]}
[0m11:47:10.080135 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m11:47:10.080828 [debug] [Thread-3 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m11:47:10.083395 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:47:10.084258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:47:10.084500 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m11:47:10.084842 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m11:47:10.085201 [info ] [MainThread]: 
[0m11:47:10.085750 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 10.02 seconds (10.02s).
[0m11:47:10.086571 [debug] [MainThread]: Command end result
[0m11:47:10.098539 [info ] [MainThread]: 
[0m11:47:10.099120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:47:10.099715 [info ] [MainThread]: 
[0m11:47:10.100501 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:47:10.101288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7066ff7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70691582e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f706700ca00>]}
[0m11:47:10.101726 [debug] [MainThread]: Flushing usage events


============================== 2023-04-18 11:49:32.229477 | 072dd6f7-a651-44ca-8943-ffd76d79e627 ==============================
[0m11:49:32.229477 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:49:32.232588 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m11:49:32.233115 [debug] [MainThread]: Tracking: tracking
[0m11:49:32.241173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cccfd5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cccfd090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cccfd570>]}
[0m11:49:32.257686 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:49:32.291694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:49:32.292216 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:49:32.298756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '072dd6f7-a651-44ca-8943-ffd76d79e627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5cccce1a0>]}
[0m11:49:32.305979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '072dd6f7-a651-44ca-8943-ffd76d79e627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ccbee6b0>]}
[0m11:49:32.306439 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m11:49:32.306966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '072dd6f7-a651-44ca-8943-ffd76d79e627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ccbee6e0>]}
[0m11:49:32.308813 [info ] [MainThread]: 
[0m11:49:32.311062 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:49:32.313092 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:49:32.313940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:33.449032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '072dd6f7-a651-44ca-8943-ffd76d79e627', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ccbece20>]}
[0m11:49:33.450475 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:49:33.451212 [info ] [MainThread]: 
[0m11:49:33.498580 [debug] [Thread-1 (]: Began running node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m11:49:33.499739 [debug] [Thread-2 (]: Began running node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m11:49:33.499258 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m11:49:33.500724 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m11:49:33.501892 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d'
[0m11:49:33.503554 [debug] [Thread-1 (]: Began compiling node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m11:49:33.503016 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1'
[0m11:49:33.515318 [debug] [Thread-2 (]: Began compiling node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m11:49:33.545827 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d"
[0m11:49:33.642764 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1"
[0m11:49:33.644191 [debug] [Thread-1 (]: Timing info for test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d (compile): 2023-04-18 11:49:33.504005 => 2023-04-18 11:49:33.643438
[0m11:49:33.644939 [debug] [Thread-1 (]: Began executing node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m11:49:33.655891 [debug] [Thread-2 (]: Timing info for test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1 (compile): 2023-04-18 11:49:33.515669 => 2023-04-18 11:49:33.655805
[0m11:49:33.664937 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d"
[0m11:49:33.665442 [debug] [Thread-2 (]: Began executing node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m11:49:33.666140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:33.670317 [debug] [Thread-1 (]: On test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_kimwkho`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m11:49:33.669206 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1"
[0m11:49:33.672781 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:49:33.673237 [debug] [Thread-2 (]: On test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_kimwkho`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m11:49:35.635285 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e2d79a47-a32e-4918-83fc-c9bbd223781e&page=queryresults
[0m11:49:35.637539 [debug] [Thread-1 (]: Timing info for test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d (execute): 2023-04-18 11:49:33.645373 => 2023-04-18 11:49:35.637418
[0m11:49:35.638696 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 2.14s]
[0m11:49:35.644070 [debug] [Thread-1 (]: Finished running node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m11:49:35.847416 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:737a69b2-53ca-4a30-a66e-6427b9d2f83f&page=queryresults
[0m11:49:35.848389 [debug] [Thread-2 (]: Timing info for test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1 (execute): 2023-04-18 11:49:33.666392 => 2023-04-18 11:49:35.848285
[0m11:49:35.849335 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 2.35s]
[0m11:49:35.850413 [debug] [Thread-2 (]: Finished running node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m11:49:35.852561 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:49:35.853196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:35.853442 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m11:49:35.853638 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m11:49:35.854036 [info ] [MainThread]: 
[0m11:49:35.854665 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m11:49:35.855733 [debug] [MainThread]: Command end result
[0m11:49:35.864927 [info ] [MainThread]: 
[0m11:49:35.865683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:35.866593 [info ] [MainThread]: 
[0m11:49:35.867635 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:49:35.868459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ccd16d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ccd14eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5ccd15480>]}
[0m11:49:35.869032 [debug] [MainThread]: Flushing usage events


============================== 2023-04-18 11:50:09.106895 | e5441d67-eada-47dc-ab98-887a89b609cd ==============================
[0m11:50:09.106895 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:50:09.109567 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m11:50:09.109934 [debug] [MainThread]: Tracking: tracking
[0m11:50:09.118831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306e8831f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306e882c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306e880b20>]}
[0m11:50:09.135466 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:50:09.183617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:50:09.184364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:50:09.197847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5441d67-eada-47dc-ab98-887a89b609cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306e655cc0>]}
[0m11:50:09.221631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5441d67-eada-47dc-ab98-887a89b609cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306e7761d0>]}
[0m11:50:09.222247 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m11:50:09.222826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5441d67-eada-47dc-ab98-887a89b609cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306e776200>]}
[0m11:50:09.224359 [info ] [MainThread]: 
[0m11:50:09.227093 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:50:09.236728 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:50:09.237664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:10.386450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5441d67-eada-47dc-ab98-887a89b609cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306e775f60>]}
[0m11:50:10.388802 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:50:10.391583 [info ] [MainThread]: 
[0m11:50:10.404160 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m11:50:10.405945 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m11:50:10.406399 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m11:50:10.413172 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m11:50:10.414412 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-04-18 11:50:10.406745 => 2023-04-18 11:50:10.414297
[0m11:50:10.416441 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m11:50:10.416911 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-04-18 11:50:10.416807 => 2023-04-18 11:50:10.416834
[0m11:50:10.420452 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m11:50:10.421639 [debug] [Thread-3 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m11:50:10.422731 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m11:50:10.423145 [debug] [Thread-3 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m11:50:10.426453 [debug] [Thread-4 (]: Began running node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m11:50:10.427647 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d'
[0m11:50:10.429211 [debug] [Thread-4 (]: Began compiling node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m11:50:10.429517 [debug] [Thread-5 (]: Began running node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m11:50:10.432042 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m11:50:10.540709 [debug] [Thread-3 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-04-18 11:50:10.423437 => 2023-04-18 11:50:10.540611
[0m11:50:10.539319 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d"
[0m11:50:10.541633 [debug] [Thread-4 (]: Timing info for test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d (compile): 2023-04-18 11:50:10.432242 => 2023-04-18 11:50:10.541545
[0m11:50:10.542114 [debug] [Thread-4 (]: Began executing node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m11:50:10.541057 [debug] [Thread-3 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m11:50:10.542912 [debug] [Thread-3 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-04-18 11:50:10.542842 => 2023-04-18 11:50:10.542856
[0m11:50:10.542559 [debug] [Thread-4 (]: Timing info for test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d (execute): 2023-04-18 11:50:10.542454 => 2023-04-18 11:50:10.542473
[0m11:50:10.539969 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1'
[0m11:50:10.544751 [debug] [Thread-5 (]: Began compiling node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m11:50:10.544422 [debug] [Thread-4 (]: Finished running node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m11:50:10.543584 [debug] [Thread-3 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m11:50:10.551980 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1"
[0m11:50:10.552957 [debug] [Thread-5 (]: Timing info for test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1 (compile): 2023-04-18 11:50:10.544945 => 2023-04-18 11:50:10.552875
[0m11:50:10.553373 [debug] [Thread-5 (]: Began executing node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m11:50:10.553665 [debug] [Thread-5 (]: Timing info for test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1 (execute): 2023-04-18 11:50:10.553573 => 2023-04-18 11:50:10.553585
[0m11:50:10.554408 [debug] [Thread-5 (]: Finished running node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m11:50:10.556442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:50:10.556696 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m11:50:10.556894 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m11:50:10.557075 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m11:50:10.557283 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m11:50:10.557873 [debug] [MainThread]: Command end result
[0m11:50:10.564292 [info ] [MainThread]: Done.
[0m11:50:10.595041 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m11:50:10.595445 [info ] [MainThread]: Building catalog
[0m11:50:10.596605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:50:11.093918 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m11:50:11.101134 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m11:50:11.111094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:11.113628 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:11.114539 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_kimwkho`.__TABLES__
        where (upper(dataset_id) = upper('dbt_kimwkho'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_kimwkho`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_kimwkho`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_kimwkho`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m11:50:11.115050 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m11:50:14.010932 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8cbb70ba-264e-4e57-bd3c-ddaade2ee51b&page=queryresults
[0m11:50:14.036501 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2b532b51-5327-4645-b023-4de854d2dd19&page=queryresults
[0m11:50:14.055521 [info ] [MainThread]: Catalog written to /workspaces/ae-club-kimwkho/coffee_shop_kimwkho/target/catalog.json
[0m11:50:14.056596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306e8831f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306e4d7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306e4d5f60>]}
[0m11:50:14.057088 [debug] [MainThread]: Flushing usage events
[0m11:50:14.456368 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:50:14.457354 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m11:50:14.457759 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.


============================== 2023-04-18 11:50:21.875718 | 32b39fbd-9fb8-48b7-a515-a9b67afd267a ==============================
[0m11:50:21.875718 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:50:21.880246 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m11:50:21.880840 [debug] [MainThread]: Tracking: tracking
[0m11:50:21.888034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0404cf1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0404cf0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0404cf1030>]}
[0m11:50:21.895636 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m11:50:21.897005 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m11:50:21.898793 [info ] [MainThread]: 
[0m11:50:21.900324 [info ] [MainThread]: 
[0m11:50:21.902090 [info ] [MainThread]: Press Ctrl+C to exit.
[0m12:03:18.174096 [debug] [MainThread]: Flushing usage events
[0m12:03:18.593168 [info ] [MainThread]: ctrl-c


============================== 2023-05-03 12:16:56.030072 | 1312c9b3-e164-4f6f-a12e-0bf69690513b ==============================
[0m12:16:56.030072 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:16:56.033319 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:*'], 'which': 'test', 'rpc_method': 'test'}
[0m12:16:56.033727 [debug] [MainThread]: Tracking: tracking
[0m12:16:56.044613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11939e1600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11939e10c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11939e15a0>]}
[0m12:16:56.063487 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:16:56.211015 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 4 files added, 0 files changed.
[0m12:16:56.211543 [debug] [MainThread]: Partial parsing: added file: coffee_shop_kimwkho://models/staging/customers.sql
[0m12:16:56.211907 [debug] [MainThread]: Partial parsing: added file: coffee_shop_kimwkho://models/staging/monthly_customers.sql
[0m12:16:56.212235 [debug] [MainThread]: Partial parsing: added file: coffee_shop_kimwkho://models/staging/src_coffee_shop.yml
[0m12:16:56.212559 [debug] [MainThread]: Partial parsing: added file: coffee_shop_kimwkho://models/staging/customers.yml
[0m12:16:56.212851 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_kimwkho://models/customers.sql
[0m12:16:56.213035 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop_kimwkho://models/monthly_customers.sql
[0m12:16:56.225680 [debug] [MainThread]: 1699: static parser successfully parsed staging/customers.sql
[0m12:16:56.237930 [debug] [MainThread]: 1699: static parser successfully parsed staging/monthly_customers.sql
[0m12:16:56.341360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1312c9b3-e164-4f6f-a12e-0bf69690513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1193212e60>]}
[0m12:16:56.353949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1312c9b3-e164-4f6f-a12e-0bf69690513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f119375e350>]}
[0m12:16:56.354725 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m12:16:56.355325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1312c9b3-e164-4f6f-a12e-0bf69690513b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1196ac5d20>]}
[0m12:16:56.357417 [info ] [MainThread]: 
[0m12:16:56.358933 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:16:56.359611 [debug] [MainThread]: Command end result
[0m12:16:56.365563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11953ed180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1196ad60b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11939a46a0>]}
[0m12:16:56.366029 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 12:18:31.705946 | 250d5221-d335-4f53-acf3-effeeab5bf75 ==============================
[0m12:18:31.705946 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:18:31.709084 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m12:18:31.709437 [debug] [MainThread]: Tracking: tracking
[0m12:18:31.725426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbbbe55d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbbbe5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbbbe5570>]}
[0m12:18:31.739561 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:18:31.793370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:31.793883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:31.805516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '250d5221-d335-4f53-acf3-effeeab5bf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbb9ba320>]}
[0m12:18:31.814723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '250d5221-d335-4f53-acf3-effeeab5bf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbbad6830>]}
[0m12:18:31.815152 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m12:18:31.816134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '250d5221-d335-4f53-acf3-effeeab5bf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbbad6860>]}
[0m12:18:31.817685 [info ] [MainThread]: 
[0m12:18:31.819859 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:18:31.821076 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:18:31.821561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:37.012577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '250d5221-d335-4f53-acf3-effeeab5bf75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbbad4cd0>]}
[0m12:18:37.013445 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:18:37.013861 [info ] [MainThread]: 
[0m12:18:37.035282 [debug] [Thread-1 (]: Began running node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m12:18:37.035579 [debug] [Thread-2 (]: Began running node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m12:18:37.035944 [info ] [Thread-1 (]: 1 of 2 START test not_null_customers_customer_id ............................... [RUN]
[0m12:18:37.036341 [info ] [Thread-2 (]: 2 of 2 START test unique_customers_customer_id ................................. [RUN]
[0m12:18:37.037982 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d'
[0m12:18:37.039432 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1'
[0m12:18:37.039764 [debug] [Thread-1 (]: Began compiling node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m12:18:37.040081 [debug] [Thread-2 (]: Began compiling node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m12:18:37.052628 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d"
[0m12:18:37.061136 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1"
[0m12:18:37.061556 [debug] [Thread-1 (]: Timing info for test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d (compile): 2023-05-03 12:18:37.040310 => 2023-05-03 12:18:37.061475
[0m12:18:37.062106 [debug] [Thread-1 (]: Began executing node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m12:18:37.112574 [debug] [Thread-2 (]: Timing info for test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1 (compile): 2023-05-03 12:18:37.052873 => 2023-05-03 12:18:37.112491
[0m12:18:37.119906 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d"
[0m12:18:37.120286 [debug] [Thread-2 (]: Began executing node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m12:18:37.122618 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1"
[0m12:18:37.123144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:37.124000 [debug] [Thread-1 (]: On test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `aec-students`.`dbt_kimwkho`.`customers`
where customer_id is null



      
    ) dbt_internal_test
[0m12:18:37.125035 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:37.126753 [debug] [Thread-2 (]: On test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `aec-students`.`dbt_kimwkho`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:18:38.702544 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8d8262f3-d736-4412-b2a3-1a6243675063&page=queryresults
[0m12:18:38.704011 [debug] [Thread-1 (]: Timing info for test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d (execute): 2023-05-03 12:18:37.062421 => 2023-05-03 12:18:38.703933
[0m12:18:38.704811 [info ] [Thread-1 (]: 1 of 2 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 1.67s]
[0m12:18:38.707163 [debug] [Thread-1 (]: Finished running node test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d
[0m12:18:39.687136 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:44a8c310-37d3-4571-8cbc-091bd36bbe3c&page=queryresults
[0m12:18:39.687885 [debug] [Thread-2 (]: Timing info for test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1 (execute): 2023-05-03 12:18:37.120740 => 2023-05-03 12:18:39.687805
[0m12:18:39.688652 [info ] [Thread-2 (]: 2 of 2 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 2.65s]
[0m12:18:39.689428 [debug] [Thread-2 (]: Finished running node test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1
[0m12:18:39.691348 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:18:39.691892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:39.692100 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m12:18:39.692289 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m12:18:39.692516 [info ] [MainThread]: 
[0m12:18:39.692872 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 7.87 seconds (7.87s).
[0m12:18:39.693383 [debug] [MainThread]: Command end result
[0m12:18:39.700096 [info ] [MainThread]: 
[0m12:18:39.700592 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:39.701434 [info ] [MainThread]: 
[0m12:18:39.701871 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:18:39.702745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbb9ba5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbb9a3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6dbb979270>]}
[0m12:18:39.703140 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 12:21:36.418798 | 50d10a13-d810-4f43-934a-c6662ecf91ed ==============================
[0m12:21:36.418798 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:21:36.421288 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:*'], 'which': 'test', 'rpc_method': 'test'}
[0m12:21:36.421604 [debug] [MainThread]: Tracking: tracking
[0m12:21:36.430210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608317d600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608317d0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608317d5a0>]}
[0m12:21:36.446440 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:21:36.490182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:36.490764 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:36.496530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50d10a13-d810-4f43-934a-c6662ecf91ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6082f4e2f0>]}
[0m12:21:36.503434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50d10a13-d810-4f43-934a-c6662ecf91ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608306e800>]}
[0m12:21:36.503824 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m12:21:36.504232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50d10a13-d810-4f43-934a-c6662ecf91ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6086109d20>]}
[0m12:21:36.505254 [info ] [MainThread]: 
[0m12:21:36.505877 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:21:36.506436 [debug] [MainThread]: Command end result
[0m12:21:36.511816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608306e3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608306dde0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f608306dc30>]}
[0m12:21:36.512148 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 12:22:01.759544 | 713e5be1-872e-434e-b99b-fcb4594a831f ==============================
[0m12:22:01.759544 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:22:01.762004 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:coffee_shop'], 'which': 'test', 'rpc_method': 'test'}
[0m12:22:01.762472 [debug] [MainThread]: Tracking: tracking
[0m12:22:01.765656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e08bf10f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e08bf0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e08bf1090>]}
[0m12:22:01.782650 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:22:01.818025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:22:01.818271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:22:01.824285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '713e5be1-872e-434e-b99b-fcb4594a831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e08bc66b0>]}
[0m12:22:01.833156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '713e5be1-872e-434e-b99b-fcb4594a831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e08af6bc0>]}
[0m12:22:01.833620 [info ] [MainThread]: Found 2 models, 2 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m12:22:01.834088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '713e5be1-872e-434e-b99b-fcb4594a831f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e0bd1a590>]}
[0m12:22:01.835478 [info ] [MainThread]: 
[0m12:22:01.836165 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:22:01.836996 [debug] [MainThread]: Command end result
[0m12:22:01.842795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e08af67d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e08af4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e08af62f0>]}
[0m12:22:01.843143 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 12:22:44.557581 | 7a41f221-1cc9-4fe1-a6dd-26515983764d ==============================
[0m12:22:44.557581 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:22:44.560799 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:coffee_shop'], 'which': 'test', 'rpc_method': 'test'}
[0m12:22:44.561305 [debug] [MainThread]: Tracking: tracking
[0m12:22:44.566544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1601f2740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1601f06a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1601f1180>]}
[0m12:22:44.582690 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:22:44.626235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:22:44.627688 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/src_coffee_shop.yml
[0m12:22:44.660348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1600f6fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1601c8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1601e45b0>]}
[0m12:22:44.661078 [debug] [MainThread]: Flushing usage events
[0m12:22:45.088100 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "coffee_shop_orders".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("coffee_shop", "orders").
  
  To fix this, change the name of one of these resources:
  - source.coffee_shop_kimwkho.coffee_shop.orders (models/staging/src_coffee_shop.yml)
  - source.coffee_shop_kimwkho.coffee_shop.orders (models/staging/customers.yml)


============================== 2023-05-03 12:23:07.501470 | 836eb018-7a75-4952-af6e-190d9cf14952 ==============================
[0m12:23:07.501470 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:23:07.504567 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:*'], 'which': 'test', 'rpc_method': 'test'}
[0m12:23:07.505048 [debug] [MainThread]: Tracking: tracking
[0m12:23:07.508306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1858bc79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1855ae0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1855ae05e0>]}
[0m12:23:07.523081 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:23:07.559623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:23:07.560115 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/src_coffee_shop.yml
[0m12:23:07.575771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18559e7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18558bcee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18558d8a00>]}
[0m12:23:07.576123 [debug] [MainThread]: Flushing usage events
[0m12:23:07.974422 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "coffee_shop_orders".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("coffee_shop", "orders").
  
  To fix this, change the name of one of these resources:
  - source.coffee_shop_kimwkho.coffee_shop.orders (models/staging/src_coffee_shop.yml)
  - source.coffee_shop_kimwkho.coffee_shop.orders (models/staging/customers.yml)


============================== 2023-05-03 12:23:24.276883 | 9f714924-09da-455f-bbeb-7efef1ecf989 ==============================
[0m12:23:24.276883 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:23:24.279788 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:*'], 'which': 'test', 'rpc_method': 'test'}
[0m12:23:24.280290 [debug] [MainThread]: Tracking: tracking
[0m12:23:24.284293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a06f8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659d3f0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659d3f0ee0>]}
[0m12:23:24.299952 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:23:24.346671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:23:24.347282 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/src_coffee_shop.yml
[0m12:23:24.347844 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/customers.yml
[0m12:23:24.360862 [debug] [MainThread]: 1699: static parser successfully parsed staging/monthly_customers.sql
[0m12:23:24.374605 [debug] [MainThread]: 1699: static parser successfully parsed staging/customers.sql
[0m12:23:24.483509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f714924-09da-455f-bbeb-7efef1ecf989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659ce8a9e0>]}
[0m12:23:24.490666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f714924-09da-455f-bbeb-7efef1ecf989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659d2f6c80>]}
[0m12:23:24.491063 [info ] [MainThread]: Found 2 models, 14 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:23:24.491454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f714924-09da-455f-bbeb-7efef1ecf989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a06f8850>]}
[0m12:23:24.493150 [info ] [MainThread]: 
[0m12:23:24.495266 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:24.496727 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:23:24.497109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:23:25.541587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f714924-09da-455f-bbeb-7efef1ecf989', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659d2f5f00>]}
[0m12:23:25.542421 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:23:25.543066 [info ] [MainThread]: 
[0m12:23:25.547793 [debug] [Thread-1 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m12:23:25.548070 [debug] [Thread-2 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f
[0m12:23:25.548286 [debug] [Thread-3 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108
[0m12:23:25.548516 [debug] [Thread-4 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2
[0m12:23:25.548741 [debug] [Thread-5 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21
[0m12:23:25.548943 [debug] [Thread-6 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966
[0m12:23:25.549191 [debug] [Thread-7 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5
[0m12:23:25.549389 [debug] [Thread-8 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16
[0m12:23:25.549801 [info ] [Thread-1 (]: 1 of 12 START test source_not_null_coffee_shop_customers_id .................... [RUN]
[0m12:23:25.550223 [info ] [Thread-2 (]: 2 of 12 START test source_not_null_coffee_shop_order_items_id .................. [RUN]
[0m12:23:25.550843 [info ] [Thread-3 (]: 3 of 12 START test source_not_null_coffee_shop_orders_id ....................... [RUN]
[0m12:23:25.551538 [info ] [Thread-4 (]: 4 of 12 START test source_not_null_coffee_shop_product_prices_id ............... [RUN]
[0m12:23:25.553265 [info ] [Thread-6 (]: 6 of 12 START test source_not_null_coffee_shop_products_id ..................... [RUN]
[0m12:23:25.558694 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966'
[0m12:23:25.559000 [debug] [Thread-6 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966
[0m12:23:25.553898 [info ] [Thread-7 (]: 7 of 12 START test source_unique_coffee_shop_customers_id ...................... [RUN]
[0m12:23:25.554604 [info ] [Thread-8 (]: 8 of 12 START test source_unique_coffee_shop_order_items_id .................... [RUN]
[0m12:23:25.556862 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f'
[0m12:23:25.557504 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108'
[0m12:23:25.558083 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2'
[0m12:23:25.552122 [info ] [Thread-5 (]: 5 of 12 START test source_not_null_coffee_shop_product_prices_product_id ....... [RUN]
[0m12:23:25.555714 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0'
[0m12:23:25.572872 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966"
[0m12:23:25.573530 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5'
[0m12:23:25.574153 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16'
[0m12:23:25.574469 [debug] [Thread-2 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f
[0m12:23:25.574786 [debug] [Thread-3 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108
[0m12:23:25.584878 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108"
[0m12:23:25.575696 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21'
[0m12:23:25.575998 [debug] [Thread-1 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m12:23:25.576502 [debug] [Thread-7 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5
[0m12:23:25.576817 [debug] [Thread-8 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16
[0m12:23:25.580971 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f"
[0m12:23:25.575087 [debug] [Thread-4 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2
[0m12:23:25.585242 [debug] [Thread-6 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966 (compile): 2023-05-03 12:23:25.559203 => 2023-05-03 12:23:25.585161
[0m12:23:25.585861 [debug] [Thread-3 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108 (compile): 2023-05-03 12:23:25.581241 => 2023-05-03 12:23:25.585789
[0m12:23:25.605380 [debug] [Thread-3 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108
[0m12:23:25.590139 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m12:23:25.596340 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5"
[0m12:23:25.624892 [debug] [Thread-7 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5 (compile): 2023-05-03 12:23:25.590403 => 2023-05-03 12:23:25.624818
[0m12:23:25.625245 [debug] [Thread-7 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5
[0m12:23:25.604774 [debug] [Thread-6 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966
[0m12:23:25.605083 [debug] [Thread-2 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f (compile): 2023-05-03 12:23:25.577112 => 2023-05-03 12:23:25.605030
[0m12:23:25.586158 [debug] [Thread-5 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21
[0m12:23:25.624366 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108"
[0m12:23:25.635577 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:23:25.636216 [debug] [Thread-3 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`orders`
where id is null



      
    ) dbt_internal_test
[0m12:23:25.627389 [debug] [Thread-7 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5"
[0m12:23:25.627618 [debug] [Thread-1 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0 (compile): 2023-05-03 12:23:25.586369 => 2023-05-03 12:23:25.627567
[0m12:23:25.630307 [debug] [Thread-6 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966"
[0m12:23:25.631083 [debug] [Thread-2 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f
[0m12:23:25.635041 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21"
[0m12:23:25.600145 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16"
[0m12:23:25.604363 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2"
[0m12:23:25.643075 [debug] [Thread-4 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2 (compile): 2023-05-03 12:23:25.600539 => 2023-05-03 12:23:25.642996
[0m12:23:25.643539 [debug] [Thread-4 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2
[0m12:23:25.645370 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2"
[0m12:23:25.638616 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m12:23:25.638249 [debug] [Thread-1 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m12:23:25.642046 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m12:23:25.650617 [debug] [Thread-6 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`products`
where id is null



      
    ) dbt_internal_test
[0m12:23:25.647107 [debug] [Thread-7 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:23:25.647328 [debug] [Thread-8 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16 (compile): 2023-05-03 12:23:25.596581 => 2023-05-03 12:23:25.647281
[0m12:23:25.654121 [debug] [Thread-8 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16
[0m12:23:25.647963 [debug] [Thread-5 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21 (compile): 2023-05-03 12:23:25.631323 => 2023-05-03 12:23:25.647906
[0m12:23:25.647707 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:23:25.658266 [debug] [Thread-4 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`product_prices`
where id is null



      
    ) dbt_internal_test
[0m12:23:25.641241 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f"
[0m12:23:25.657756 [debug] [Thread-5 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21
[0m12:23:25.650064 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m12:23:25.657341 [debug] [Thread-8 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16"
[0m12:23:25.668453 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m12:23:25.667539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:25.669354 [debug] [Thread-1 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`customers`
where id is null



      
    ) dbt_internal_test
[0m12:23:25.667996 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:23:25.671776 [debug] [Thread-2 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`order_items`
where id is null



      
    ) dbt_internal_test
[0m12:23:25.668844 [debug] [Thread-8 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`order_items`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:23:25.664781 [debug] [Thread-5 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21"
[0m12:23:25.676345 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m12:23:25.676757 [debug] [Thread-5 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `analytics-engineers-club`.`coffee_shop`.`product_prices`
where product_id is null



      
    ) dbt_internal_test
[0m12:23:27.669601 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:35625300-450c-4cfb-a6b5-87a60015e044&page=queryresults
[0m12:23:27.670996 [debug] [Thread-3 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108 (execute): 2023-05-03 12:23:25.605580 => 2023-05-03 12:23:27.670920
[0m12:23:27.671769 [info ] [Thread-3 (]: 3 of 12 PASS source_not_null_coffee_shop_orders_id ............................. [[32mPASS[0m in 2.11s]
[0m12:23:27.673900 [debug] [Thread-3 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108
[0m12:23:27.674694 [debug] [Thread-3 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7
[0m12:23:27.675141 [info ] [Thread-3 (]: 9 of 12 START test source_unique_coffee_shop_orders_id ......................... [RUN]
[0m12:23:27.675966 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7'
[0m12:23:27.676246 [debug] [Thread-3 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7
[0m12:23:27.681082 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7"
[0m12:23:27.681502 [debug] [Thread-3 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7 (compile): 2023-05-03 12:23:27.676434 => 2023-05-03 12:23:27.681431
[0m12:23:27.681846 [debug] [Thread-3 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7
[0m12:23:27.683926 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7"
[0m12:23:27.684343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:23:27.684739 [debug] [Thread-3 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`orders`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:23:27.716036 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d9069acd-c3d6-4332-bc02-860500f94dd0&page=queryresults
[0m12:23:27.716772 [debug] [Thread-4 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2 (execute): 2023-05-03 12:23:25.643734 => 2023-05-03 12:23:27.716699
[0m12:23:27.717964 [info ] [Thread-4 (]: 4 of 12 PASS source_not_null_coffee_shop_product_prices_id ..................... [[32mPASS[0m in 2.16s]
[0m12:23:27.720836 [debug] [Thread-4 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2
[0m12:23:27.721444 [debug] [Thread-4 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc
[0m12:23:27.722601 [info ] [Thread-4 (]: 10 of 12 START test source_unique_coffee_shop_product_prices_id ................ [RUN]
[0m12:23:27.724254 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc'
[0m12:23:27.725428 [debug] [Thread-4 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc
[0m12:23:27.732284 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc"
[0m12:23:27.734505 [debug] [Thread-4 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc (compile): 2023-05-03 12:23:27.725833 => 2023-05-03 12:23:27.734428
[0m12:23:27.734999 [debug] [Thread-4 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc
[0m12:23:27.742220 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:098343ce-f72e-4c79-941b-4f1a07086f36&page=queryresults
[0m12:23:27.743043 [debug] [Thread-1 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0 (execute): 2023-05-03 12:23:25.648164 => 2023-05-03 12:23:27.742970
[0m12:23:27.744078 [info ] [Thread-1 (]: 1 of 12 PASS source_not_null_coffee_shop_customers_id .......................... [[32mPASS[0m in 2.19s]
[0m12:23:27.746105 [debug] [Thread-1 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m12:23:27.747223 [debug] [Thread-1 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3
[0m12:23:27.747792 [info ] [Thread-1 (]: 11 of 12 START test source_unique_coffee_shop_product_prices_product_id ........ [RUN]
[0m12:23:27.749260 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3'
[0m12:23:27.750362 [debug] [Thread-1 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3
[0m12:23:27.759783 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc"
[0m12:23:27.760533 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:23:27.760025 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3"
[0m12:23:27.760933 [debug] [Thread-4 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`product_prices`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:23:27.762011 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:28d4ab19-d05f-40bd-aeed-af23429fedc6&page=queryresults
[0m12:23:27.762988 [debug] [Thread-5 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21 (execute): 2023-05-03 12:23:25.661071 => 2023-05-03 12:23:27.762915
[0m12:23:27.763892 [info ] [Thread-5 (]: 5 of 12 PASS source_not_null_coffee_shop_product_prices_product_id ............. [[32mPASS[0m in 2.19s]
[0m12:23:27.764487 [debug] [Thread-5 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21
[0m12:23:27.764925 [debug] [Thread-5 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9
[0m12:23:27.765351 [info ] [Thread-5 (]: 12 of 12 START test source_unique_coffee_shop_products_id ...................... [RUN]
[0m12:23:27.769124 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9'
[0m12:23:27.769510 [debug] [Thread-5 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9
[0m12:23:27.771165 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:500a0c29-3636-4caa-9054-4590f1f4ece5&page=queryresults
[0m12:23:27.776216 [debug] [Thread-6 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966 (execute): 2023-05-03 12:23:25.627848 => 2023-05-03 12:23:27.776143
[0m12:23:27.777088 [info ] [Thread-6 (]: 6 of 12 PASS source_not_null_coffee_shop_products_id ........................... [[32mPASS[0m in 2.22s]
[0m12:23:27.777962 [debug] [Thread-6 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966
[0m12:23:27.778815 [debug] [Thread-1 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3 (compile): 2023-05-03 12:23:27.750869 => 2023-05-03 12:23:27.778742
[0m12:23:27.779339 [debug] [Thread-1 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3
[0m12:23:27.782604 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3"
[0m12:23:27.786372 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:23:27.786826 [debug] [Thread-1 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`product_prices`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:23:27.792588 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9"
[0m12:23:27.794074 [debug] [Thread-5 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9 (compile): 2023-05-03 12:23:27.771927 => 2023-05-03 12:23:27.793999
[0m12:23:27.794753 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1ca45ff9-2a17-4b33-9d78-d092cd6414fd&page=queryresults
[0m12:23:27.797575 [debug] [Thread-2 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f (execute): 2023-05-03 12:23:25.639110 => 2023-05-03 12:23:27.797509
[0m12:23:27.799131 [info ] [Thread-2 (]: 2 of 12 PASS source_not_null_coffee_shop_order_items_id ........................ [[32mPASS[0m in 2.24s]
[0m12:23:27.799951 [debug] [Thread-2 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f
[0m12:23:27.796821 [debug] [Thread-5 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9
[0m12:23:27.809435 [debug] [Thread-5 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9"
[0m12:23:27.814955 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m12:23:27.816730 [debug] [Thread-5 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`products`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m12:23:28.187725 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b61e597c-3940-4197-bca1-38c81a2f4598&page=queryresults
[0m12:23:28.188414 [debug] [Thread-7 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5 (execute): 2023-05-03 12:23:25.625495 => 2023-05-03 12:23:28.188339
[0m12:23:28.189166 [info ] [Thread-7 (]: 7 of 12 PASS source_unique_coffee_shop_customers_id ............................ [[32mPASS[0m in 2.62s]
[0m12:23:28.189674 [debug] [Thread-7 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5
[0m12:23:29.093386 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e031114c-89ad-4655-a1e9-9d750ea5bec9&page=queryresults
[0m12:23:29.094151 [debug] [Thread-8 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16 (execute): 2023-05-03 12:23:25.654434 => 2023-05-03 12:23:29.094074
[0m12:23:29.094955 [info ] [Thread-8 (]: 8 of 12 PASS source_unique_coffee_shop_order_items_id .......................... [[32mPASS[0m in 3.52s]
[0m12:23:29.095649 [debug] [Thread-8 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16
[0m12:23:29.446940 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7bea473d-cd14-4403-a6b3-3b280fb0ac61&page=queryresults
[0m12:23:29.447614 [debug] [Thread-4 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc (execute): 2023-05-03 12:23:27.735379 => 2023-05-03 12:23:29.447543
[0m12:23:29.448358 [info ] [Thread-4 (]: 10 of 12 PASS source_unique_coffee_shop_product_prices_id ...................... [[32mPASS[0m in 1.72s]
[0m12:23:29.449050 [debug] [Thread-4 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc
[0m12:23:29.498867 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:129e88c4-fbf0-441f-bea3-c91b1b41cad6&page=queryresults
[0m12:23:29.499502 [debug] [Thread-3 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7 (execute): 2023-05-03 12:23:27.682049 => 2023-05-03 12:23:29.499440
[0m12:23:29.500230 [info ] [Thread-3 (]: 9 of 12 PASS source_unique_coffee_shop_orders_id ............................... [[32mPASS[0m in 1.82s]
[0m12:23:29.500736 [debug] [Thread-3 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7
[0m12:23:29.547843 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:82864726-00bc-46c4-866a-fe0a0b5d50f3&page=queryresults
[0m12:23:29.548416 [debug] [Thread-1 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3 (execute): 2023-05-03 12:23:27.779857 => 2023-05-03 12:23:29.548362
[0m12:23:29.549114 [error] [Thread-1 (]: 11 of 12 FAIL 5 source_unique_coffee_shop_product_prices_product_id ............ [[31mFAIL 5[0m in 1.80s]
[0m12:23:29.549625 [debug] [Thread-1 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3
[0m12:23:29.589595 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:28ee32d2-e701-4ac5-8d19-34fed44d5b52&page=queryresults
[0m12:23:29.590156 [debug] [Thread-5 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9 (execute): 2023-05-03 12:23:27.803116 => 2023-05-03 12:23:29.590099
[0m12:23:29.590816 [info ] [Thread-5 (]: 12 of 12 PASS source_unique_coffee_shop_products_id ............................ [[32mPASS[0m in 1.82s]
[0m12:23:29.591348 [debug] [Thread-5 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9
[0m12:23:29.593188 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:23:29.593847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:23:29.594165 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_product_id.d5ade9c8c3' was properly closed.
[0m12:23:29.594375 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f' was properly closed.
[0m12:23:29.594588 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7' was properly closed.
[0m12:23:29.594800 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc' was properly closed.
[0m12:23:29.595074 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966' was properly closed.
[0m12:23:29.595277 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5' was properly closed.
[0m12:23:29.595463 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16' was properly closed.
[0m12:23:29.595647 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9' was properly closed.
[0m12:23:29.595910 [info ] [MainThread]: 
[0m12:23:29.596302 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 5.10 seconds (5.10s).
[0m12:23:29.597447 [debug] [MainThread]: Command end result
[0m12:23:29.605780 [info ] [MainThread]: 
[0m12:23:29.606235 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:23:29.606659 [info ] [MainThread]: 
[0m12:23:29.607161 [error] [MainThread]: [31mFailure in test source_unique_coffee_shop_product_prices_product_id (models/staging/src_coffee_shop.yml)[0m
[0m12:23:29.607612 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m12:23:29.608073 [info ] [MainThread]: 
[0m12:23:29.608540 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop_kimwkho/models/staging/src_coffee_shop.yml/source_unique_coffee_shop_product_prices_product_id.sql
[0m12:23:29.608935 [info ] [MainThread]: 
[0m12:23:29.609437 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m12:23:29.609992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659cdc0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659cdc0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659d2f6080>]}
[0m12:23:29.610397 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:27:24.088659 | 188e56ef-32d7-43a6-a48c-729f9780d1cb ==============================
[0m15:27:24.088659 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:27:24.100917 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:27:24.102237 [debug] [MainThread]: Tracking: tracking
[0m15:27:24.109180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc80fd120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc80fc5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc80fd0c0>]}
[0m15:27:24.129263 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:27:24.291705 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:27:24.292639 [debug] [MainThread]: Partial parsing: added file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:27:24.293407 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/src_coffee_shop.yml
[0m15:27:24.309406 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:27:24.331948 [debug] [MainThread]: 1699: static parser successfully parsed staging/monthly_customers.sql
[0m15:27:24.339293 [debug] [MainThread]: 1699: static parser successfully parsed staging/customers.sql
[0m15:27:24.456507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '188e56ef-32d7-43a6-a48c-729f9780d1cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc7fa51b0>]}
[0m15:27:24.464121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '188e56ef-32d7-43a6-a48c-729f9780d1cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc8048610>]}
[0m15:27:24.464632 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:27:24.465146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '188e56ef-32d7-43a6-a48c-729f9780d1cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc8048760>]}
[0m15:27:24.467252 [info ] [MainThread]: 
[0m15:27:24.469292 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:27:24.470709 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:27:24.471995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:29.286326 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:27:29.286828 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:29.595012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '188e56ef-32d7-43a6-a48c-729f9780d1cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc80484c0>]}
[0m15:27:29.595898 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:27:29.596400 [info ] [MainThread]: 
[0m15:27:29.617634 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m15:27:29.617961 [debug] [Thread-2 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:27:29.618378 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m15:27:29.619960 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m15:27:29.620824 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m15:27:29.619117 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:27:29.624045 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:27:29.624421 [debug] [Thread-2 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:27:29.630784 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:27:29.635569 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m15:27:29.636065 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:27:29.624686 => 2023-05-03 15:27:29.635976
[0m15:27:29.636717 [debug] [Thread-2 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:27:29.653354 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-05-03 15:27:29.621144 => 2023-05-03 15:27:29.653259
[0m15:27:29.671904 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m15:27:29.671410 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:27:29.687039 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:27:29.688340 [debug] [Thread-2 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_orders as (
    select 
        
)



with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club`.`coffee_shop`.`customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id;


[0m15:27:29.696132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:27:30.102283 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m15:27:30.102922 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club`.`coffee_shop`.`customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id
    );
  
[0m15:27:30.114238 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [9:1]')
[0m15:27:30.896909 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:50d895e5-45a6-49c2-bd5e-9de57526272d&page=queryresults
[0m15:27:30.897963 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:27:29.637012 => 2023-05-03 15:27:30.897873
[0m15:27:30.931279 [debug] [Thread-2 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Unexpected ")" at [9:1]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:27:30.931848 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '188e56ef-32d7-43a6-a48c-729f9780d1cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc7fa6740>]}
[0m15:27:30.932416 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.31s]
[0m15:27:30.934977 [debug] [Thread-2 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:27:36.659358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:346ca13a-5ced-42df-88e1-dc06041eb8a1&page=queryresults
[0m15:27:36.678871 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-05-03 15:27:29.672357 => 2023-05-03 15:27:36.678787
[0m15:27:36.680116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '188e56ef-32d7-43a6-a48c-729f9780d1cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc4179990>]}
[0m15:27:36.680936 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_kimwkho.customers ........................ [[32mCREATE TABLE (174.4k rows, 21.3 MB processed)[0m in 7.06s]
[0m15:27:36.683182 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m15:27:36.684297 [debug] [Thread-4 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m15:27:36.684833 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m15:27:36.686593 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m15:27:36.687464 [debug] [Thread-4 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m15:27:36.692252 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m15:27:36.693313 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-05-03 15:27:36.687886 => 2023-05-03 15:27:36.693228
[0m15:27:36.693797 [debug] [Thread-4 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m15:27:36.699717 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m15:27:36.703864 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:27:36.705358 [debug] [Thread-4 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students`.`dbt_kimwkho`.`customers`
 
group by 1;


[0m15:27:37.870474 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1412dac1-baeb-489e-881a-c96dc5aae37f&page=queryresults
[0m15:27:37.874486 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-05-03 15:27:36.694160 => 2023-05-03 15:27:37.874394
[0m15:27:37.875846 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '188e56ef-32d7-43a6-a48c-729f9780d1cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc417ae60>]}
[0m15:27:37.876441 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 1.19s]
[0m15:27:37.877263 [debug] [Thread-4 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m15:27:37.879430 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:27:37.879997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:27:37.880211 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m15:27:37.880419 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:27:37.880617 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m15:27:37.880891 [info ] [MainThread]: 
[0m15:27:37.881498 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 13.41 seconds (13.41s).
[0m15:27:37.882233 [debug] [MainThread]: Command end result
[0m15:27:37.892032 [info ] [MainThread]: 
[0m15:27:37.892738 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:27:37.893180 [info ] [MainThread]: 
[0m15:27:37.897824 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:27:37.901742 [error] [MainThread]:   Syntax error: Unexpected ")" at [9:1]
[0m15:27:37.902948 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:27:37.903982 [info ] [MainThread]: 
[0m15:27:37.904487 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:27:37.905826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc865c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc80480a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bc8048190>]}
[0m15:27:37.906283 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:28:15.617538 | dcca10bb-a58a-4e56-99ea-aaf806013d82 ==============================
[0m15:28:15.617538 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:28:15.620162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:28:15.620506 [debug] [MainThread]: Tracking: tracking
[0m15:28:15.623265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61054ef250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61054ef970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61054ef9d0>]}
[0m15:28:15.638243 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:28:15.677471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:28:15.677814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:28:15.683822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dcca10bb-a58a-4e56-99ea-aaf806013d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61054d8280>]}
[0m15:28:15.691294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dcca10bb-a58a-4e56-99ea-aaf806013d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61053fc760>]}
[0m15:28:15.691697 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:28:15.692079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcca10bb-a58a-4e56-99ea-aaf806013d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61053fc7c0>]}
[0m15:28:15.694137 [info ] [MainThread]: 
[0m15:28:15.696196 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:28:15.697789 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:28:15.698289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:16.756576 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:28:16.757179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:28:17.048767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dcca10bb-a58a-4e56-99ea-aaf806013d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105505ff0>]}
[0m15:28:17.049604 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:28:17.050004 [info ] [MainThread]: 
[0m15:28:17.054181 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m15:28:17.054474 [debug] [Thread-2 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:28:17.054872 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m15:28:17.056836 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m15:28:17.057500 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m15:28:17.055731 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:28:17.060468 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:28:17.061045 [debug] [Thread-2 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:28:17.115619 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m15:28:17.118514 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:28:17.119345 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:28:17.115887 => 2023-05-03 15:28:17.119246
[0m15:28:17.119781 [debug] [Thread-2 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:28:17.120189 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-05-03 15:28:17.057770 => 2023-05-03 15:28:17.120053
[0m15:28:17.137560 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m15:28:17.152998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:17.167542 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:28:17.171369 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:28:17.172086 [debug] [Thread-2 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_orders as (
    select 
        
)



with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club`.`coffee_shop`.`customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id;


[0m15:28:17.583857 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m15:28:17.584562 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club`.`coffee_shop`.`customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id
    );
  
[0m15:28:17.590983 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected ")" at [9:1]')
[0m15:28:18.256989 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9bdcc3c1-b114-4308-bd69-9aea92376b1e&page=queryresults
[0m15:28:18.257782 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:28:17.120350 => 2023-05-03 15:28:18.257677
[0m15:28:18.260735 [debug] [Thread-2 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Unexpected ")" at [9:1]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:28:18.261212 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcca10bb-a58a-4e56-99ea-aaf806013d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61087f3df0>]}
[0m15:28:18.261701 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.20s]
[0m15:28:18.263581 [debug] [Thread-2 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:29:11.368429 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0b6c0c1c-6c83-45f3-ac3c-829baf651724&page=queryresults
[0m15:29:11.384961 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-05-03 15:28:17.137913 => 2023-05-03 15:29:11.384897
[0m15:29:11.385819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcca10bb-a58a-4e56-99ea-aaf806013d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6105389810>]}
[0m15:29:11.386381 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_kimwkho.customers ........................ [[32mCREATE TABLE (174.4k rows, 21.3 MB processed)[0m in 54.33s]
[0m15:29:11.386964 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m15:29:11.388083 [debug] [Thread-4 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m15:29:11.388755 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m15:29:11.389655 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m15:29:11.390099 [debug] [Thread-4 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m15:29:11.392718 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m15:29:11.393250 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-05-03 15:29:11.390410 => 2023-05-03 15:29:11.393171
[0m15:29:11.393613 [debug] [Thread-4 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m15:29:11.398044 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m15:29:11.398563 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:29:11.398958 [debug] [Thread-4 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students`.`dbt_kimwkho`.`customers`
 
group by 1;


[0m15:29:12.239396 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4c08c136-7d75-4ea7-8e9f-07717ddd8d3c&page=queryresults
[0m15:29:12.241523 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-05-03 15:29:11.393824 => 2023-05-03 15:29:12.241464
[0m15:29:12.242322 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dcca10bb-a58a-4e56-99ea-aaf806013d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61053b1b40>]}
[0m15:29:12.242925 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m15:29:12.243787 [debug] [Thread-4 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m15:29:12.245913 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:29:12.246432 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:12.246641 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m15:29:12.246813 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:29:12.246967 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m15:29:12.247184 [info ] [MainThread]: 
[0m15:29:12.247898 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 56.55 seconds (56.55s).
[0m15:29:12.249057 [debug] [MainThread]: Command end result
[0m15:29:12.258413 [info ] [MainThread]: 
[0m15:29:12.259299 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:29:12.259928 [info ] [MainThread]: 
[0m15:29:12.260898 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:29:12.261552 [error] [MainThread]:   Syntax error: Unexpected ")" at [9:1]
[0m15:29:12.262116 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:29:12.262947 [info ] [MainThread]: 
[0m15:29:12.264036 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:29:12.265402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61040efdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61053a5ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61053a76d0>]}
[0m15:29:12.265782 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:31:02.062623 | f7c6feec-f1a5-4f17-842d-6050f0773155 ==============================
[0m15:31:02.062623 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:31:02.065660 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:31:02.065971 [debug] [MainThread]: Tracking: tracking
[0m15:31:02.071154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a94e1150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a94e05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a94e10f0>]}
[0m15:31:02.086688 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:31:02.129275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:31:02.130589 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:31:02.152353 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:31:02.229453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7c6feec-f1a5-4f17-842d-6050f0773155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a91f9570>]}
[0m15:31:02.245272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7c6feec-f1a5-4f17-842d-6050f0773155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a928f7f0>]}
[0m15:31:02.245964 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:31:02.246560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7c6feec-f1a5-4f17-842d-6050f0773155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a928f820>]}
[0m15:31:02.248429 [info ] [MainThread]: 
[0m15:31:02.252751 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:31:02.256553 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:31:02.257232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:03.388032 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:31:03.388618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:03.699192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7c6feec-f1a5-4f17-842d-6050f0773155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a928f850>]}
[0m15:31:03.700002 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:31:03.700422 [info ] [MainThread]: 
[0m15:31:03.705663 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:31:03.706213 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:31:03.707086 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:31:03.707439 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:31:03.711065 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:31:03.711886 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:31:03.707681 => 2023-05-03 15:31:03.711808
[0m15:31:03.712237 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:31:03.746905 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:31:03.747930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:03.748966 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

with categories_ordered as ( 
    select
        order_id
        , product_id
        products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products`
) 


left join weekly revenue on id = categories_ordered.order_id

group by 1, 2;


[0m15:31:04.051158 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got identifier "timestamp_trunc" at [11:9]')
[0m15:31:04.616839 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9bf8c08e-678b-4061-8cfb-2a25d8979ef2&page=queryresults
[0m15:31:04.617980 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:31:03.712480 => 2023-05-03 15:31:04.617873
[0m15:31:04.620872 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected ")" but got identifier "timestamp_trunc" at [11:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:31:04.621324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7c6feec-f1a5-4f17-842d-6050f0773155', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a92c60e0>]}
[0m15:31:04.621835 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.91s]
[0m15:31:04.624141 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:31:04.626513 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:31:04.627214 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:04.627437 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:31:04.627700 [info ] [MainThread]: 
[0m15:31:04.628044 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m15:31:04.628459 [debug] [MainThread]: Command end result
[0m15:31:04.638791 [info ] [MainThread]: 
[0m15:31:04.640131 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:31:04.641989 [info ] [MainThread]: 
[0m15:31:04.643787 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:31:04.645610 [error] [MainThread]:   Syntax error: Expected ")" but got identifier "timestamp_trunc" at [11:9]
[0m15:31:04.647457 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:31:04.649112 [info ] [MainThread]: 
[0m15:31:04.649610 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:31:04.651130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a94e02b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a94e1ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a92e1780>]}
[0m15:31:04.651473 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:31:33.156688 | 6c966c07-32b2-4d3c-9251-671317a89e02 ==============================
[0m15:31:33.156688 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:31:33.159557 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:31:33.160039 [debug] [MainThread]: Tracking: tracking
[0m15:31:33.163762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe99681b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9936f6ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9936f4b20>]}
[0m15:31:33.178889 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:31:33.216668 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:31:33.217373 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:31:33.230151 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:31:33.304344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c966c07-32b2-4d3c-9251-671317a89e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9936a8d90>]}
[0m15:31:33.312592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c966c07-32b2-4d3c-9251-671317a89e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9936a2fe0>]}
[0m15:31:33.313035 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:31:33.313462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c966c07-32b2-4d3c-9251-671317a89e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe99681b970>]}
[0m15:31:33.314830 [info ] [MainThread]: 
[0m15:31:33.316976 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:31:33.318341 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:31:33.318744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:34.432312 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:31:34.432901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:31:34.700071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c966c07-32b2-4d3c-9251-671317a89e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9936a3790>]}
[0m15:31:34.701315 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:31:34.702691 [info ] [MainThread]: 
[0m15:31:34.715380 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:31:34.715886 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:31:34.716659 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:31:34.716934 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:31:34.720675 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:31:34.721569 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:31:34.717132 => 2023-05-03 15:31:34.721478
[0m15:31:34.721973 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:31:34.759459 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:31:34.760140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:31:34.760841 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

with categories_ordered as ( 
    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products`
) 


left join weekly revenue on id = categories_ordered.order_id

group by 1, 2;


[0m15:31:35.084757 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]')
[0m15:31:35.548193 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b4e71d9c-95b9-44e9-a54c-83fd182376e3&page=queryresults
[0m15:31:35.549203 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:31:34.722157 => 2023-05-03 15:31:35.549114
[0m15:31:35.552407 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:31:35.552829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c966c07-32b2-4d3c-9251-671317a89e02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9936dbbb0>]}
[0m15:31:35.553354 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.84s]
[0m15:31:35.555197 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:31:35.557232 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:31:35.557834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:35.558052 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:31:35.558312 [info ] [MainThread]: 
[0m15:31:35.558647 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m15:31:35.559055 [debug] [MainThread]: Command end result
[0m15:31:35.565916 [info ] [MainThread]: 
[0m15:31:35.566402 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:31:35.566869 [info ] [MainThread]: 
[0m15:31:35.567337 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:31:35.567842 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]
[0m15:31:35.568274 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:31:35.568707 [info ] [MainThread]: 
[0m15:31:35.569161 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:31:35.569761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9977a63b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9936daad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9936dba60>]}
[0m15:31:35.570188 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:33:17.962537 | 9d48f5d5-966b-419e-bdce-eccf658918fb ==============================
[0m15:33:17.962537 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:33:17.965150 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:33:17.965470 [debug] [MainThread]: Tracking: tracking
[0m15:33:17.976438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f22fa740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f22f86a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f22f9180>]}
[0m15:33:17.992122 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:33:18.026640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:18.027318 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:33:18.040201 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:33:18.112903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d48f5d5-966b-419e-bdce-eccf658918fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f220d4e0>]}
[0m15:33:18.120522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d48f5d5-966b-419e-bdce-eccf658918fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f22a3760>]}
[0m15:33:18.120999 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:33:18.121436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d48f5d5-966b-419e-bdce-eccf658918fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f22a3790>]}
[0m15:33:18.122814 [info ] [MainThread]: 
[0m15:33:18.125035 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:33:18.126493 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:33:18.126906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:19.308321 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:33:19.308911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:19.584123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d48f5d5-966b-419e-bdce-eccf658918fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f22a2b30>]}
[0m15:33:19.584987 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:33:19.585495 [info ] [MainThread]: 
[0m15:33:19.590727 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:33:19.591190 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:33:19.592096 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:33:19.592449 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:33:19.595934 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:33:19.596757 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:33:19.592696 => 2023-05-03 15:33:19.596677
[0m15:33:19.597158 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:33:19.632521 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:33:19.633528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:19.634256 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

with categories_ordered as ( 
    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items`
) 

left join weekly revenue on id = categories_ordered.order_id

group by 1, 2;


[0m15:33:19.957703 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]')
[0m15:33:20.574052 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:22988857-ce49-4d9c-86dd-1cec8574c337&page=queryresults
[0m15:33:20.575078 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:33:19.597422 => 2023-05-03 15:33:20.574974
[0m15:33:20.577974 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:33:20.578424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d48f5d5-966b-419e-bdce-eccf658918fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f22de9b0>]}
[0m15:33:20.578929 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.99s]
[0m15:33:20.580747 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:33:20.582589 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:33:20.583224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:20.583447 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:33:20.583713 [info ] [MainThread]: 
[0m15:33:20.584108 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m15:33:20.584906 [debug] [MainThread]: Command end result
[0m15:33:20.591835 [info ] [MainThread]: 
[0m15:33:20.592351 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:33:20.592812 [info ] [MainThread]: 
[0m15:33:20.593272 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:33:20.593711 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]
[0m15:33:20.594129 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:33:20.594596 [info ] [MainThread]: 
[0m15:33:20.595087 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:33:20.595645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f22f9180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f22f9690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f20fb280>]}
[0m15:33:20.596102 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:34:37.911727 | f693fee3-c3f3-4f0f-8e63-94dd540d73b2 ==============================
[0m15:34:37.911727 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:34:37.914391 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:34:37.914828 [debug] [MainThread]: Tracking: tracking
[0m15:34:37.918479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d97e18dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d94cf4ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d94cf4f10>]}
[0m15:34:37.933649 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:34:37.973153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:34:37.973817 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:34:37.986420 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:34:38.059266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f693fee3-c3f3-4f0f-8e63-94dd540d73b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d94c096c0>]}
[0m15:34:38.066893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f693fee3-c3f3-4f0f-8e63-94dd540d73b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d94c9f9a0>]}
[0m15:34:38.067349 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:34:38.067743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f693fee3-c3f3-4f0f-8e63-94dd540d73b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d94c9f9d0>]}
[0m15:34:38.069136 [info ] [MainThread]: 
[0m15:34:38.071294 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:34:38.073132 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:34:38.073585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:39.210250 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:34:39.210729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:39.496776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f693fee3-c3f3-4f0f-8e63-94dd540d73b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d94c9fa60>]}
[0m15:34:39.497712 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:34:39.498430 [info ] [MainThread]: 
[0m15:34:39.503064 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:34:39.503501 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:34:39.504360 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:34:39.504759 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:34:39.508164 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:34:39.508647 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:34:39.505039 => 2023-05-03 15:34:39.508570
[0m15:34:39.508917 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:34:39.542974 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:34:39.543944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:39.544686 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
),

with categories_ordered as ( 
    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items`
) 

left join weekly revenue on id = categories_ordered.order_id

group by 1, 2;


[0m15:34:40.506657 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword SELECT but got keyword WITH at [16:1]')
[0m15:34:41.222921 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c9422074-aaac-408e-8d10-a979441bc2ae&page=queryresults
[0m15:34:41.225417 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:34:39.509322 => 2023-05-03 15:34:41.225258
[0m15:34:41.231802 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected keyword SELECT but got keyword WITH at [16:1]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:34:41.232549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f693fee3-c3f3-4f0f-8e63-94dd540d73b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d94cd6560>]}
[0m15:34:41.233392 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.73s]
[0m15:34:41.237392 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:34:41.240968 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:34:41.242747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:41.243180 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:34:41.243632 [info ] [MainThread]: 
[0m15:34:41.244266 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m15:34:41.245586 [debug] [MainThread]: Command end result
[0m15:34:41.257262 [info ] [MainThread]: 
[0m15:34:41.258012 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:34:41.258915 [info ] [MainThread]: 
[0m15:34:41.259842 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:34:41.260831 [error] [MainThread]:   Syntax error: Expected keyword SELECT but got keyword WITH at [16:1]
[0m15:34:41.261742 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:34:41.262844 [info ] [MainThread]: 
[0m15:34:41.264049 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:34:41.265648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d94cf4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d94cf5330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d97e1b970>]}
[0m15:34:41.266177 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:35:31.989066 | 433eeae6-4bb2-4d33-b7cd-7ca2c79db6f6 ==============================
[0m15:35:31.989066 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:35:31.992484 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:35:31.992991 [debug] [MainThread]: Tracking: tracking
[0m15:35:31.997010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218f32920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb215f88520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb215f88e80>]}
[0m15:35:32.012399 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:35:32.049948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:35:32.050613 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:35:32.063537 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:35:32.136406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '433eeae6-4bb2-4d33-b7cd-7ca2c79db6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb215e3d7e0>]}
[0m15:35:32.143876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '433eeae6-4bb2-4d33-b7cd-7ca2c79db6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb215d2fa30>]}
[0m15:35:32.144332 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:35:32.144734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '433eeae6-4bb2-4d33-b7cd-7ca2c79db6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb218f32920>]}
[0m15:35:32.146102 [info ] [MainThread]: 
[0m15:35:32.148770 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:35:32.150064 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:35:32.150524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:35:33.236716 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:35:33.237319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:35:33.517561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '433eeae6-4bb2-4d33-b7cd-7ca2c79db6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb215d2eda0>]}
[0m15:35:33.518385 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:35:33.518793 [info ] [MainThread]: 
[0m15:35:33.524508 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:35:33.524997 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:35:33.526180 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:35:33.526486 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:35:33.529882 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:35:33.530413 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:35:33.526673 => 2023-05-03 15:35:33.530325
[0m15:35:33.530834 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:35:33.592496 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:35:33.594628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:35:33.597265 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

with categories_ordered as ( 
    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items`
) 

select * 
left join weekly revenue on id = categories_ordered.order_id

group by 1, 2;


[0m15:35:33.950476 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]')
[0m15:35:35.027150 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0fa399b6-8060-45c3-a162-ace4690b0de1&page=queryresults
[0m15:35:35.028204 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:35:33.531102 => 2023-05-03 15:35:35.028081
[0m15:35:35.031421 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:35:35.031870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '433eeae6-4bb2-4d33-b7cd-7ca2c79db6f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb215d67520>]}
[0m15:35:35.032378 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.51s]
[0m15:35:35.034260 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:35:35.036560 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:35:35.037121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:35:35.037341 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:35:35.038938 [info ] [MainThread]: 
[0m15:35:35.039268 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m15:35:35.039629 [debug] [MainThread]: Command end result
[0m15:35:35.046259 [info ] [MainThread]: 
[0m15:35:35.046743 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:35:35.047491 [info ] [MainThread]: 
[0m15:35:35.047907 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:35:35.048347 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]
[0m15:35:35.049138 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:35:35.049555 [info ] [MainThread]: 
[0m15:35:35.049976 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:35:35.050504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb215f8b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb215f89120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb215d7e650>]}
[0m15:35:35.051701 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:36:22.461727 | 638d2e28-158b-43ac-9eed-faf3bed2176b ==============================
[0m15:36:22.461727 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:36:22.464384 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:36:22.464700 [debug] [MainThread]: Tracking: tracking
[0m15:36:22.467787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0216bf10c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0216bf0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0216bf1060>]}
[0m15:36:22.483663 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:36:22.521986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:22.522867 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:36:22.536088 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:36:22.609652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '638d2e28-158b-43ac-9eed-faf3bed2176b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0216b01600>]}
[0m15:36:22.617348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '638d2e28-158b-43ac-9eed-faf3bed2176b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0216b9b880>]}
[0m15:36:22.617801 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:36:22.618205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '638d2e28-158b-43ac-9eed-faf3bed2176b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0216b9b8b0>]}
[0m15:36:22.619570 [info ] [MainThread]: 
[0m15:36:22.621745 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:36:22.623124 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:36:22.623527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:23.709038 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:36:23.709535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:36:24.010962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '638d2e28-158b-43ac-9eed-faf3bed2176b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0216b9b8e0>]}
[0m15:36:24.011820 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:36:24.012372 [info ] [MainThread]: 
[0m15:36:24.016863 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:36:24.017319 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:36:24.018208 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:36:24.018504 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:36:24.022151 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:36:24.022657 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:36:24.018696 => 2023-05-03 15:36:24.022567
[0m15:36:24.023031 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:36:24.060128 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:36:24.060785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:36:24.061773 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

with categories_ordered as ( 
    select
        order_id
        , product_id
        , (products.category) as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items`
) 

 
left join weekly revenue on id = categories_ordered.order_id

group by 1, 2;


[0m15:36:24.410287 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]')
[0m15:36:25.105208 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:575f12b5-ce1d-4edd-a372-541c32f4cda7&page=queryresults
[0m15:36:25.105997 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:36:24.023214 => 2023-05-03 15:36:25.105882
[0m15:36:25.108893 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:36:25.109379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '638d2e28-158b-43ac-9eed-faf3bed2176b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0216bd3460>]}
[0m15:36:25.109885 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.09s]
[0m15:36:25.111816 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:36:25.113792 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:36:25.114330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:25.114546 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:36:25.114763 [info ] [MainThread]: 
[0m15:36:25.115133 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m15:36:25.115648 [debug] [MainThread]: Command end result
[0m15:36:25.122933 [info ] [MainThread]: 
[0m15:36:25.123574 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:36:25.124190 [info ] [MainThread]: 
[0m15:36:25.124788 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:36:25.125288 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [16:1]
[0m15:36:25.126281 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:36:25.126769 [info ] [MainThread]: 
[0m15:36:25.127229 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:36:25.128002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0216bf15d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0216bf05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02169eeb60>]}
[0m15:36:25.128438 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:38:01.903192 | b2748444-7b80-47f9-9ab4-7b80f3e547f2 ==============================
[0m15:38:01.903192 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:38:01.905874 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:38:01.906260 [debug] [MainThread]: Tracking: tracking
[0m15:38:01.916699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09541ed510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09541ecfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09541ec820>]}
[0m15:38:01.932233 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:38:01.966939 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:01.967601 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:38:01.980348 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:38:02.072620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2748444-7b80-47f9-9ab4-7b80f3e547f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0954101270>]}
[0m15:38:02.086045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2748444-7b80-47f9-9ab4-7b80f3e547f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09541974f0>]}
[0m15:38:02.086810 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:38:02.087965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2748444-7b80-47f9-9ab4-7b80f3e547f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0954197520>]}
[0m15:38:02.090004 [info ] [MainThread]: 
[0m15:38:02.093400 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:38:02.095315 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:38:02.095761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:03.260838 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:38:03.261779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:03.576695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2748444-7b80-47f9-9ab4-7b80f3e547f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0954196890>]}
[0m15:38:03.577525 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:38:03.578233 [info ] [MainThread]: 
[0m15:38:03.583024 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:38:03.583434 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:38:03.584168 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:38:03.584443 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:38:03.588167 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:38:03.588694 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:38:03.584614 => 2023-05-03 15:38:03.588604
[0m15:38:03.589045 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:38:03.623565 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:38:03.624290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:03.624996 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly revenue on id = order_items.order_id

group by 1, 2;


[0m15:38:03.959343 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "weekly" must be qualified with a dataset (e.g. dataset.table).')
[0m15:38:04.448429 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:20584aa2-0dfa-48d1-aa68-bdf20db4def4&page=queryresults
[0m15:38:04.449430 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:38:03.589253 => 2023-05-03 15:38:04.449337
[0m15:38:04.452226 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Table "weekly" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:38:04.452644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2748444-7b80-47f9-9ab4-7b80f3e547f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09541d2890>]}
[0m15:38:04.453169 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.87s]
[0m15:38:04.454980 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:38:04.456839 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:38:04.457437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:04.457658 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:38:04.457923 [info ] [MainThread]: 
[0m15:38:04.458313 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m15:38:04.458746 [debug] [MainThread]: Command end result
[0m15:38:04.466050 [info ] [MainThread]: 
[0m15:38:04.466606 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:38:04.467085 [info ] [MainThread]: 
[0m15:38:04.467726 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:38:04.468298 [error] [MainThread]:   Table "weekly" must be qualified with a dataset (e.g. dataset.table).
[0m15:38:04.468906 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:38:04.469453 [info ] [MainThread]: 
[0m15:38:04.470062 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:38:04.470659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0953ff1d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0953ff3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0953ff13f0>]}
[0m15:38:04.471050 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:38:26.397956 | 7effddc8-3251-4bde-9f1d-231293d10f85 ==============================
[0m15:38:26.397956 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:38:26.400594 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:38:26.400941 [debug] [MainThread]: Tracking: tracking
[0m15:38:26.409789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe228c18790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225c90640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225c90910>]}
[0m15:38:26.426341 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:38:26.465792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:26.466378 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:38:26.479724 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:38:26.550085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7effddc8-3251-4bde-9f1d-231293d10f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225b49840>]}
[0m15:38:26.557951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7effddc8-3251-4bde-9f1d-231293d10f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225a37ac0>]}
[0m15:38:26.558408 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:38:26.558823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7effddc8-3251-4bde-9f1d-231293d10f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225a37af0>]}
[0m15:38:26.560205 [info ] [MainThread]: 
[0m15:38:26.562385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:38:26.563784 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:38:26.564256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:27.865185 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:38:27.865658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:28.155960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7effddc8-3251-4bde-9f1d-231293d10f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225a37d00>]}
[0m15:38:28.156811 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:38:28.157263 [info ] [MainThread]: 
[0m15:38:28.162585 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:38:28.163162 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:38:28.164383 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:38:28.164758 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:38:28.170038 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:38:28.170672 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:38:28.165031 => 2023-05-03 15:38:28.170578
[0m15:38:28.171805 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:38:28.223005 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:38:28.223964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:28.224677 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on id = order_items.order_id

group by 1, 2;


[0m15:38:29.163982 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [10:9]')
[0m15:38:30.871376 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cd1cf2ad-45c9-4092-88f9-80ffbf51635f&page=queryresults
[0m15:38:30.872388 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:38:28.172083 => 2023-05-03 15:38:30.872300
[0m15:38:30.875314 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:38:30.875799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7effddc8-3251-4bde-9f1d-231293d10f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225a6ef50>]}
[0m15:38:30.876396 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.71s]
[0m15:38:30.878854 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:38:30.880875 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:38:30.881459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:30.881676 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:38:30.881940 [info ] [MainThread]: 
[0m15:38:30.882261 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.32 seconds (4.32s).
[0m15:38:30.882665 [debug] [MainThread]: Command end result
[0m15:38:30.888908 [info ] [MainThread]: 
[0m15:38:30.889988 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:38:30.890386 [info ] [MainThread]: 
[0m15:38:30.891641 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:38:30.893261 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
[0m15:38:30.894675 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:38:30.896045 [info ] [MainThread]: 
[0m15:38:30.898240 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:38:30.899312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe228c19cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225a8b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe225a8a710>]}
[0m15:38:30.899718 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:39:07.040928 | 05bca198-10af-44fc-9ccb-a01121000934 ==============================
[0m15:39:07.040928 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:39:07.043544 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:39:07.043878 [debug] [MainThread]: Tracking: tracking
[0m15:39:07.047275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c7de740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c7dc6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c7dd180>]}
[0m15:39:07.063212 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:39:07.105670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:07.106338 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:39:07.119167 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:39:07.189853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05bca198-10af-44fc-9ccb-a01121000934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c65d4e0>]}
[0m15:39:07.197289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05bca198-10af-44fc-9ccb-a01121000934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c58b760>]}
[0m15:39:07.197740 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:39:07.198138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05bca198-10af-44fc-9ccb-a01121000934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c58b790>]}
[0m15:39:07.199463 [info ] [MainThread]: 
[0m15:39:07.201630 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:39:07.202954 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:39:07.203356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:08.425766 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:39:08.426505 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:08.705150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05bca198-10af-44fc-9ccb-a01121000934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c58ab30>]}
[0m15:39:08.705940 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:39:08.706345 [info ] [MainThread]: 
[0m15:39:08.710639 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:39:08.711076 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:39:08.711896 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:39:08.712197 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:39:08.716630 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:39:08.717158 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:39:08.712399 => 2023-05-03 15:39:08.717054
[0m15:39:08.717579 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:39:08.752206 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:39:08.752896 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:08.753641 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id

group by 1, 2;


[0m15:39:09.677673 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [10:9]')
[0m15:39:11.225129 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4c4963df-7351-46b3-ac4c-077dad02e137&page=queryresults
[0m15:39:11.226027 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:39:08.717797 => 2023-05-03 15:39:11.225911
[0m15:39:11.228896 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:39:11.229425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05bca198-10af-44fc-9ccb-a01121000934', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c5c0b80>]}
[0m15:39:11.229988 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.52s]
[0m15:39:11.232321 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:39:11.234088 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:39:11.234617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:11.235102 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:39:11.235337 [info ] [MainThread]: 
[0m15:39:11.235702 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m15:39:11.236241 [debug] [MainThread]: Command end result
[0m15:39:11.242672 [info ] [MainThread]: 
[0m15:39:11.243171 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:39:11.243725 [info ] [MainThread]: 
[0m15:39:11.244190 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:39:11.244703 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
[0m15:39:11.245214 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:39:11.245745 [info ] [MainThread]: 
[0m15:39:11.246330 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:39:11.247002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c5daec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c5da680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0c5dafe0>]}
[0m15:39:11.247449 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:41:51.845476 | 5db3356c-2ecd-46bd-999c-505f954f4fed ==============================
[0m15:41:51.845476 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:41:51.848160 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:41:51.848528 [debug] [MainThread]: Tracking: tracking
[0m15:41:51.853158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce7ecfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce7ec460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce7ecf70>]}
[0m15:41:51.871099 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:41:51.906983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:51.907415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:51.913542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5db3356c-2ecd-46bd-999c-505f954f4fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce7dfeb0>]}
[0m15:41:51.921504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5db3356c-2ecd-46bd-999c-505f954f4fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce700e50>]}
[0m15:41:51.921978 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:41:51.922649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5db3356c-2ecd-46bd-999c-505f954f4fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce700eb0>]}
[0m15:41:51.924710 [info ] [MainThread]: 
[0m15:41:51.927794 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:41:51.929283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:41:51.929861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:52.991851 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:41:52.992445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:53.322337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5db3356c-2ecd-46bd-999c-505f954f4fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce7ec4f0>]}
[0m15:41:53.323141 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:41:53.323853 [info ] [MainThread]: 
[0m15:41:53.329413 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:41:53.329889 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:41:53.330610 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:41:53.330892 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:41:53.336780 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:41:53.337616 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:41:53.331062 => 2023-05-03 15:41:53.337534
[0m15:41:53.337981 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:41:53.419505 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:41:53.420500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:53.421269 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id

group by 1, 2;


[0m15:41:54.267959 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [10:9]')
[0m15:41:55.811729 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c0d870ca-efbb-48ca-ad8b-10e7431881a9&page=queryresults
[0m15:41:55.812751 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:41:53.338292 => 2023-05-03 15:41:55.812645
[0m15:41:55.815655 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:41:55.816119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5db3356c-2ecd-46bd-999c-505f954f4fed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce7c1840>]}
[0m15:41:55.816622 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.49s]
[0m15:41:55.818997 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:41:55.821052 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:41:55.821664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:55.821887 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:41:55.822158 [info ] [MainThread]: 
[0m15:41:55.822489 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m15:41:55.822909 [debug] [MainThread]: Command end result
[0m15:41:55.853304 [info ] [MainThread]: 
[0m15:41:55.862822 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:41:55.873827 [info ] [MainThread]: 
[0m15:41:55.878612 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:41:55.879636 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
[0m15:41:55.881265 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:41:55.883837 [info ] [MainThread]: 
[0m15:41:55.884849 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:41:55.886819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce700d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce797340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ce805c00>]}
[0m15:41:55.887398 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:42:28.924513 | 9b50836e-01ca-49dc-afba-a1dbcc4405fd ==============================
[0m15:42:28.924513 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:42:28.927122 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:42:28.927466 [debug] [MainThread]: Tracking: tracking
[0m15:42:28.930965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f0bbec850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f08ae05e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f08ae0f40>]}
[0m15:42:28.946363 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:42:28.986498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:42:28.987166 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:42:28.999895 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:42:29.078498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b50836e-01ca-49dc-afba-a1dbcc4405fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f087f9690>]}
[0m15:42:29.086225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b50836e-01ca-49dc-afba-a1dbcc4405fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f0888f8e0>]}
[0m15:42:29.086677 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:42:29.087130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b50836e-01ca-49dc-afba-a1dbcc4405fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f0bbec850>]}
[0m15:42:29.088499 [info ] [MainThread]: 
[0m15:42:29.090826 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:29.092416 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:42:29.092859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:30.347870 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:42:30.348443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:30.643059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b50836e-01ca-49dc-afba-a1dbcc4405fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f0888f970>]}
[0m15:42:30.643906 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:42:30.644316 [info ] [MainThread]: 
[0m15:42:30.648824 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:42:30.649281 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:42:30.650092 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:42:30.650384 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:42:30.653741 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:42:30.654272 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:42:30.650572 => 2023-05-03 15:42:30.654185
[0m15:42:30.654614 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:42:30.688811 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:42:30.689526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:30.690218 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id

group by 2;


[0m15:42:31.530035 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [10:9]')
[0m15:42:32.852029 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a074f679-3f59-4cdd-bbe9-2f29962f495e&page=queryresults
[0m15:42:32.852957 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:42:30.654792 => 2023-05-03 15:42:32.852843
[0m15:42:32.856606 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:42:32.857110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b50836e-01ca-49dc-afba-a1dbcc4405fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f088c8850>]}
[0m15:42:32.857670 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.21s]
[0m15:42:32.860000 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:42:32.862058 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:32.862587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:32.862803 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:42:32.863024 [info ] [MainThread]: 
[0m15:42:32.863390 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m15:42:32.863908 [debug] [MainThread]: Command end result
[0m15:42:32.870708 [info ] [MainThread]: 
[0m15:42:32.871196 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:42:32.871652 [info ] [MainThread]: 
[0m15:42:32.872078 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:42:32.872521 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
[0m15:42:32.872960 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:42:32.873427 [info ] [MainThread]: 
[0m15:42:32.873837 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:42:32.874335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f08ae1c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f088e6e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f088e63e0>]}
[0m15:42:32.874773 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:43:12.696216 | 3c6e95a9-f751-47c6-85fe-a58c3cfe1448 ==============================
[0m15:43:12.696216 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:43:12.698935 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:43:12.699282 [debug] [MainThread]: Tracking: tracking
[0m15:43:12.704829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d0c5d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2369fe0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2369fe04c0>]}
[0m15:43:12.720566 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:43:12.757645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:43:12.758318 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:43:12.771403 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:43:12.844921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c6e95a9-f751-47c6-85fe-a58c3cfe1448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2369cf9a50>]}
[0m15:43:12.852338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c6e95a9-f751-47c6-85fe-a58c3cfe1448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2369d8fcd0>]}
[0m15:43:12.852799 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:43:12.853221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c6e95a9-f751-47c6-85fe-a58c3cfe1448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2369d8fd00>]}
[0m15:43:12.854587 [info ] [MainThread]: 
[0m15:43:12.856724 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:43:12.858082 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:43:12.858507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:14.076392 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:43:14.076993 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:14.357389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c6e95a9-f751-47c6-85fe-a58c3cfe1448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2369d8f010>]}
[0m15:43:14.358238 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:43:14.358659 [info ] [MainThread]: 
[0m15:43:14.364125 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:43:14.364637 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:43:14.365499 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:43:14.365910 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:43:14.369958 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:43:14.370675 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:43:14.366110 => 2023-05-03 15:43:14.370553
[0m15:43:14.371085 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:43:14.405017 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:43:14.405690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:14.406409 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`     
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id;


[0m15:43:15.362054 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [10:9]')
[0m15:43:16.706282 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7e0b0298-03c1-4831-9406-b1d88f6be747&page=queryresults
[0m15:43:16.707339 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:43:14.371274 => 2023-05-03 15:43:16.707246
[0m15:43:16.710338 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:43:16.710837 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c6e95a9-f751-47c6-85fe-a58c3cfe1448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23698b4e20>]}
[0m15:43:16.711398 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.35s]
[0m15:43:16.713786 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:43:16.715649 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:43:16.716184 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:16.716396 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:43:16.716623 [info ] [MainThread]: 
[0m15:43:16.716975 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m15:43:16.717525 [debug] [MainThread]: Command end result
[0m15:43:16.724571 [info ] [MainThread]: 
[0m15:43:16.725153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:43:16.725640 [info ] [MainThread]: 
[0m15:43:16.726100 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:43:16.726684 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
[0m15:43:16.727215 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:43:16.727761 [info ] [MainThread]: 
[0m15:43:16.728318 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:43:16.729023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f236d0c6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2369d8fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2369d8f220>]}
[0m15:43:16.729557 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:45:02.224355 | 0f76ed96-2fa6-44c9-9254-ab3d92ab209c ==============================
[0m15:45:02.224355 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:45:02.227012 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:45:02.227590 [debug] [MainThread]: Tracking: tracking
[0m15:45:02.233013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc975c1f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc972af84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc972af8580>]}
[0m15:45:02.248939 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:45:02.284343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:02.285009 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:45:02.298038 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:45:02.368470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f76ed96-2fa6-44c9-9254-ab3d92ab209c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc972a0d990>]}
[0m15:45:02.375913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f76ed96-2fa6-44c9-9254-ab3d92ab209c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc972aa3c10>]}
[0m15:45:02.376375 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:45:02.376777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f76ed96-2fa6-44c9-9254-ab3d92ab209c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc972aa3c40>]}
[0m15:45:02.378131 [info ] [MainThread]: 
[0m15:45:02.380267 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:45:02.381691 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:45:02.382132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:03.446833 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:45:03.447297 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:03.733321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f76ed96-2fa6-44c9-9254-ab3d92ab209c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc972aa3e20>]}
[0m15:45:03.734118 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:45:03.734837 [info ] [MainThread]: 
[0m15:45:03.739456 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:45:03.739958 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:45:03.740893 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:45:03.741261 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:45:03.744683 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:45:03.745516 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:45:03.741541 => 2023-05-03 15:45:03.745414
[0m15:45:03.745889 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:45:03.780261 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:45:03.781275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:03.782021 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1   
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id;


[0m15:45:04.681706 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column created_at which is neither grouped nor aggregated at [11:27]')
[0m15:45:05.532919 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2f8a9117-7b60-44fe-95df-a472168ad5a9&page=queryresults
[0m15:45:05.533849 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:45:03.746990 => 2023-05-03 15:45:05.533733
[0m15:45:05.537010 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column created_at which is neither grouped nor aggregated at [11:27]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:45:05.537499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f76ed96-2fa6-44c9-9254-ab3d92ab209c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc972adf3d0>]}
[0m15:45:05.538006 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.80s]
[0m15:45:05.540369 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:45:05.542237 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:45:05.542900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:05.543128 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:45:05.543400 [info ] [MainThread]: 
[0m15:45:05.543774 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m15:45:05.544416 [debug] [MainThread]: Command end result
[0m15:45:05.552028 [info ] [MainThread]: 
[0m15:45:05.552609 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:45:05.553125 [info ] [MainThread]: 
[0m15:45:05.553689 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:45:05.554222 [error] [MainThread]:   SELECT list expression references column created_at which is neither grouped nor aggregated at [11:27]
[0m15:45:05.554745 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:45:05.555288 [info ] [MainThread]: 
[0m15:45:05.555825 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:45:05.556484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc975c1f9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9728ffc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9728fd8a0>]}
[0m15:45:05.556991 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:45:19.580867 | ea851bc3-c4bc-4c15-80c7-73d8371f7606 ==============================
[0m15:45:19.580867 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:45:19.583674 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:45:19.584174 [debug] [MainThread]: Tracking: tracking
[0m15:45:19.590751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac752e5030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac752e44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac752e4fd0>]}
[0m15:45:19.606559 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:45:19.648743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:45:19.649444 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:45:19.662836 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:45:19.770908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea851bc3-c4bc-4c15-80c7-73d8371f7606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac74ffd600>]}
[0m15:45:19.778278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea851bc3-c4bc-4c15-80c7-73d8371f7606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac75093880>]}
[0m15:45:19.778719 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:45:19.779139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea851bc3-c4bc-4c15-80c7-73d8371f7606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac750938b0>]}
[0m15:45:19.780477 [info ] [MainThread]: 
[0m15:45:19.782847 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:45:19.784334 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:45:19.785020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:20.859988 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:45:20.860478 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:21.145451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea851bc3-c4bc-4c15-80c7-73d8371f7606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac750938e0>]}
[0m15:45:21.146642 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:45:21.147439 [info ] [MainThread]: 
[0m15:45:21.152526 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:45:21.153066 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:45:21.154026 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:45:21.154314 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:45:21.157806 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:45:21.158318 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:45:21.154502 => 2023-05-03 15:45:21.158228
[0m15:45:21.158689 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:45:21.192389 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:45:21.193111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:21.193876 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 2   
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id;


[0m15:45:22.028381 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [10:9]')
[0m15:45:23.069563 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:837c4a0e-8eb7-43f8-8d04-57611d3b957d&page=queryresults
[0m15:45:23.070590 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:45:21.158908 => 2023-05-03 15:45:23.070470
[0m15:45:23.073617 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:45:23.074057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea851bc3-c4bc-4c15-80c7-73d8371f7606', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac750c9f30>]}
[0m15:45:23.074569 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.92s]
[0m15:45:23.076979 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:45:23.078884 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:45:23.079453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:23.079667 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:45:23.079929 [info ] [MainThread]: 
[0m15:45:23.080315 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m15:45:23.080811 [debug] [MainThread]: Command end result
[0m15:45:23.087675 [info ] [MainThread]: 
[0m15:45:23.088235 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:45:23.088707 [info ] [MainThread]: 
[0m15:45:23.089285 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:45:23.089846 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
[0m15:45:23.090394 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:45:23.090937 [info ] [MainThread]: 
[0m15:45:23.091489 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:45:23.092153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac750e3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac750e1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac750e3820>]}
[0m15:45:23.092703 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:46:25.880419 | 66839eb4-837d-4d3b-8940-a65cf35389e0 ==============================
[0m15:46:25.880419 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:46:25.883341 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:46:25.883812 [debug] [MainThread]: Tracking: tracking
[0m15:46:25.891117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ea6c4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e75e0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e75e0f10>]}
[0m15:46:25.907153 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:46:25.945040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:46:25.945705 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:46:25.959090 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:46:26.030572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66839eb4-837d-4d3b-8940-a65cf35389e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e72f96c0>]}
[0m15:46:26.037863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66839eb4-837d-4d3b-8940-a65cf35389e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e738f9a0>]}
[0m15:46:26.038304 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:46:26.038702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66839eb4-837d-4d3b-8940-a65cf35389e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e738f9d0>]}
[0m15:46:26.040039 [info ] [MainThread]: 
[0m15:46:26.042538 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:46:26.043959 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:46:26.044395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:27.134201 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:46:27.134681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:27.444116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66839eb4-837d-4d3b-8940-a65cf35389e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e738fa60>]}
[0m15:46:27.445004 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:46:27.445534 [info ] [MainThread]: 
[0m15:46:27.450086 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:46:27.450502 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:46:27.451287 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:46:27.451558 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:46:27.454974 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:46:27.455483 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:46:27.451741 => 2023-05-03 15:46:27.455396
[0m15:46:27.455846 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:46:27.488931 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:46:27.489603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:27.490321 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by week_of   
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id;


[0m15:46:28.422492 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [10:9]')
[0m15:46:29.621072 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:31f42996-129b-4008-a740-d9d9b422f24c&page=queryresults
[0m15:46:29.622739 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:46:27.456027 => 2023-05-03 15:46:29.622620
[0m15:46:29.625459 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:46:29.625891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66839eb4-837d-4d3b-8940-a65cf35389e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e73c8ac0>]}
[0m15:46:29.626373 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.17s]
[0m15:46:29.628693 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:46:29.630692 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:46:29.631221 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:29.631432 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:46:29.631648 [info ] [MainThread]: 
[0m15:46:29.632005 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m15:46:29.632535 [debug] [MainThread]: Command end result
[0m15:46:29.639681 [info ] [MainThread]: 
[0m15:46:29.640332 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:46:29.640809 [info ] [MainThread]: 
[0m15:46:29.641295 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:46:29.641843 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
[0m15:46:29.642431 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:46:29.642900 [info ] [MainThread]: 
[0m15:46:29.643529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:46:29.644201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44ea6c4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e73e6ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44e73e6ec0>]}
[0m15:46:29.644695 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:49:02.598062 | 6ebac170-97a9-4fc3-b52a-2cf2f9bbf477 ==============================
[0m15:49:02.598062 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:49:02.600695 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:49:02.601141 [debug] [MainThread]: Tracking: tracking
[0m15:49:02.607476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c38f66e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c38f4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c38f51e0>]}
[0m15:49:02.622618 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:49:02.658774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:02.659523 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:49:02.672152 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:49:02.737701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ebac170-97a9-4fc3-b52a-2cf2f9bbf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c38094b0>]}
[0m15:49:02.746265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ebac170-97a9-4fc3-b52a-2cf2f9bbf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c389f730>]}
[0m15:49:02.746690 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:49:02.747079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ebac170-97a9-4fc3-b52a-2cf2f9bbf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c389f760>]}
[0m15:49:02.748765 [info ] [MainThread]: 
[0m15:49:02.750889 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:49:02.751982 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:49:02.752461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:03.856050 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:49:03.856522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:04.160733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ebac170-97a9-4fc3-b52a-2cf2f9bbf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c389eb00>]}
[0m15:49:04.161612 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:49:04.162031 [info ] [MainThread]: 
[0m15:49:04.166567 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:49:04.167039 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:49:04.167932 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:49:04.168269 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:49:04.171630 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:49:04.172390 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:49:04.168622 => 2023-05-03 15:49:04.172314
[0m15:49:04.172727 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:49:04.206682 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:49:04.207569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:04.208275 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`    
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id;


[0m15:49:05.322744 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [8:9]')
[0m15:49:06.436242 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:484c36ce-d288-4282-a2cf-3895c91d5c05&page=queryresults
[0m15:49:06.437179 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:49:04.172977 => 2023-05-03 15:49:06.437046
[0m15:49:06.440292 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [8:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:49:06.440771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ebac170-97a9-4fc3-b52a-2cf2f9bbf477', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c38d8340>]}
[0m15:49:06.441340 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.27s]
[0m15:49:06.443610 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:49:06.445401 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:49:06.445960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:06.446191 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:49:06.446447 [info ] [MainThread]: 
[0m15:49:06.446781 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m15:49:06.447192 [debug] [MainThread]: Command end result
[0m15:49:06.453381 [info ] [MainThread]: 
[0m15:49:06.454315 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:49:06.455195 [info ] [MainThread]: 
[0m15:49:06.455707 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:49:06.456158 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [8:9]
[0m15:49:06.456886 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:49:06.457394 [info ] [MainThread]: 
[0m15:49:06.458154 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:49:06.458714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c36fae90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c36fafb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c36fb1c0>]}
[0m15:49:06.459088 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:49:55.046714 | 62b00909-a015-486a-93da-0c5fbd0dfcc7 ==============================
[0m15:49:55.046714 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:49:55.049563 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:49:55.050047 [debug] [MainThread]: Tracking: tracking
[0m15:49:55.057138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e21c6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34df0e0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34df0e05b0>]}
[0m15:49:55.072002 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:49:55.111471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:55.112332 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:49:55.125407 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:49:55.188382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62b00909-a015-486a-93da-0c5fbd0dfcc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dedf5960>]}
[0m15:49:55.195673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62b00909-a015-486a-93da-0c5fbd0dfcc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dee8fbe0>]}
[0m15:49:55.196071 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:49:55.196459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62b00909-a015-486a-93da-0c5fbd0dfcc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dee8fc10>]}
[0m15:49:55.198147 [info ] [MainThread]: 
[0m15:49:55.200202 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:49:55.201318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:49:55.201811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:56.259956 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:49:56.260438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:56.542532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62b00909-a015-486a-93da-0c5fbd0dfcc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dee8fd30>]}
[0m15:49:56.544234 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:49:56.544799 [info ] [MainThread]: 
[0m15:49:56.550323 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:49:56.550769 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:49:56.552353 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:49:56.552758 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:49:56.566169 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:49:56.567916 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:49:56.553036 => 2023-05-03 15:49:56.567813
[0m15:49:56.568438 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:49:56.611914 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:49:56.612801 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:56.613527 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`    
)

select
    order_id
    , product_id
    , products.category as product_category
from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id;


[0m15:49:57.559418 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [8:9]')
[0m15:49:58.559534 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4cc1269d-04a8-4220-bcde-08ecfa41c030&page=queryresults
[0m15:49:58.560371 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:49:56.568825 => 2023-05-03 15:49:58.560261
[0m15:49:58.563333 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [8:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:49:58.563767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '62b00909-a015-486a-93da-0c5fbd0dfcc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34de9b3850>]}
[0m15:49:58.564304 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.01s]
[0m15:49:58.566618 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:49:58.568531 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:49:58.569151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:58.569375 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:49:58.569642 [info ] [MainThread]: 
[0m15:49:58.570056 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.37 seconds (3.37s).
[0m15:49:58.570622 [debug] [MainThread]: Command end result
[0m15:49:58.579607 [info ] [MainThread]: 
[0m15:49:58.580822 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:49:58.582142 [info ] [MainThread]: 
[0m15:49:58.583201 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:49:58.583715 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [8:9]
[0m15:49:58.584312 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:49:58.584774 [info ] [MainThread]: 
[0m15:49:58.585318 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:49:58.586068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e21c6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dee8f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34dee8f730>]}
[0m15:49:58.586449 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:50:41.211778 | 907d9e62-086b-49fb-974b-25534759e467 ==============================
[0m15:50:41.211778 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:50:41.214894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:50:41.215538 [debug] [MainThread]: Tracking: tracking
[0m15:50:41.219265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f25dd060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f25dc4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f25dd000>]}
[0m15:50:41.234690 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:50:41.271802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:41.272383 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:50:41.284913 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:50:41.362904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '907d9e62-086b-49fb-974b-25534759e467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f245d660>]}
[0m15:50:41.374870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '907d9e62-086b-49fb-974b-25534759e467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f238b8e0>]}
[0m15:50:41.375574 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:50:41.376627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '907d9e62-086b-49fb-974b-25534759e467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f238b910>]}
[0m15:50:41.378563 [info ] [MainThread]: 
[0m15:50:41.380637 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:50:41.381878 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:50:41.382335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:42.426901 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:50:42.427468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:50:42.710847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '907d9e62-086b-49fb-974b-25534759e467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f238b940>]}
[0m15:50:42.712150 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:50:42.713759 [info ] [MainThread]: 
[0m15:50:42.718773 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:50:42.719195 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:50:42.719950 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:50:42.720219 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:50:42.723571 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:50:42.724035 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:50:42.720382 => 2023-05-03 15:50:42.723963
[0m15:50:42.724316 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:50:42.758589 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:50:42.759285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:50:42.760510 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders` 
    group by 1   
)

select
    order_id
    , product_id
    , products.category as product_category
from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id;


[0m15:50:43.752891 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]')
[0m15:50:45.357140 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8cc317db-81c1-4e67-93a9-4149edfe7f00&page=queryresults
[0m15:50:45.358539 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:50:42.724482 => 2023-05-03 15:50:45.358317
[0m15:50:45.365061 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:50:45.366229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '907d9e62-086b-49fb-974b-25534759e467', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f23c48b0>]}
[0m15:50:45.367393 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.65s]
[0m15:50:45.371956 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:50:45.375944 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:50:45.377026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:45.377428 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:50:45.377832 [info ] [MainThread]: 
[0m15:50:45.378863 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m15:50:45.380050 [debug] [MainThread]: Command end result
[0m15:50:45.394123 [info ] [MainThread]: 
[0m15:50:45.396278 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:45.397156 [info ] [MainThread]: 
[0m15:50:45.398206 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:50:45.399155 [error] [MainThread]:   SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
[0m15:50:45.400365 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:50:45.401492 [info ] [MainThread]: 
[0m15:50:45.403063 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:50:45.405111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f23e3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f23e2f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5f23e3370>]}
[0m15:50:45.415695 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:51:02.007014 | 30a376a4-088c-4994-8450-d66a526d1e8b ==============================
[0m15:51:02.007014 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:51:02.009706 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:51:02.010135 [debug] [MainThread]: Tracking: tracking
[0m15:51:02.015498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea33f1300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea33f0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea33f1270>]}
[0m15:51:02.030826 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:51:02.066329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:02.066955 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:51:02.079590 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:51:02.139464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30a376a4-088c-4994-8450-d66a526d1e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea33053f0>]}
[0m15:51:02.146609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30a376a4-088c-4994-8450-d66a526d1e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea339b670>]}
[0m15:51:02.147051 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:51:02.147452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30a376a4-088c-4994-8450-d66a526d1e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea339b6a0>]}
[0m15:51:02.148763 [info ] [MainThread]: 
[0m15:51:02.151866 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:02.152987 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:51:02.153488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:03.230164 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:51:03.230750 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:03.515798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30a376a4-088c-4994-8450-d66a526d1e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea339aa10>]}
[0m15:51:03.516629 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:51:03.517032 [info ] [MainThread]: 
[0m15:51:03.521579 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:51:03.522022 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:51:03.522868 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:51:03.523169 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:51:03.526958 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:51:03.527477 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:51:03.523364 => 2023-05-03 15:51:03.527387
[0m15:51:03.527833 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:51:03.561235 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:51:03.561887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:03.562602 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders` 
    group by 1   
)

select
    order_id
    , product_id
    , products.category as product_category
from `analytics-engineers-club`.`coffee_shop`.`order_items` 
group by 1
 
left join weekly_revenue on order_id = order_items.order_id;


[0m15:51:03.867246 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword LEFT at [22:1]')
[0m15:51:04.265911 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:31167dfc-d7b3-4362-977a-c4e074f2419f&page=queryresults
[0m15:51:04.266706 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:51:03.528009 => 2023-05-03 15:51:04.266590
[0m15:51:04.269638 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected end of input but got keyword LEFT at [22:1]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:51:04.270345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30a376a4-088c-4994-8450-d66a526d1e8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea33d6d40>]}
[0m15:51:04.270845 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.75s]
[0m15:51:04.272649 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:51:04.274533 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:04.275197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:04.275420 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:51:04.275686 [info ] [MainThread]: 
[0m15:51:04.276074 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m15:51:04.276569 [debug] [MainThread]: Command end result
[0m15:51:04.283732 [info ] [MainThread]: 
[0m15:51:04.284353 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:51:04.284825 [info ] [MainThread]: 
[0m15:51:04.285426 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:51:04.285898 [error] [MainThread]:   Syntax error: Expected end of input but got keyword LEFT at [22:1]
[0m15:51:04.286357 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:51:04.286749 [info ] [MainThread]: 
[0m15:51:04.287158 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:51:04.287783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea33f1c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea33f1e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ea31f5720>]}
[0m15:51:04.288216 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:51:40.037957 | 4a780bf0-28fd-4940-963f-7bef448d9966 ==============================
[0m15:51:40.037957 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:51:40.040527 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:51:40.040870 [debug] [MainThread]: Tracking: tracking
[0m15:51:40.044425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c257e1180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c257e0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c257e1150>]}
[0m15:51:40.059375 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:51:40.103797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:40.104375 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:51:40.125824 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:51:40.200011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a780bf0-28fd-4940-963f-7bef448d9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c254fd4b0>]}
[0m15:51:40.207394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a780bf0-28fd-4940-963f-7bef448d9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c2558f7c0>]}
[0m15:51:40.207849 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:51:40.208599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a780bf0-28fd-4940-963f-7bef448d9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c288c4fa0>]}
[0m15:51:40.210032 [info ] [MainThread]: 
[0m15:51:40.212215 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:40.213427 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:51:40.213910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:41.287007 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:51:41.287585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:41.572713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a780bf0-28fd-4940-963f-7bef448d9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c2558eb00>]}
[0m15:51:41.573549 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:51:41.574248 [info ] [MainThread]: 
[0m15:51:41.579125 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:51:41.579624 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:51:41.580540 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:51:41.580882 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:51:41.584207 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:51:41.584995 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:51:41.581188 => 2023-05-03 15:51:41.584924
[0m15:51:41.585399 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:51:41.618330 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:51:41.619189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:41.619910 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders` 
    group by 1   
)

select
    order_id
    , product_id
    , products.category as product_category
from `analytics-engineers-club`.`coffee_shop`.`order_items` 

 
left join weekly_revenue on order_id = order_items.order_id
group by 1;


[0m15:51:42.524965 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]')
[0m15:51:43.439772 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:850e65eb-6173-40cc-b06a-de7e44390fce&page=queryresults
[0m15:51:43.440810 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:51:41.585660 => 2023-05-03 15:51:43.440700
[0m15:51:43.443759 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:51:43.444179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a780bf0-28fd-4940-963f-7bef448d9966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c255c9600>]}
[0m15:51:43.444665 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.86s]
[0m15:51:43.447210 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:51:43.448923 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:43.449577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:43.449799 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:51:43.450066 [info ] [MainThread]: 
[0m15:51:43.450460 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m15:51:43.451030 [debug] [MainThread]: Command end result
[0m15:51:43.457341 [info ] [MainThread]: 
[0m15:51:43.457814 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:51:43.458235 [info ] [MainThread]: 
[0m15:51:43.458986 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:51:43.459398 [error] [MainThread]:   SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
[0m15:51:43.460101 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:51:43.460488 [info ] [MainThread]: 
[0m15:51:43.460891 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:51:43.461396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c257e1540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c255e7e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c255e71c0>]}
[0m15:51:43.462050 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:52:37.247522 | 7bb86395-6a42-49b9-bf59-6c484922b5cf ==============================
[0m15:52:37.247522 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:52:37.250826 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:52:37.251311 [debug] [MainThread]: Tracking: tracking
[0m15:52:37.257991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac786d9cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac755e0340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac755e03d0>]}
[0m15:52:37.279917 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:52:37.316875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:52:37.317484 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:52:37.330982 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:52:37.392158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bb86395-6a42-49b9-bf59-6c484922b5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac752f9b40>]}
[0m15:52:37.409809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bb86395-6a42-49b9-bf59-6c484922b5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7538fdc0>]}
[0m15:52:37.410621 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:52:37.411269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bb86395-6a42-49b9-bf59-6c484922b5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7538fdf0>]}
[0m15:52:37.413259 [info ] [MainThread]: 
[0m15:52:37.416581 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:52:37.418240 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:52:37.418857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:38.466191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:52:38.466660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:38.721733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bb86395-6a42-49b9-bf59-6c484922b5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7538f160>]}
[0m15:52:38.722537 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:52:38.722955 [info ] [MainThread]: 
[0m15:52:38.728288 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:52:38.728732 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:52:38.729530 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:52:38.729810 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:52:38.733124 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:52:38.733888 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:52:38.729986 => 2023-05-03 15:52:38.733814
[0m15:52:38.734225 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:52:38.767178 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:52:38.767679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:38.768358 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders` 
    group by 1   
)

select
    order_id
    , product_id
    , products.category as product_category
from `analytics-engineers-club`.`coffee_shop`.`order_items` as order_items
 
left join weekly_revenue on order_id = order_items.order_id;


[0m15:52:39.690229 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]')
[0m15:52:40.848607 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:55fafbca-4f73-42a8-824a-0bc52103502d&page=queryresults
[0m15:52:40.849392 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:52:38.734450 => 2023-05-03 15:52:40.849279
[0m15:52:40.852267 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:52:40.852680 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bb86395-6a42-49b9-bf59-6c484922b5cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac752be380>]}
[0m15:52:40.853189 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.12s]
[0m15:52:40.855290 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:52:40.857186 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:52:40.857746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:40.857965 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:52:40.858236 [info ] [MainThread]: 
[0m15:52:40.858633 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m15:52:40.859116 [debug] [MainThread]: Command end result
[0m15:52:40.865294 [info ] [MainThread]: 
[0m15:52:40.866133 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:52:40.866553 [info ] [MainThread]: 
[0m15:52:40.866977 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:52:40.867405 [error] [MainThread]:   SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
[0m15:52:40.868173 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:52:40.868590 [info ] [MainThread]: 
[0m15:52:40.869000 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:52:40.869916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7538fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7538f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac7538f0d0>]}
[0m15:52:40.870270 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 15:53:22.588221 | 80f0b6cd-38a0-4fab-b94b-2ee3d8cf03a9 ==============================
[0m15:53:22.588221 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:53:22.590802 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:53:22.591152 [debug] [MainThread]: Tracking: tracking
[0m15:53:22.594753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a5ef970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a5ece80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a5ed4b0>]}
[0m15:53:22.609473 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:53:22.655600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:53:22.658028 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m15:53:22.680900 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m15:53:22.769798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80f0b6cd-38a0-4fab-b94b-2ee3d8cf03a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a501360>]}
[0m15:53:22.778533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80f0b6cd-38a0-4fab-b94b-2ee3d8cf03a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a5975e0>]}
[0m15:53:22.778989 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m15:53:22.779471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f0b6cd-38a0-4fab-b94b-2ee3d8cf03a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a597610>]}
[0m15:53:22.780831 [info ] [MainThread]: 
[0m15:53:22.783172 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:53:22.784446 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:53:22.784850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:23.844170 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m15:53:23.844641 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:24.102670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f0b6cd-38a0-4fab-b94b-2ee3d8cf03a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a596410>]}
[0m15:53:24.103508 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:53:24.103979 [info ] [MainThread]: 
[0m15:53:24.108968 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:53:24.109388 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m15:53:24.110117 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m15:53:24.110394 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m15:53:24.113733 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:53:24.114554 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 15:53:24.110574 => 2023-05-03 15:53:24.114462
[0m15:53:24.115019 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m15:53:24.149895 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m15:53:24.150689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:24.151371 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders` 
    group by 1   
)

select
    order_id
    , product_id
    , products.category as product_category
from `analytics-engineers-club`.`coffee_shop`.`order_items` as order_items
 
left join weekly_revenue on order_id = order_items.order_id
order by week_of;


[0m15:53:25.515836 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]')
[0m15:53:27.157607 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ba6fe7bc-a918-4f52-a6f1-6609ea72393e&page=queryresults
[0m15:53:27.158707 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 15:53:24.115286 => 2023-05-03 15:53:27.158612
[0m15:53:27.161662 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:53:27.162092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80f0b6cd-38a0-4fab-b94b-2ee3d8cf03a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a5cc340>]}
[0m15:53:27.162588 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 3.05s]
[0m15:53:27.165059 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m15:53:27.167015 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:53:27.167582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:27.167809 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m15:53:27.168027 [info ] [MainThread]: 
[0m15:53:27.168534 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m15:53:27.169152 [debug] [MainThread]: Command end result
[0m15:53:27.175791 [info ] [MainThread]: 
[0m15:53:27.176342 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:53:27.176810 [info ] [MainThread]: 
[0m15:53:27.177321 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m15:53:27.178091 [error] [MainThread]:   SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
[0m15:53:27.178825 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m15:53:27.179287 [info ] [MainThread]: 
[0m15:53:27.180002 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:53:27.180772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a3ef760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a3ef130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe88a3ef010>]}
[0m15:53:27.181198 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:28:33.116155 | 96310c5e-b0dc-4334-8be0-4f02d8ed12be ==============================
[0m16:28:33.116155 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:28:33.119022 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:28:33.119482 [debug] [MainThread]: Tracking: tracking
[0m16:28:33.121450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5951ae3250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5951ae14b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5951ae39d0>]}
[0m16:28:33.136198 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:28:33.171986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:33.172406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:33.178406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96310c5e-b0dc-4334-8be0-4f02d8ed12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59518d42e0>]}
[0m16:28:33.186736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96310c5e-b0dc-4334-8be0-4f02d8ed12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59517f87c0>]}
[0m16:28:33.187280 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:28:33.187829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96310c5e-b0dc-4334-8be0-4f02d8ed12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59517f8820>]}
[0m16:28:33.189559 [info ] [MainThread]: 
[0m16:28:33.192093 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:28:33.193541 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:28:33.193964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:34.289344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:28:34.289952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:34.560241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96310c5e-b0dc-4334-8be0-4f02d8ed12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59517f8130>]}
[0m16:28:34.561048 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:28:34.561476 [info ] [MainThread]: 
[0m16:28:34.566197 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:28:34.566621 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:28:34.567441 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:28:34.567739 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:28:34.573124 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:28:34.573609 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:28:34.567923 => 2023-05-03 16:28:34.573526
[0m16:28:34.573972 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:28:34.663131 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:28:34.663937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:34.664954 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders` 
    group by 1   
)

select
    order_id
    , product_id
    , products.category as product_category
from `analytics-engineers-club`.`coffee_shop`.`order_items` as order_items
 
left join weekly_revenue on order_id = order_items.order_id
order by week_of;


[0m16:28:35.559593 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]')
[0m16:28:36.698775 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7b835d51-f4e5-423e-a614-07475744753a&page=queryresults
[0m16:28:36.699838 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:28:34.574158 => 2023-05-03 16:28:36.699752
[0m16:28:36.702681 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:28:36.703149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96310c5e-b0dc-4334-8be0-4f02d8ed12be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5951780b80>]}
[0m16:28:36.703693 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.14s]
[0m16:28:36.705569 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:28:36.707404 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:28:36.707978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:36.708194 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:28:36.708453 [info ] [MainThread]: 
[0m16:28:36.708846 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m16:28:36.709508 [debug] [MainThread]: Command end result
[0m16:28:36.719014 [info ] [MainThread]: 
[0m16:28:36.719620 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:28:36.720106 [info ] [MainThread]: 
[0m16:28:36.720758 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:28:36.721315 [error] [MainThread]:   SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
[0m16:28:36.721952 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:28:36.722526 [info ] [MainThread]: 
[0m16:28:36.723189 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:28:36.723919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59517f86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59517f81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59517f8190>]}
[0m16:28:36.724312 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:30:08.798047 | 2f391388-3166-4efa-b694-04365ec40340 ==============================
[0m16:30:08.798047 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:30:08.800522 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:30:08.800849 [debug] [MainThread]: Tracking: tracking
[0m16:30:08.806242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cca2e4a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cca2e7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cca2e5330>]}
[0m16:30:08.820666 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:30:08.853474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:30:08.853798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:30:08.859379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f391388-3166-4efa-b694-04365ec40340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cca0d8220>]}
[0m16:30:08.866855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f391388-3166-4efa-b694-04365ec40340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc9ffc700>]}
[0m16:30:08.867254 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:30:08.867821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f391388-3166-4efa-b694-04365ec40340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc9ffc760>]}
[0m16:30:08.869242 [info ] [MainThread]: 
[0m16:30:08.871133 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:30:08.872335 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:30:08.872792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:30:09.918483 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:30:09.918940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:30:10.212593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f391388-3166-4efa-b694-04365ec40340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc9ffc070>]}
[0m16:30:10.213394 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:30:10.213979 [info ] [MainThread]: 
[0m16:30:10.218569 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:30:10.219041 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:30:10.219930 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:30:10.220265 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:30:10.225748 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:30:10.226497 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:30:10.220536 => 2023-05-03 16:30:10.226423
[0m16:30:10.226828 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:30:10.311065 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:30:10.311693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:30:10.312361 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders` 
    group by 1   
)

select
    order_id
    , product_id
    , products.category as product_category
from `analytics-engineers-club`.`coffee_shop`.`order_items` as order_items
 
left join weekly_revenue on order_id = order_items.order_id
order by week_of;


[0m16:30:11.289980 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]')
[0m16:30:13.069244 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1041e410-8958-4d88-8671-4eefb138e6be&page=queryresults
[0m16:30:13.070136 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:30:10.227072 => 2023-05-03 16:30:13.070029
[0m16:30:13.072925 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:30:13.073473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f391388-3166-4efa-b694-04365ec40340', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc9f87250>]}
[0m16:30:13.074004 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.85s]
[0m16:30:13.075874 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:30:13.077791 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:30:13.078343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:30:13.078554 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:30:13.078796 [info ] [MainThread]: 
[0m16:30:13.079170 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.21 seconds (4.21s).
[0m16:30:13.079626 [debug] [MainThread]: Command end result
[0m16:30:13.085785 [info ] [MainThread]: 
[0m16:30:13.086655 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:30:13.087235 [info ] [MainThread]: 
[0m16:30:13.087761 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:30:13.088206 [error] [MainThread]:   SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
[0m16:30:13.088742 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:30:13.089232 [info ] [MainThread]: 
[0m16:30:13.089771 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:30:13.090386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc9ffc610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc9ffc130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6cc9ffc0d0>]}
[0m16:30:13.090829 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:31:15.795504 | f6d98712-d6db-4156-a152-487161827b8e ==============================
[0m16:31:15.795504 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:31:15.798321 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:31:15.798807 [debug] [MainThread]: Tracking: tracking
[0m16:31:15.805783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30fadb9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c97c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c97c580>]}
[0m16:31:15.820417 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:31:15.852564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:15.852987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:15.859029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6d98712-d6db-4156-a152-487161827b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c768c10>]}
[0m16:31:15.866732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6d98712-d6db-4156-a152-487161827b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c8350f0>]}
[0m16:31:15.867149 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:31:15.867606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d98712-d6db-4156-a152-487161827b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c835150>]}
[0m16:31:15.868930 [info ] [MainThread]: 
[0m16:31:15.870966 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:31:15.872314 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:31:15.872714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:16.933203 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:31:16.933771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:17.261205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6d98712-d6db-4156-a152-487161827b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c97d5a0>]}
[0m16:31:17.262025 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:31:17.262636 [info ] [MainThread]: 
[0m16:31:17.267042 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:31:17.267520 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:31:17.269291 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:31:17.269647 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:31:17.274746 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:31:17.275506 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:31:17.269916 => 2023-05-03 16:31:17.275427
[0m16:31:17.275853 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:31:17.352488 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:31:17.353791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:17.354900 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders` 
    group by 1   
)

select
    order_id
    , product_id
    , products.category as product_category
from `analytics-engineers-club`.`coffee_shop`.`order_items` as order_items
 
left join weekly_revenue on order_id = order_items.order_id
order by week_of;


[0m16:31:18.268950 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]')
[0m16:31:19.186717 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9bbe6ccc-8aa9-4a9b-bbef-861c6eb9e08b&page=queryresults
[0m16:31:19.187769 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:31:17.276100 => 2023-05-03 16:31:19.187682
[0m16:31:19.190582 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:31:19.191043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6d98712-d6db-4156-a152-487161827b8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c7529e0>]}
[0m16:31:19.191575 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.92s]
[0m16:31:19.193530 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:31:19.195178 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:31:19.195698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:19.195907 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:31:19.196117 [info ] [MainThread]: 
[0m16:31:19.196584 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m16:31:19.197181 [debug] [MainThread]: Command end result
[0m16:31:19.204015 [info ] [MainThread]: 
[0m16:31:19.204527 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:31:19.204985 [info ] [MainThread]: 
[0m16:31:19.205469 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:31:19.206052 [error] [MainThread]:   SELECT list expression references column created_at which is neither grouped nor aggregated at [9:27]
[0m16:31:19.207364 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:31:19.208064 [info ] [MainThread]: 
[0m16:31:19.208529 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:31:19.209318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c722a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c722e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb30c9965c0>]}
[0m16:31:19.209670 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:32:53.042947 | a60a3e73-f09c-4ed7-a8e0-22a9522f0fa6 ==============================
[0m16:32:53.042947 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:32:53.045651 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:32:53.046135 [debug] [MainThread]: Tracking: tracking
[0m16:32:53.047933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0efb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0ef8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0ef8a00>]}
[0m16:32:53.062104 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:32:53.097683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:32:53.098208 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m16:32:53.110512 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m16:32:53.172818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a60a3e73-f09c-4ed7-a8e0-22a9522f0fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0e0d300>]}
[0m16:32:53.182275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a60a3e73-f09c-4ed7-a8e0-22a9522f0fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0ea3580>]}
[0m16:32:53.182712 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:32:53.183174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a60a3e73-f09c-4ed7-a8e0-22a9522f0fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0ea35b0>]}
[0m16:32:53.184537 [info ] [MainThread]: 
[0m16:32:53.186818 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:32:53.188419 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:32:53.189033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:54.261285 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:32:54.261841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:54.547404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a60a3e73-f09c-4ed7-a8e0-22a9522f0fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0ea2890>]}
[0m16:32:54.548229 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:32:54.548654 [info ] [MainThread]: 
[0m16:32:54.554090 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:32:54.554527 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:32:54.555452 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:32:54.555731 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:32:54.558484 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:32:54.558985 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:32:54.555914 => 2023-05-03 16:32:54.558900
[0m16:32:54.559368 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:32:54.592029 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:32:54.592592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:54.593299 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with order_categories as (
    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items`
left join products on id = order_categories.product_id
)

 with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders` 
    group by 1,2  
)

left join weekly_revenue on order_id = order_categories.order_id
order by week_of;


[0m16:32:54.920788 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [14:2]')
[0m16:32:55.307589 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:09155977-7d59-4dd2-bec5-5e3a09b69267&page=queryresults
[0m16:32:55.308526 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:32:54.559611 => 2023-05-03 16:32:55.308438
[0m16:32:55.311278 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [14:2]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:32:55.311701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60a3e73-f09c-4ed7-a8e0-22a9522f0fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0edc790>]}
[0m16:32:55.312179 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.76s]
[0m16:32:55.313961 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:32:55.315807 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:32:55.316331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:55.316542 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:32:55.316752 [info ] [MainThread]: 
[0m16:32:55.317290 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m16:32:55.317733 [debug] [MainThread]: Command end result
[0m16:32:55.324801 [info ] [MainThread]: 
[0m16:32:55.325338 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:32:55.327044 [info ] [MainThread]: 
[0m16:32:55.327867 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:32:55.328361 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [14:2]
[0m16:32:55.329103 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:32:55.329569 [info ] [MainThread]: 
[0m16:32:55.330335 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:32:55.330869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0efb3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0ef8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cd0cff670>]}
[0m16:32:55.331225 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:34:50.082706 | ce0c7738-44fc-4b64-b7e9-7dd88f96c288 ==============================
[0m16:34:50.082706 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:34:50.085552 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:34:50.086061 [debug] [MainThread]: Tracking: tracking
[0m16:34:50.087930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe9f14df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe6dec610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe6dec6a0>]}
[0m16:34:50.102655 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:34:50.142890 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:34:50.143701 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m16:34:50.157476 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m16:34:50.220616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce0c7738-44fc-4b64-b7e9-7dd88f96c288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe6d01870>]}
[0m16:34:50.229288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce0c7738-44fc-4b64-b7e9-7dd88f96c288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe6d97af0>]}
[0m16:34:50.229794 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:34:50.230239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce0c7738-44fc-4b64-b7e9-7dd88f96c288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe6d97b20>]}
[0m16:34:50.231848 [info ] [MainThread]: 
[0m16:34:50.234211 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:34:50.235601 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:34:50.236062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:51.474461 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:34:51.474982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:51.742367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce0c7738-44fc-4b64-b7e9-7dd88f96c288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe6d968f0>]}
[0m16:34:51.743167 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:34:51.743579 [info ] [MainThread]: 
[0m16:34:51.748310 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:34:51.748792 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:34:51.749715 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:34:51.750056 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:34:51.753349 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:34:51.754118 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:34:51.750330 => 2023-05-03 16:34:51.754039
[0m16:34:51.754491 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:34:51.787260 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:34:51.788052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:51.788759 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with order_categories as (
    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items`
left join products on id = order_categories.product_id
)

select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders` as weekly_revenue
    group by 1,2  

left join weekly_revenue on order_id = order_categories.order_id
order by week_of;


[0m16:34:52.117443 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword LEFT at [21:1]')
[0m16:34:53.016276 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c60279b8-fd9e-427b-8cec-734a44f1ab4c&page=queryresults
[0m16:34:53.017302 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:34:51.754741 => 2023-05-03 16:34:53.017178
[0m16:34:53.020070 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected end of input but got keyword LEFT at [21:1]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:34:53.020494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce0c7738-44fc-4b64-b7e9-7dd88f96c288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe6dcfbb0>]}
[0m16:34:53.020999 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.27s]
[0m16:34:53.022752 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:34:53.024454 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:34:53.025015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:53.025255 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:34:53.025515 [info ] [MainThread]: 
[0m16:34:53.025919 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m16:34:53.026519 [debug] [MainThread]: Command end result
[0m16:34:53.033122 [info ] [MainThread]: 
[0m16:34:53.033608 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:34:53.034009 [info ] [MainThread]: 
[0m16:34:53.034766 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:34:53.035165 [error] [MainThread]:   Syntax error: Expected end of input but got keyword LEFT at [21:1]
[0m16:34:53.035888 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:34:53.036276 [info ] [MainThread]: 
[0m16:34:53.036989 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:34:53.037508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe6deda50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe6def820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fe9f14790>]}
[0m16:34:53.038114 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:35:25.401067 | e36ab153-5e39-4ab2-8a43-787387f905f7 ==============================
[0m16:35:25.401067 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:35:25.405347 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:35:25.405835 [debug] [MainThread]: Tracking: tracking
[0m16:35:25.407609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1323821d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13207e05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13207e0f10>]}
[0m16:35:25.424829 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:35:25.462511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:25.463076 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m16:35:25.475422 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m16:35:25.548046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e36ab153-5e39-4ab2-8a43-787387f905f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13204f96f0>]}
[0m16:35:25.561264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e36ab153-5e39-4ab2-8a43-787387f905f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f132058f9a0>]}
[0m16:35:25.561889 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:35:25.562425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e36ab153-5e39-4ab2-8a43-787387f905f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1323821d80>]}
[0m16:35:25.564206 [info ] [MainThread]: 
[0m16:35:25.566986 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:35:25.568591 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:35:25.569121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:26.685813 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:35:26.686381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:26.992727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e36ab153-5e39-4ab2-8a43-787387f905f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f132058eec0>]}
[0m16:35:26.993558 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:35:26.994169 [info ] [MainThread]: 
[0m16:35:26.998703 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:35:26.999139 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:35:26.999934 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:35:27.000252 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:35:27.003543 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:35:27.004041 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:35:27.000441 => 2023-05-03 16:35:27.003958
[0m16:35:27.004390 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:35:27.037002 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:35:27.037565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:27.038262 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with order_categories as (
    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items`
left join products on id = order_categories.product_id
)

 with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1,2  
)

select *

left join weekly_revenue on order_id = order_categories.order_id
order by week_of;


[0m16:35:27.338882 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [14:2]')
[0m16:35:27.973385 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:179e059a-6f83-4d38-810d-00675a56ff7c&page=queryresults
[0m16:35:27.974546 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:35:27.004568 => 2023-05-03 16:35:27.974424
[0m16:35:27.977186 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [14:2]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:35:27.977600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e36ab153-5e39-4ab2-8a43-787387f905f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13205c4cd0>]}
[0m16:35:27.978087 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.98s]
[0m16:35:27.980074 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:35:27.981806 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:35:27.982366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:27.982580 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:35:27.982843 [info ] [MainThread]: 
[0m16:35:27.983234 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m16:35:27.983714 [debug] [MainThread]: Command end result
[0m16:35:27.990337 [info ] [MainThread]: 
[0m16:35:27.990810 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:35:27.991216 [info ] [MainThread]: 
[0m16:35:27.991913 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:35:27.992302 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [14:2]
[0m16:35:27.993033 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:35:27.993438 [info ] [MainThread]: 
[0m16:35:27.994217 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:35:27.994703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13207e0100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13207e13c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13205deb30>]}
[0m16:35:27.995023 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:35:48.362226 | 4203247b-4ff0-4a14-b525-4cb13b204db2 ==============================
[0m16:35:48.362226 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:35:48.364801 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:35:48.365122 [debug] [MainThread]: Tracking: tracking
[0m16:35:48.366964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940fb8c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940fb8cf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940fb8d7e0>]}
[0m16:35:48.381752 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:35:48.417423 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:35:48.418057 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m16:35:48.433813 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m16:35:48.495892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4203247b-4ff0-4a14-b525-4cb13b204db2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940fa45300>]}
[0m16:35:48.503213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4203247b-4ff0-4a14-b525-4cb13b204db2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940f933580>]}
[0m16:35:48.503622 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:35:48.504004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4203247b-4ff0-4a14-b525-4cb13b204db2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940f9335b0>]}
[0m16:35:48.505319 [info ] [MainThread]: 
[0m16:35:48.507385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:35:48.508653 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:35:48.509049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:35:49.509002 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:35:49.509618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:35:49.784129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4203247b-4ff0-4a14-b525-4cb13b204db2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940f932890>]}
[0m16:35:49.784909 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:35:49.785342 [info ] [MainThread]: 
[0m16:35:49.789630 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:35:49.790031 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:35:49.790712 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:35:49.790969 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:35:49.793966 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:35:49.794472 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:35:49.791137 => 2023-05-03 16:35:49.794384
[0m16:35:49.794912 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:35:49.828712 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:35:49.829645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:35:49.830350 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with order_categories as (
    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items`
left join products on id = order_categories.product_id
)

 with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1,2  
)

select * from weekly_revenue

left join weekly_revenue on order_id = order_categories.order_id
order by week_of;


[0m16:35:50.133754 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [14:2]')
[0m16:35:51.237812 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:14ca0b69-6dc0-44bd-a5b3-94d259580266&page=queryresults
[0m16:35:51.238892 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:35:49.795166 => 2023-05-03 16:35:51.238800
[0m16:35:51.241707 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [14:2]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:35:51.242174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4203247b-4ff0-4a14-b525-4cb13b204db2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940f96c820>]}
[0m16:35:51.242710 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.45s]
[0m16:35:51.244510 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:35:51.246369 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:35:51.246923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:35:51.247139 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:35:51.247432 [info ] [MainThread]: 
[0m16:35:51.247816 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m16:35:51.248293 [debug] [MainThread]: Command end result
[0m16:35:51.254925 [info ] [MainThread]: 
[0m16:35:51.255394 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:35:51.255802 [info ] [MainThread]: 
[0m16:35:51.256211 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:35:51.256706 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [14:2]
[0m16:35:51.257166 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:35:51.257607 [info ] [MainThread]: 
[0m16:35:51.257992 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:35:51.258474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940fb8f670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940fb8c3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f940f9892a0>]}
[0m16:35:51.258937 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:49:48.404658 | 7cf62d80-7328-4775-8e2a-7ba04e9f0c83 ==============================
[0m16:49:48.404658 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:49:48.407162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:49:48.407490 [debug] [MainThread]: Tracking: tracking
[0m16:49:48.409225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b0fd8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0adee44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0adee4970>]}
[0m16:49:48.423310 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:49:48.458861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:49:48.459400 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m16:49:48.475463 [debug] [MainThread]: 1603: static parser failed on staging/weekly_revenue.sql
[0m16:49:48.497185 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging/weekly_revenue.sql
[0m16:49:48.552743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cf62d80-7328-4775-8e2a-7ba04e9f0c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0adbfd750>]}
[0m16:49:48.564481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cf62d80-7328-4775-8e2a-7ba04e9f0c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0adc93ac0>]}
[0m16:49:48.565106 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:49:48.565678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cf62d80-7328-4775-8e2a-7ba04e9f0c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0b0e5fa00>]}
[0m16:49:48.568435 [info ] [MainThread]: 
[0m16:49:48.571960 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:49:48.574235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:49:48.574856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:49.648360 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:49:49.648940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:50.083409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cf62d80-7328-4775-8e2a-7ba04e9f0c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0adc92d10>]}
[0m16:49:50.084224 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:49:50.084635 [info ] [MainThread]: 
[0m16:49:50.089603 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:49:50.090080 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:49:50.090985 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:49:50.091331 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:49:50.096981 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:49:50.097761 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:49:50.091695 => 2023-05-03 16:49:50.097685
[0m16:49:50.098107 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:49:50.128934 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:49:50.129756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:50.130418 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with order_categories as (
    select
        order_id
        , product_id
        , category as product_category
    from (<BigQueryRelation `analytics-engineers-club`.`coffee_shop`.`order_items`>, ('coffee_shop', 'products'))
where order_items.product_id = products.id
)

select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
        , order_categories.product_category
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1,2;


[0m16:49:50.450770 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "<" at [11:11]')
[0m16:49:51.412876 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6cf5dc41-3f39-4c39-b8a4-707fd99b8f82&page=queryresults
[0m16:49:51.413933 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:49:50.098360 => 2023-05-03 16:49:51.413847
[0m16:49:51.416711 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Unexpected "<" at [11:11]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:49:51.417217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cf62d80-7328-4775-8e2a-7ba04e9f0c83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0adcca6b0>]}
[0m16:49:51.417767 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.33s]
[0m16:49:51.419574 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:49:51.421458 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:49:51.422015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:51.422240 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:49:51.422497 [info ] [MainThread]: 
[0m16:49:51.422892 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m16:49:51.423456 [debug] [MainThread]: Command end result
[0m16:49:51.430803 [info ] [MainThread]: 
[0m16:49:51.431314 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:49:51.431765 [info ] [MainThread]: 
[0m16:49:51.432224 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:49:51.432827 [error] [MainThread]:   Syntax error: Unexpected "<" at [11:11]
[0m16:49:51.433317 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:49:51.433909 [info ] [MainThread]: 
[0m16:49:51.434427 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:49:51.435048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0adc92f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0adc930a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0adc93eb0>]}
[0m16:49:51.435410 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:53:18.160513 | 92885941-515c-4fbf-95ca-13a88656fe2f ==============================
[0m16:53:18.160513 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:53:18.163244 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:53:18.163739 [debug] [MainThread]: Tracking: tracking
[0m16:53:18.165556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c796fd7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c7658c490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c7658c940>]}
[0m16:53:18.179733 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:53:18.217992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:18.218517 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m16:53:18.230940 [debug] [MainThread]: 1603: static parser failed on staging/weekly_revenue.sql
[0m16:53:18.234542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c764413f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c7638d840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c7638e530>]}
[0m16:53:18.234893 [debug] [MainThread]: Flushing usage events
[0m16:53:18.753607 [error] [MainThread]: Encountered an error:
Compilation Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  source() takes exactly two arguments (3 given)


============================== 2023-05-03 16:53:58.459477 | dfa7b2b1-d8c8-4719-bf0d-c64928a5cc02 ==============================
[0m16:53:58.459477 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:53:58.462186 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:53:58.462672 [debug] [MainThread]: Tracking: tracking
[0m16:53:58.466025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25285e09a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25285e3970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25285e13c0>]}
[0m16:53:58.480215 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:53:58.514828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:58.515345 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m16:53:58.528714 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m16:53:58.591507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfa7b2b1-d8c8-4719-bf0d-c64928a5cc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25282f8f70>]}
[0m16:53:58.598879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfa7b2b1-d8c8-4719-bf0d-c64928a5cc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25283931f0>]}
[0m16:53:58.599314 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:53:58.599771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfa7b2b1-d8c8-4719-bf0d-c64928a5cc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2528393220>]}
[0m16:53:58.601070 [info ] [MainThread]: 
[0m16:53:58.603309 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:53:58.604445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:53:58.604858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:59.651001 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:53:59.651650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:59.914252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfa7b2b1-d8c8-4719-bf0d-c64928a5cc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2528393880>]}
[0m16:53:59.915003 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:53:59.915596 [info ] [MainThread]: 
[0m16:53:59.920062 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:53:59.920527 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:53:59.921409 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:53:59.921741 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:53:59.925531 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:53:59.926295 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:53:59.922404 => 2023-05-03 16:53:59.926218
[0m16:53:59.926636 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:53:59.960903 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:53:59.961694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:59.962352 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with order_categories as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items`, `analytics-engineers-club`.`coffee_shop`.`products`
where order_items.product_id = products.id
)

select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
        , order_categories.product_category
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1,2;


[0m16:54:00.877691 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: order_categories at [19:11]')
[0m16:54:02.449610 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0e5be5ef-f77f-4389-9b25-7ce68c40f45f&page=queryresults
[0m16:54:02.450429 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:53:59.926881 => 2023-05-03 16:54:02.450318
[0m16:54:02.453498 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Unrecognized name: order_categories at [19:11]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:54:02.453909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfa7b2b1-d8c8-4719-bf0d-c64928a5cc02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25282b6e90>]}
[0m16:54:02.454389 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.53s]
[0m16:54:02.456694 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:54:02.458363 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:54:02.458944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:02.459163 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m16:54:02.459392 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:54:02.459638 [info ] [MainThread]: 
[0m16:54:02.460033 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m16:54:02.460524 [debug] [MainThread]: Command end result
[0m16:54:02.467397 [info ] [MainThread]: 
[0m16:54:02.467884 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:54:02.468288 [info ] [MainThread]: 
[0m16:54:02.468769 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:54:02.469277 [error] [MainThread]:   Unrecognized name: order_categories at [19:11]
[0m16:54:02.469671 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:54:02.470061 [info ] [MainThread]: 
[0m16:54:02.470506 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:54:02.471058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2528391ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2528393ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2528392680>]}
[0m16:54:02.471375 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:58:25.998809 | 81a967cf-1c8c-46ef-bfc4-8aeca69b8781 ==============================
[0m16:58:25.998809 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:58:26.001249 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:58:26.001568 [debug] [MainThread]: Tracking: tracking
[0m16:58:26.003227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d8241bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f2f4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f2f4e50>]}
[0m16:58:26.017372 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:58:26.052781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:26.053138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:26.058778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81a967cf-1c8c-46ef-bfc4-8aeca69b8781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f2e0a30>]}
[0m16:58:26.066237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81a967cf-1c8c-46ef-bfc4-8aeca69b8781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f208f10>]}
[0m16:58:26.066644 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:58:26.067112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81a967cf-1c8c-46ef-bfc4-8aeca69b8781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f208f70>]}
[0m16:58:26.068431 [info ] [MainThread]: 
[0m16:58:26.070385 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:58:26.071714 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:58:26.072093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:27.318852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:58:27.319429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:27.604070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81a967cf-1c8c-46ef-bfc4-8aeca69b8781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f2f53f0>]}
[0m16:58:27.604858 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:58:27.605297 [info ] [MainThread]: 
[0m16:58:27.609579 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:58:27.609964 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:58:27.610887 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:58:27.611160 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:58:27.620395 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:58:27.621175 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:58:27.611322 => 2023-05-03 16:58:27.621097
[0m16:58:27.621527 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:58:27.687622 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:58:27.688490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:27.689195 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with order_categories as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items`, `analytics-engineers-club`.`coffee_shop`.`products`
where order_items.product_id = products.id
)

select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
        , order_categories.product_category
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1,2;


[0m16:58:28.616235 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: order_categories at [19:11]')
[0m16:58:29.439505 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:221783fb-ee17-40a9-8bca-dd919ede15a8&page=queryresults
[0m16:58:29.440353 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:58:27.621775 => 2023-05-03 16:58:29.440255
[0m16:58:29.443104 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Unrecognized name: order_categories at [19:11]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:58:29.443567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81a967cf-1c8c-46ef-bfc4-8aeca69b8781', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f2c97b0>]}
[0m16:58:29.444097 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.83s]
[0m16:58:29.445994 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:58:29.447772 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:58:29.448325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:29.448542 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:58:29.448787 [info ] [MainThread]: 
[0m16:58:29.449183 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m16:58:29.449653 [debug] [MainThread]: Command end result
[0m16:58:29.456098 [info ] [MainThread]: 
[0m16:58:29.456655 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:58:29.457130 [info ] [MainThread]: 
[0m16:58:29.457758 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:58:29.458307 [error] [MainThread]:   Unrecognized name: order_categories at [19:11]
[0m16:58:29.458905 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:58:29.459393 [info ] [MainThread]: 
[0m16:58:29.460018 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:58:29.460592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f208d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f30ebc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2d7f30d300>]}
[0m16:58:29.461057 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 16:59:11.816330 | da6fcdbd-5b2c-4736-98ed-031ca3d9766e ==============================
[0m16:59:11.816330 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:59:11.819282 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:59:11.819606 [debug] [MainThread]: Tracking: tracking
[0m16:59:11.821432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada65df9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada65dd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada65dc0d0>]}
[0m16:59:11.835872 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:59:11.871086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:59:11.871561 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m16:59:11.883840 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m16:59:11.940409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da6fcdbd-5b2c-4736-98ed-031ca3d9766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada645d1e0>]}
[0m16:59:11.948206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da6fcdbd-5b2c-4736-98ed-031ca3d9766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada638b460>]}
[0m16:59:11.948725 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m16:59:11.949182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da6fcdbd-5b2c-4736-98ed-031ca3d9766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada638b490>]}
[0m16:59:11.950438 [info ] [MainThread]: 
[0m16:59:11.952408 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:59:11.953620 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:59:11.954066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:13.007654 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m16:59:13.008126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:13.306958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da6fcdbd-5b2c-4736-98ed-031ca3d9766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada638b7c0>]}
[0m16:59:13.307733 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:59:13.308143 [info ] [MainThread]: 
[0m16:59:13.312693 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:59:13.313105 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m16:59:13.313819 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m16:59:13.314081 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m16:59:13.317444 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:59:13.318205 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 16:59:13.314264 => 2023-05-03 16:59:13.318122
[0m16:59:13.318875 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m16:59:13.355175 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m16:59:13.356099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:13.356755 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with order_categories as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items`, `analytics-engineers-club`.`coffee_shop`.`products` as order_categories
where order_items.product_id = products.id
)

select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
        , order_categories.product_category
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1,2;


[0m16:59:14.324473 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: products; Did you mean product_id? at [12:32]')
[0m16:59:15.806390 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:517ee530-9f99-43a9-8e2f-5cef79dfe760&page=queryresults
[0m16:59:15.807156 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 16:59:13.319187 => 2023-05-03 16:59:15.807050
[0m16:59:15.810508 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Unrecognized name: products; Did you mean product_id? at [12:32]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:59:15.810918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da6fcdbd-5b2c-4736-98ed-031ca3d9766e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada63c6410>]}
[0m16:59:15.811396 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.50s]
[0m16:59:15.813732 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m16:59:15.815428 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:59:15.815950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:15.816159 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m16:59:15.816375 [info ] [MainThread]: 
[0m16:59:15.816738 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m16:59:15.817183 [debug] [MainThread]: Command end result
[0m16:59:15.823755 [info ] [MainThread]: 
[0m16:59:15.824258 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:59:15.824694 [info ] [MainThread]: 
[0m16:59:15.825169 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m16:59:15.825743 [error] [MainThread]:   Unrecognized name: products; Did you mean product_id? at [12:32]
[0m16:59:15.826237 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m16:59:15.826771 [info ] [MainThread]: 
[0m16:59:15.827323 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:59:15.827876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada63dec80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada638b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fada638b730>]}
[0m16:59:15.828236 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 17:05:23.072869 | 986a4813-7a49-467b-a4b9-c4763ae973ba ==============================
[0m17:05:23.072869 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:05:23.076464 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:05:23.077197 [debug] [MainThread]: Tracking: tracking
[0m17:05:23.079186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96dc9eb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d99dc670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d99dc940>]}
[0m17:05:23.093994 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:05:23.130959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:23.131803 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m17:05:23.155260 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m17:05:23.248399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '986a4813-7a49-467b-a4b9-c4763ae973ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d985d810>]}
[0m17:05:23.260852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '986a4813-7a49-467b-a4b9-c4763ae973ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d978ba90>]}
[0m17:05:23.261481 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m17:05:23.262110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '986a4813-7a49-467b-a4b9-c4763ae973ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d978bac0>]}
[0m17:05:23.263535 [info ] [MainThread]: 
[0m17:05:23.265671 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:05:23.266838 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m17:05:23.267218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:24.321277 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m17:05:24.321855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:24.624258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '986a4813-7a49-467b-a4b9-c4763ae973ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d978af80>]}
[0m17:05:24.625061 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:05:24.625497 [info ] [MainThread]: 
[0m17:05:24.630305 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m17:05:24.630812 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m17:05:24.631721 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m17:05:24.632061 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m17:05:24.635817 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m17:05:24.636625 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 17:05:24.632400 => 2023-05-03 17:05:24.636544
[0m17:05:24.636973 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m17:05:24.670412 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m17:05:24.671270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:24.671974 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as with order_categories as (
    select
       order_items.order_id
        , order_items.product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items`, `analytics-engineers-club`.`coffee_shop`.`products` as order_categories
where order_items.product_id = products.id
)

select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
        , order_categories.product_category
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1,2;


[0m17:05:25.566627 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: products; Did you mean product_id? at [12:32]')
[0m17:05:26.555669 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:09881c0e-8b81-46e6-87a3-215c17def994&page=queryresults
[0m17:05:26.556468 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 17:05:24.637245 => 2023-05-03 17:05:26.556354
[0m17:05:26.559375 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Unrecognized name: products; Did you mean product_id? at [12:32]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m17:05:26.559791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '986a4813-7a49-467b-a4b9-c4763ae973ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d97c71c0>]}
[0m17:05:26.560277 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.93s]
[0m17:05:26.562439 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m17:05:26.565298 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:05:26.566072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:26.566502 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m17:05:26.566964 [info ] [MainThread]: 
[0m17:05:26.567764 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m17:05:26.568681 [debug] [MainThread]: Command end result
[0m17:05:26.576510 [info ] [MainThread]: 
[0m17:05:26.577179 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:05:26.577972 [info ] [MainThread]: 
[0m17:05:26.579176 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m17:05:26.580322 [error] [MainThread]:   Unrecognized name: products; Did you mean product_id? at [12:32]
[0m17:05:26.581450 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m17:05:26.582796 [info ] [MainThread]: 
[0m17:05:26.583704 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:05:26.584612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96dc9eb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d97de500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d97df070>]}
[0m17:05:26.585208 [debug] [MainThread]: Flushing usage events


============================== 2023-05-03 17:28:06.521195 | b91a1a55-61fa-48db-9a73-5593f76722f0 ==============================
[0m17:28:06.521195 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:28:06.523781 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:28:06.524135 [debug] [MainThread]: Tracking: tracking
[0m17:28:06.525879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d611b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2ff0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2ff0610>]}
[0m17:28:06.540081 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:28:06.580692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:28:06.581275 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m17:28:06.593678 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m17:28:06.654726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b91a1a55-61fa-48db-9a73-5593f76722f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2f05900>]}
[0m17:28:06.661945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b91a1a55-61fa-48db-9a73-5593f76722f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2f9bb80>]}
[0m17:28:06.662338 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m17:28:06.662716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91a1a55-61fa-48db-9a73-5593f76722f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2f9bbb0>]}
[0m17:28:06.663988 [info ] [MainThread]: 
[0m17:28:06.666058 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:28:06.667135 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m17:28:06.667619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:08.284174 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m17:28:08.284757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:08.557341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b91a1a55-61fa-48db-9a73-5593f76722f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2f9ad70>]}
[0m17:28:08.558125 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m17:28:08.558545 [info ] [MainThread]: 
[0m17:28:08.562833 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m17:28:08.563273 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m17:28:08.564178 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m17:28:08.564438 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m17:28:08.567808 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m17:28:08.568568 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-03 17:28:08.564601 => 2023-05-03 17:28:08.568483
[0m17:28:08.568914 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m17:28:08.601910 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m17:28:08.602784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:08.603478 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`    
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id;


[0m17:28:09.463810 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [10:9]')
[0m17:28:10.701496 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:be2ff03b-1a91-461c-8420-a14c6e5c8147&page=queryresults
[0m17:28:10.702412 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-03 17:28:08.569220 => 2023-05-03 17:28:10.702303
[0m17:28:10.705256 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m17:28:10.705722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b91a1a55-61fa-48db-9a73-5593f76722f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2fd6740>]}
[0m17:28:10.706269 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.14s]
[0m17:28:10.708486 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m17:28:10.710235 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:28:10.710761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:10.710971 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m17:28:10.711179 [info ] [MainThread]: 
[0m17:28:10.711534 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.05 seconds (4.05s).
[0m17:28:10.711995 [debug] [MainThread]: Command end result
[0m17:28:10.718336 [info ] [MainThread]: 
[0m17:28:10.718818 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:28:10.719238 [info ] [MainThread]: 
[0m17:28:10.719892 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m17:28:10.720588 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
[0m17:28:10.721243 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m17:28:10.721870 [info ] [MainThread]: 
[0m17:28:10.722267 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:28:10.722827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d611b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2df7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3d2df5810>]}
[0m17:28:10.723258 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 07:59:27.708775 | a4eb2c7e-1fd5-4c14-a782-6fb9208e9364 ==============================
[0m07:59:27.708775 [info ] [MainThread]: Running with dbt=1.4.5
[0m07:59:27.721669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:59:27.723016 [debug] [MainThread]: Tracking: tracking
[0m07:59:27.730129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d7dd0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d7dc550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d7dd060>]}
[0m07:59:27.748516 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m07:59:27.920647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:59:27.920972 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:59:27.927246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4eb2c7e-1fd5-4c14-a782-6fb9208e9364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d5d7f70>]}
[0m07:59:27.935418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4eb2c7e-1fd5-4c14-a782-6fb9208e9364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d65cd60>]}
[0m07:59:27.935791 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m07:59:27.936180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4eb2c7e-1fd5-4c14-a782-6fb9208e9364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d65cdc0>]}
[0m07:59:27.937796 [info ] [MainThread]: 
[0m07:59:27.939885 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:59:27.941092 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m07:59:27.941532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:32.829365 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m07:59:32.829962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:33.101960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4eb2c7e-1fd5-4c14-a782-6fb9208e9364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d7dc5e0>]}
[0m07:59:33.102879 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m07:59:33.103451 [info ] [MainThread]: 
[0m07:59:33.126074 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m07:59:33.126495 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m07:59:33.127729 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m07:59:33.128047 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m07:59:33.133857 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m07:59:33.134660 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 07:59:33.128228 => 2023-05-04 07:59:33.134569
[0m07:59:33.135023 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m07:59:33.203395 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m07:59:33.204419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:59:33.205163 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`    
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id;


[0m07:59:34.093807 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('SELECT list expression references column id which is neither grouped nor aggregated at [10:9]')
[0m07:59:35.310513 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0c195b2f-ce17-4ee8-a4c5-62c0f8fbf391&page=queryresults
[0m07:59:35.311292 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 07:59:33.135271 => 2023-05-04 07:59:35.311179
[0m07:59:35.345419 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m07:59:35.345965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4eb2c7e-1fd5-4c14-a782-6fb9208e9364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d5ba590>]}
[0m07:59:35.346530 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.22s]
[0m07:59:35.348788 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m07:59:35.350641 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:59:35.351215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:59:35.351431 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m07:59:35.351686 [info ] [MainThread]: 
[0m07:59:35.352280 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.41 seconds (7.41s).
[0m07:59:35.352980 [debug] [MainThread]: Command end result
[0m07:59:35.360554 [info ] [MainThread]: 
[0m07:59:35.361091 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:59:35.361811 [info ] [MainThread]: 
[0m07:59:35.362209 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m07:59:35.362954 [error] [MainThread]:   SELECT list expression references column id which is neither grouped nor aggregated at [10:9]
[0m07:59:35.363439 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m07:59:35.363923 [info ] [MainThread]: 
[0m07:59:35.364434 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:59:35.365008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d65cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d58ab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f378d5f9330>]}
[0m07:59:35.365375 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 07:59:59.343615 | b828e55e-b1fe-4428-a25f-eec4d02dcca8 ==============================
[0m07:59:59.343615 [info ] [MainThread]: Running with dbt=1.4.5
[0m07:59:59.346174 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:59:59.346527 [debug] [MainThread]: Tracking: tracking
[0m07:59:59.349651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbe81f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbb894580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbb894610>]}
[0m07:59:59.363808 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m07:59:59.402741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:59:59.403423 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m07:59:59.419541 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m07:59:59.478207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b828e55e-b1fe-4428-a25f-eec4d02dcca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbb711900>]}
[0m07:59:59.486134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b828e55e-b1fe-4428-a25f-eec4d02dcca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbb63bb80>]}
[0m07:59:59.486590 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m07:59:59.487417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b828e55e-b1fe-4428-a25f-eec4d02dcca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbb63bbb0>]}
[0m07:59:59.489094 [info ] [MainThread]: 
[0m07:59:59.491441 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m07:59:59.492658 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m07:59:59.493058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:01.310139 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:00:01.310624 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:01.614228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b828e55e-b1fe-4428-a25f-eec4d02dcca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbb63af20>]}
[0m08:00:01.615119 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:00:01.615615 [info ] [MainThread]: 
[0m08:00:01.619793 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:00:01.620220 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:00:01.621297 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:00:01.621644 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:00:01.625422 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:00:01.626124 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:00:01.621967 => 2023-05-04 08:00:01.626027
[0m08:00:01.626431 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:00:01.659107 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:00:01.659925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:01.660630 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on order_id = order_items.order_id;


[0m08:00:02.564186 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name order_id is ambiguous at [23:29]')
[0m08:00:04.016244 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9c2d6577-f7c5-4e74-ad81-7052ec540100&page=queryresults
[0m08:00:04.017045 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:00:01.626681 => 2023-05-04 08:00:04.016936
[0m08:00:04.020030 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Column name order_id is ambiguous at [23:29]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:00:04.020460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b828e55e-b1fe-4428-a25f-eec4d02dcca8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbb676770>]}
[0m08:00:04.020997 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.40s]
[0m08:00:04.023385 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:00:04.025234 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:00:04.025801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:04.026033 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:00:04.026295 [info ] [MainThread]: 
[0m08:00:04.026687 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m08:00:04.027162 [debug] [MainThread]: Command end result
[0m08:00:04.045155 [info ] [MainThread]: 
[0m08:00:04.048997 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:00:04.051745 [info ] [MainThread]: 
[0m08:00:04.053049 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:00:04.054724 [error] [MainThread]:   Column name order_id is ambiguous at [23:29]
[0m08:00:04.057140 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:00:04.059428 [info ] [MainThread]: 
[0m08:00:04.062761 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:00:04.066823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbe81f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbb68f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedbb68e5f0>]}
[0m08:00:04.067941 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:00:25.412624 | 2f48c8cb-213f-4be1-b613-3178a8b886f3 ==============================
[0m08:00:25.412624 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:00:25.415202 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:00:25.415545 [debug] [MainThread]: Tracking: tracking
[0m08:00:25.421128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68bf1ed090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68bf1ec520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68bf1ed030>]}
[0m08:00:25.436002 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:00:25.471878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:00:25.472506 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m08:00:25.485284 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m08:00:25.565311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f48c8cb-213f-4be1-b613-3178a8b886f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68bf1015a0>]}
[0m08:00:25.573803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f48c8cb-213f-4be1-b613-3178a8b886f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68bf1977f0>]}
[0m08:00:25.574470 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:00:25.575098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f48c8cb-213f-4be1-b613-3178a8b886f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68c2315d20>]}
[0m08:00:25.577049 [info ] [MainThread]: 
[0m08:00:25.579837 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:00:25.581673 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:00:25.582244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:26.771103 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:00:26.771771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:27.031945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f48c8cb-213f-4be1-b613-3178a8b886f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68bf197880>]}
[0m08:00:27.032779 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:00:27.033198 [info ] [MainThread]: 
[0m08:00:27.037341 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:00:27.037810 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:00:27.038766 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:00:27.039123 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:00:27.042632 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:00:27.043404 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:00:27.039472 => 2023-05-04 08:00:27.043318
[0m08:00:27.043785 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:00:27.076504 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:00:27.077600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:00:27.078621 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id as order_id
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on weekly_revenue.order_id = order_items.order_id;


[0m08:00:27.904348 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Column name order_id is ambiguous at [18:9]')
[0m08:00:29.045387 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1847e524-44b1-45b2-936e-cffd31c13c79&page=queryresults
[0m08:00:29.046298 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:00:27.044055 => 2023-05-04 08:00:29.046181
[0m08:00:29.049369 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Column name order_id is ambiguous at [18:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:00:29.049877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f48c8cb-213f-4be1-b613-3178a8b886f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68bf1d0520>]}
[0m08:00:29.050474 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.01s]
[0m08:00:29.052852 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:00:29.054676 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:00:29.055232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:29.055504 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:00:29.055776 [info ] [MainThread]: 
[0m08:00:29.056183 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m08:00:29.056714 [debug] [MainThread]: Command end result
[0m08:00:29.064304 [info ] [MainThread]: 
[0m08:00:29.064798 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:00:29.065264 [info ] [MainThread]: 
[0m08:00:29.066729 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:00:29.067153 [error] [MainThread]:   Column name order_id is ambiguous at [18:9]
[0m08:00:29.068036 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:00:29.069074 [info ] [MainThread]: 
[0m08:00:29.069475 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:00:29.070358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68beff3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68beff3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68beff2fb0>]}
[0m08:00:29.070705 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:01:17.037700 | 91646541-f552-47db-8bb6-20ea22c9e89b ==============================
[0m08:01:17.037700 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:01:17.040159 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:01:17.040495 [debug] [MainThread]: Tracking: tracking
[0m08:01:17.044564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4bfe7c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48fe0ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48fe0f10>]}
[0m08:01:17.059435 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:01:17.102564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:01:17.103126 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m08:01:17.115472 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m08:01:17.178366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91646541-f552-47db-8bb6-20ea22c9e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48cf96c0>]}
[0m08:01:17.186464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91646541-f552-47db-8bb6-20ea22c9e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48d8f9a0>]}
[0m08:01:17.186918 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:01:17.187705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91646541-f552-47db-8bb6-20ea22c9e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48d8f9d0>]}
[0m08:01:17.189424 [info ] [MainThread]: 
[0m08:01:17.192171 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:01:17.193727 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:01:17.194351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:18.337849 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:01:18.338418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:01:18.619705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91646541-f552-47db-8bb6-20ea22c9e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48d8fa60>]}
[0m08:01:18.620503 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:01:18.620947 [info ] [MainThread]: 
[0m08:01:18.625356 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:01:18.625791 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:01:18.626605 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:01:18.626896 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:01:18.630307 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:01:18.630976 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:01:18.627083 => 2023-05-04 08:01:18.630891
[0m08:01:18.631275 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:01:18.664025 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:01:18.664778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:01:18.665420 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
        , products.category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:01:19.568959 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: products; Did you mean product_id? at [20:11]')
[0m08:01:20.884195 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:381176ef-b04e-4ab1-8650-fdc966169b75&page=queryresults
[0m08:01:20.885359 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:01:18.631460 => 2023-05-04 08:01:20.885254
[0m08:01:20.888380 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Unrecognized name: products; Did you mean product_id? at [20:11]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:01:20.888824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91646541-f552-47db-8bb6-20ea22c9e89b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48dcb310>]}
[0m08:01:20.889325 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.26s]
[0m08:01:20.891633 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:01:20.894927 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:01:20.895825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:20.896160 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:01:20.896509 [info ] [MainThread]: 
[0m08:01:20.897050 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m08:01:20.897635 [debug] [MainThread]: Command end result
[0m08:01:20.907106 [info ] [MainThread]: 
[0m08:01:20.907617 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:01:20.908070 [info ] [MainThread]: 
[0m08:01:20.909310 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:01:20.909870 [error] [MainThread]:   Unrecognized name: products; Did you mean product_id? at [20:11]
[0m08:01:20.910434 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:01:20.911146 [info ] [MainThread]: 
[0m08:01:20.911645 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:01:20.912172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a4bfe7c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48de2e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a48de1ba0>]}
[0m08:01:20.912514 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:02:33.578980 | 291d75b0-1c1d-44ca-9f02-5c08559ef43b ==============================
[0m08:02:33.578980 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:02:33.581981 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:02:33.582334 [debug] [MainThread]: Tracking: tracking
[0m08:02:33.589249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e62f5180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e62f4640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e62f5150>]}
[0m08:02:33.606098 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:02:33.643347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:02:33.643824 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m08:02:33.655958 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m08:02:33.713992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '291d75b0-1c1d-44ca-9f02-5c08559ef43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e62094b0>]}
[0m08:02:33.721894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '291d75b0-1c1d-44ca-9f02-5c08559ef43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e629f7c0>]}
[0m08:02:33.722326 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:02:33.722708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '291d75b0-1c1d-44ca-9f02-5c08559ef43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e9418fa0>]}
[0m08:02:33.723983 [info ] [MainThread]: 
[0m08:02:33.726495 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:02:33.727621 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:02:33.728051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:02:35.379708 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:02:35.380284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:02:35.638541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '291d75b0-1c1d-44ca-9f02-5c08559ef43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e629eb00>]}
[0m08:02:35.639350 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:02:35.639764 [info ] [MainThread]: 
[0m08:02:35.643844 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:02:35.644259 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:02:35.645111 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:02:35.645452 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:02:35.648846 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:02:35.649615 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:02:35.645695 => 2023-05-04 08:02:35.649531
[0m08:02:35.649980 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:02:35.682381 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:02:35.683172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:02:35.683850 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:02:36.024401 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "order_items" must be qualified with a dataset (e.g. dataset.table).')
[0m08:02:36.680493 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e0b39bc4-e87a-460a-9e9e-86fcec074d53&page=queryresults
[0m08:02:36.681314 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:02:35.650235 => 2023-05-04 08:02:36.681207
[0m08:02:36.684309 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Table "order_items" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:02:36.684755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '291d75b0-1c1d-44ca-9f02-5c08559ef43b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e62dbbb0>]}
[0m08:02:36.685258 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.04s]
[0m08:02:36.687036 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:02:36.688882 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:02:36.689454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:02:36.689675 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:02:36.689938 [info ] [MainThread]: 
[0m08:02:36.690332 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m08:02:36.691151 [debug] [MainThread]: Command end result
[0m08:02:36.697893 [info ] [MainThread]: 
[0m08:02:36.698739 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:02:36.699486 [info ] [MainThread]: 
[0m08:02:36.700384 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:02:36.701108 [error] [MainThread]:   Table "order_items" must be qualified with a dataset (e.g. dataset.table).
[0m08:02:36.701529 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:02:36.701946 [info ] [MainThread]: 
[0m08:02:36.702371 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:02:36.702919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e629fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e629fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76e629fd90>]}
[0m08:02:36.703562 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:03:00.520897 | 3a39ecbf-e3be-4471-b41d-4105844c8591 ==============================
[0m08:03:00.520897 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:03:00.523411 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:03:00.523809 [debug] [MainThread]: Tracking: tracking
[0m08:03:00.530172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f9fe09a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f9fe3970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f9fe13c0>]}
[0m08:03:00.544962 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:03:00.579232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:03:00.579793 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m08:03:00.592542 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m08:03:00.652711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a39ecbf-e3be-4471-b41d-4105844c8591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f9cf8f70>]}
[0m08:03:00.660299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a39ecbf-e3be-4471-b41d-4105844c8591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f9d8f1f0>]}
[0m08:03:00.660760 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:03:00.661145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a39ecbf-e3be-4471-b41d-4105844c8591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f9d8f220>]}
[0m08:03:00.662409 [info ] [MainThread]: 
[0m08:03:00.664537 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:03:00.665646 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:03:00.666091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:02.537775 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:03:02.538347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:02.867120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a39ecbf-e3be-4471-b41d-4105844c8591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f9d8f880>]}
[0m08:03:02.867940 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:03:02.868710 [info ] [MainThread]: 
[0m08:03:02.872751 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:03:02.873220 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:03:02.874163 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:03:02.874513 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:03:02.877952 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:03:02.878728 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:03:02.874884 => 2023-05-04 08:03:02.878644
[0m08:03:02.879106 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:03:02.911425 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:03:02.912235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:02.912945 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items` as order_items

left join order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:03:03.238995 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "order_items" must be qualified with a dataset (e.g. dataset.table).')
[0m08:03:03.761820 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:773c762e-517b-49f8-b7da-16d6b21092a2&page=queryresults
[0m08:03:03.762619 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:03:02.879353 => 2023-05-04 08:03:03.762506
[0m08:03:03.765703 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Table "order_items" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:03:03.766122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a39ecbf-e3be-4471-b41d-4105844c8591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f9dc4c70>]}
[0m08:03:03.766611 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.89s]
[0m08:03:03.768343 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:03:03.779279 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:03:03.779858 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:03.780084 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:03:03.780309 [info ] [MainThread]: 
[0m08:03:03.780627 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.12 seconds (3.12s).
[0m08:03:03.780986 [debug] [MainThread]: Command end result
[0m08:03:03.791230 [info ] [MainThread]: 
[0m08:03:03.792860 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:03:03.793828 [info ] [MainThread]: 
[0m08:03:03.794649 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:03:03.795581 [error] [MainThread]:   Table "order_items" must be qualified with a dataset (e.g. dataset.table).
[0m08:03:03.796329 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:03:03.797237 [info ] [MainThread]: 
[0m08:03:03.798046 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:03:03.800642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6fde863e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f9fe07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6f9fe1240>]}
[0m08:03:03.801009 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:03:27.102168 | dc362187-0a6f-491b-b055-aede5bc489da ==============================
[0m08:03:27.102168 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:03:27.104674 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:03:27.105145 [debug] [MainThread]: Tracking: tracking
[0m08:03:27.108494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7107695150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71076945e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71076950f0>]}
[0m08:03:27.123054 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:03:27.160947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:03:27.161465 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m08:03:27.173701 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m08:03:27.232071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc362187-0a6f-491b-b055-aede5bc489da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7107511570>]}
[0m08:03:27.239709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc362187-0a6f-491b-b055-aede5bc489da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710743b7f0>]}
[0m08:03:27.240150 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:03:27.240535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc362187-0a6f-491b-b055-aede5bc489da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710743b820>]}
[0m08:03:27.241827 [info ] [MainThread]: 
[0m08:03:27.243940 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:03:27.245027 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:03:27.245541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:03:28.722306 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:03:28.722879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:03:28.979418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc362187-0a6f-491b-b055-aede5bc489da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f710743b850>]}
[0m08:03:28.980213 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:03:28.980761 [info ] [MainThread]: 
[0m08:03:28.985466 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:03:28.985865 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:03:28.986476 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:03:28.986729 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:03:28.989804 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:03:28.990616 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:03:28.986891 => 2023-05-04 08:03:28.990523
[0m08:03:28.991502 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:03:29.028644 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:03:29.030703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:03:29.031622 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:03:29.468785 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:03:29.469733 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset aec-students:coffee_shop was not found in location US

Location: US
Job ID: e49581f7-190b-4a75-9a2a-a593fe8f7dbf

[0m08:03:29.470251 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:03:28.991866 => 2023-05-04 08:03:29.470176
[0m08:03:29.472756 [debug] [Thread-1 (]: Runtime Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  404 Not found: Dataset aec-students:coffee_shop was not found in location US
  
  Location: US
  Job ID: e49581f7-190b-4a75-9a2a-a593fe8f7dbf
  
[0m08:03:29.473218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc362187-0a6f-491b-b055-aede5bc489da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7107475180>]}
[0m08:03:29.473752 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.49s]
[0m08:03:29.476036 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:03:29.477724 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:03:29.478290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:03:29.478502 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:03:29.478768 [info ] [MainThread]: 
[0m08:03:29.479168 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m08:03:29.479901 [debug] [MainThread]: Command end result
[0m08:03:29.486664 [info ] [MainThread]: 
[0m08:03:29.487154 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:03:29.487726 [info ] [MainThread]: 
[0m08:03:29.488396 [error] [MainThread]: [33mRuntime Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:03:29.488847 [error] [MainThread]:   404 Not found: Dataset aec-students:coffee_shop was not found in location US
[0m08:03:29.489276 [error] [MainThread]:   
[0m08:03:29.489695 [error] [MainThread]:   Location: US
[0m08:03:29.490121 [error] [MainThread]:   Job ID: e49581f7-190b-4a75-9a2a-a593fe8f7dbf
[0m08:03:29.490532 [error] [MainThread]:   
[0m08:03:29.491153 [info ] [MainThread]: 
[0m08:03:29.491601 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:03:29.492124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7107696e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7107694310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7107491990>]}
[0m08:03:29.492536 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:12:32.171362 | b60ba115-8b9b-43ef-bd6c-76a0f09ecab4 ==============================
[0m08:12:32.171362 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:12:32.174028 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:12:32.174374 [debug] [MainThread]: Tracking: tracking
[0m08:12:32.187040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb07c18df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb04af4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb04af46a0>]}
[0m08:12:32.213075 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:12:32.270750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:12:32.271169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:12:32.277280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b60ba115-8b9b-43ef-bd6c-76a0f09ecab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb04ae4af0>]}
[0m08:12:32.285095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b60ba115-8b9b-43ef-bd6c-76a0f09ecab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb04a08fd0>]}
[0m08:12:32.285513 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:12:32.286174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b60ba115-8b9b-43ef-bd6c-76a0f09ecab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb04a09030>]}
[0m08:12:32.287751 [info ] [MainThread]: 
[0m08:12:32.290080 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:12:32.291233 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:12:32.291881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:33.365903 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:12:33.366629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:33.636306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b60ba115-8b9b-43ef-bd6c-76a0f09ecab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb04af5cc0>]}
[0m08:12:33.637132 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:12:33.637801 [info ] [MainThread]: 
[0m08:12:33.641916 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:12:33.642467 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:12:33.643377 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:12:33.643723 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:12:33.647996 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:12:33.648808 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:12:33.644135 => 2023-05-04 08:12:33.648722
[0m08:12:33.649197 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:12:33.722816 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:12:33.723719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:12:33.724480 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:12:34.145397 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:12:34.146267 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset aec-students:coffee_shop was not found in location US

Location: US
Job ID: cf5f5c28-8a37-44c9-854e-9aa44e8e046a

[0m08:12:34.146768 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:12:33.649524 => 2023-05-04 08:12:34.146696
[0m08:12:34.149332 [debug] [Thread-1 (]: Runtime Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  404 Not found: Dataset aec-students:coffee_shop was not found in location US
  
  Location: US
  Job ID: cf5f5c28-8a37-44c9-854e-9aa44e8e046a
  
[0m08:12:34.149794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b60ba115-8b9b-43ef-bd6c-76a0f09ecab4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb04ae4130>]}
[0m08:12:34.150326 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.51s]
[0m08:12:34.152931 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:12:34.154584 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:12:34.155147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:34.155363 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m08:12:34.155576 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:12:34.155822 [info ] [MainThread]: 
[0m08:12:34.156159 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m08:12:34.156564 [debug] [MainThread]: Command end result
[0m08:12:34.163788 [info ] [MainThread]: 
[0m08:12:34.164310 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:12:34.164775 [info ] [MainThread]: 
[0m08:12:34.165236 [error] [MainThread]: [33mRuntime Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:12:34.165725 [error] [MainThread]:   404 Not found: Dataset aec-students:coffee_shop was not found in location US
[0m08:12:34.166229 [error] [MainThread]:   
[0m08:12:34.166677 [error] [MainThread]:   Location: US
[0m08:12:34.167096 [error] [MainThread]:   Job ID: cf5f5c28-8a37-44c9-854e-9aa44e8e046a
[0m08:12:34.167499 [error] [MainThread]:   
[0m08:12:34.167960 [info ] [MainThread]: 
[0m08:12:34.168436 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:12:34.168998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb04a9f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb04b0e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb04ae46a0>]}
[0m08:12:34.169604 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:13:09.098026 | 1f302cb1-886f-4491-a9f6-6b2c5d51929c ==============================
[0m08:13:09.098026 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:13:09.100805 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:13:09.101165 [debug] [MainThread]: Tracking: tracking
[0m08:13:09.129897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0c8ff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0c8fd0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0c8fc0d0>]}
[0m08:13:09.151206 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:13:09.183096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:13:09.183448 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:13:09.190009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f302cb1-886f-4491-a9f6-6b2c5d51929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0c8e4460>]}
[0m08:13:09.198730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f302cb1-886f-4491-a9f6-6b2c5d51929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0c80c940>]}
[0m08:13:09.199337 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:13:09.199832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f302cb1-886f-4491-a9f6-6b2c5d51929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0c80c9a0>]}
[0m08:13:09.201582 [info ] [MainThread]: 
[0m08:13:09.203501 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:13:09.204843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:13:09.205327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:10.220729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:13:10.221304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:13:10.498173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f302cb1-886f-4491-a9f6-6b2c5d51929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0c8fd0c0>]}
[0m08:13:10.498981 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:13:10.499386 [info ] [MainThread]: 
[0m08:13:10.503957 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m08:13:10.504245 [debug] [Thread-2 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:13:10.504684 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m08:13:10.505853 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m08:13:10.505120 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:13:10.506517 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m08:13:10.507477 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:13:10.509742 [debug] [Thread-2 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:13:10.513086 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:13:10.556790 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m08:13:10.557523 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:13:10.510234 => 2023-05-04 08:13:10.557419
[0m08:13:10.557988 [debug] [Thread-2 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:13:10.558370 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-05-04 08:13:10.507707 => 2023-05-04 08:13:10.558301
[0m08:13:10.579890 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m08:13:10.593467 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:13:10.599591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:13:10.601358 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:13:10.602437 [debug] [Thread-2 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:13:11.017239 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m08:13:11.018185 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club`.`coffee_shop`.`customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id
    );
  
[0m08:13:11.061064 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:13:11.062219 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset aec-students:coffee_shop was not found in location US

Location: US
Job ID: b13d5950-cc86-4a58-a653-98c51455bb3b

[0m08:13:11.062832 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:13:10.558626 => 2023-05-04 08:13:11.062729
[0m08:13:11.072943 [debug] [Thread-2 (]: Runtime Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  404 Not found: Dataset aec-students:coffee_shop was not found in location US
  
  Location: US
  Job ID: b13d5950-cc86-4a58-a653-98c51455bb3b
  
[0m08:13:11.073537 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f302cb1-886f-4491-a9f6-6b2c5d51929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0c8fc580>]}
[0m08:13:11.074293 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.57s]
[0m08:13:11.077140 [debug] [Thread-2 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:13:16.115393 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:386baaed-f375-4ab5-854c-a18f99ec2fc1&page=queryresults
[0m08:13:16.131528 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-05-04 08:13:10.585351 => 2023-05-04 08:13:16.131471
[0m08:13:16.132308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f302cb1-886f-4491-a9f6-6b2c5d51929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda0c7b3f40>]}
[0m08:13:16.132857 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_kimwkho.customers ........................ [[32mCREATE TABLE (174.4k rows, 21.3 MB processed)[0m in 5.63s]
[0m08:13:16.133435 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m08:13:16.134263 [debug] [Thread-4 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m08:13:16.134767 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m08:13:16.135517 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m08:13:16.135769 [debug] [Thread-4 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m08:13:16.138175 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m08:13:16.138890 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-05-04 08:13:16.135926 => 2023-05-04 08:13:16.138810
[0m08:13:16.139465 [debug] [Thread-4 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m08:13:16.143677 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m08:13:16.144479 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:13:16.144891 [debug] [Thread-4 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students`.`dbt_kimwkho`.`customers`
 
group by 1;


[0m08:13:16.985167 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e1e76a25-19cb-4e49-8fc9-9acce39874a3&page=queryresults
[0m08:13:16.987215 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-05-04 08:13:16.139864 => 2023-05-04 08:13:16.987154
[0m08:13:16.988007 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f302cb1-886f-4491-a9f6-6b2c5d51929c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda086db700>]}
[0m08:13:16.988534 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m08:13:16.989360 [debug] [Thread-4 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m08:13:16.991624 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:13:16.992189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:16.992405 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m08:13:16.992778 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:13:16.993015 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m08:13:16.993336 [info ] [MainThread]: 
[0m08:13:16.994350 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 7.79 seconds (7.79s).
[0m08:13:16.995527 [debug] [MainThread]: Command end result
[0m08:13:17.005816 [info ] [MainThread]: 
[0m08:13:17.006347 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:13:17.006824 [info ] [MainThread]: 
[0m08:13:17.007289 [error] [MainThread]: [33mRuntime Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:13:17.007837 [error] [MainThread]:   404 Not found: Dataset aec-students:coffee_shop was not found in location US
[0m08:13:17.008284 [error] [MainThread]:   
[0m08:13:17.008814 [error] [MainThread]:   Location: US
[0m08:13:17.009246 [error] [MainThread]:   Job ID: b13d5950-cc86-4a58-a653-98c51455bb3b
[0m08:13:17.009739 [error] [MainThread]:   
[0m08:13:17.010177 [info ] [MainThread]: 
[0m08:13:17.010690 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:13:17.011246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda086db8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda086db910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda086db400>]}
[0m08:13:17.011626 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:15:03.701938 | a14a1b4a-46bc-4c23-8f7a-facd47c7feb1 ==============================
[0m08:15:03.701938 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:15:03.704409 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'select': ['source:coffee_shop'], 'which': 'test', 'rpc_method': 'test'}
[0m08:15:03.704761 [debug] [MainThread]: Tracking: tracking
[0m08:15:03.708489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000e2f8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000e2f8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000e2f8f10>]}
[0m08:15:03.722500 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:15:03.764170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:15:03.764500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:15:03.770122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a14a1b4a-46bc-4c23-8f7a-facd47c7feb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000e0f3eb0>]}
[0m08:15:03.779329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a14a1b4a-46bc-4c23-8f7a-facd47c7feb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000e20cdf0>]}
[0m08:15:03.779882 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:15:03.780423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14a1b4a-46bc-4c23-8f7a-facd47c7feb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00114fb250>]}
[0m08:15:03.782283 [info ] [MainThread]: 
[0m08:15:03.784406 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:15:03.785597 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:15:03.785972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:15:04.933774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a14a1b4a-46bc-4c23-8f7a-facd47c7feb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000e2f8f70>]}
[0m08:15:04.934607 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:15:04.935036 [info ] [MainThread]: 
[0m08:15:04.942078 [debug] [Thread-1 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m08:15:04.942532 [debug] [Thread-2 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f
[0m08:15:04.943298 [debug] [Thread-3 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108
[0m08:15:04.943682 [debug] [Thread-4 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2
[0m08:15:04.947558 [info ] [Thread-1 (]: 1 of 11 START test source_not_null_coffee_shop_customers_id .................... [RUN]
[0m08:15:04.946706 [debug] [Thread-6 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966
[0m08:15:04.947013 [debug] [Thread-7 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5
[0m08:15:04.947286 [debug] [Thread-8 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16
[0m08:15:04.956958 [info ] [Thread-6 (]: 6 of 11 START test source_not_null_coffee_shop_products_id ..................... [RUN]
[0m08:15:04.959347 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966'
[0m08:15:04.949217 [info ] [Thread-4 (]: 4 of 11 START test source_not_null_coffee_shop_product_prices_id ............... [RUN]
[0m08:15:04.963021 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2'
[0m08:15:04.963498 [debug] [Thread-4 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2
[0m08:15:04.957381 [info ] [Thread-7 (]: 7 of 11 START test source_unique_coffee_shop_customers_id ...................... [RUN]
[0m08:15:04.957737 [info ] [Thread-8 (]: 8 of 11 START test source_unique_coffee_shop_order_items_id .................... [RUN]
[0m08:15:04.948292 [info ] [Thread-2 (]: 2 of 11 START test source_not_null_coffee_shop_order_items_id .................. [RUN]
[0m08:15:04.948730 [info ] [Thread-3 (]: 3 of 11 START test source_not_null_coffee_shop_orders_id ....................... [RUN]
[0m08:15:05.030047 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108'
[0m08:15:05.030340 [debug] [Thread-3 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108
[0m08:15:04.960189 [debug] [Thread-6 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966
[0m08:15:05.020985 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5'
[0m08:15:05.028134 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2"
[0m08:15:05.028849 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16'
[0m08:15:05.029436 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f'
[0m08:15:04.944089 [debug] [Thread-5 (]: Began running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21
[0m08:15:04.952845 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0'
[0m08:15:05.034559 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108"
[0m08:15:05.043075 [debug] [Thread-3 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108 (compile): 2023-05-04 08:15:05.030522 => 2023-05-04 08:15:05.042980
[0m08:15:05.038875 [debug] [Thread-7 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5
[0m08:15:05.039395 [debug] [Thread-8 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16
[0m08:15:05.039910 [debug] [Thread-2 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f
[0m08:15:05.041125 [debug] [Thread-4 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2 (compile): 2023-05-04 08:15:04.963861 => 2023-05-04 08:15:05.041036
[0m08:15:05.040402 [info ] [Thread-5 (]: 5 of 11 START test source_not_null_coffee_shop_product_prices_product_id ....... [RUN]
[0m08:15:05.058996 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21'
[0m08:15:05.038532 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966"
[0m08:15:05.059693 [debug] [Thread-6 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966 (compile): 2023-05-04 08:15:05.034808 => 2023-05-04 08:15:05.059621
[0m08:15:05.050067 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5"
[0m08:15:05.053942 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16"
[0m08:15:05.058009 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f"
[0m08:15:05.058400 [debug] [Thread-4 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2
[0m08:15:05.059261 [debug] [Thread-5 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21
[0m08:15:05.042518 [debug] [Thread-1 (]: Began compiling node test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m08:15:05.059967 [debug] [Thread-6 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966
[0m08:15:05.043492 [debug] [Thread-3 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108
[0m08:15:05.060707 [debug] [Thread-2 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f (compile): 2023-05-04 08:15:05.054221 => 2023-05-04 08:15:05.060637
[0m08:15:05.095733 [debug] [Thread-2 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f
[0m08:15:05.061096 [debug] [Thread-8 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16 (compile): 2023-05-04 08:15:05.050312 => 2023-05-04 08:15:05.061032
[0m08:15:05.076471 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21"
[0m08:15:05.083537 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2"
[0m08:15:05.099499 [debug] [Thread-5 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21 (compile): 2023-05-04 08:15:05.072100 => 2023-05-04 08:15:05.099407
[0m08:15:05.091705 [debug] [Thread-6 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966"
[0m08:15:05.095335 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108"
[0m08:15:05.061509 [debug] [Thread-7 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5 (compile): 2023-05-04 08:15:05.043837 => 2023-05-04 08:15:05.061448
[0m08:15:05.101722 [debug] [Thread-7 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5
[0m08:15:05.098146 [debug] [Thread-8 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16
[0m08:15:05.088893 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m08:15:05.101350 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:15:05.108677 [debug] [Thread-3 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`orders`
where id is null



      
    ) dbt_internal_test
[0m08:15:05.099982 [debug] [Thread-5 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21
[0m08:15:05.103929 [debug] [Thread-7 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5"
[0m08:15:05.104158 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m08:15:05.113776 [debug] [Thread-6 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`products`
where id is null



      
    ) dbt_internal_test
[0m08:15:05.107846 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:15:05.117794 [debug] [Thread-4 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`product_prices`
where id is null



      
    ) dbt_internal_test
[0m08:15:05.110538 [debug] [Thread-1 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0 (compile): 2023-05-04 08:15:05.083792 => 2023-05-04 08:15:05.110458
[0m08:15:05.120596 [debug] [Thread-1 (]: Began executing node test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m08:15:05.107440 [debug] [Thread-8 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16"
[0m08:15:05.126179 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m08:15:05.126580 [debug] [Thread-8 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`order_items`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:15:05.113256 [debug] [Thread-5 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21"
[0m08:15:05.130470 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m08:15:05.097782 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f"
[0m08:15:05.131497 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:15:05.131875 [debug] [Thread-2 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`order_items`
where id is null



      
    ) dbt_internal_test
[0m08:15:05.116393 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m08:15:05.134431 [debug] [Thread-7 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:15:05.130883 [debug] [Thread-5 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `analytics-engineers-club`.`coffee_shop`.`product_prices`
where product_id is null



      
    ) dbt_internal_test
[0m08:15:05.125389 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m08:15:05.141831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:15:05.142470 [debug] [Thread-1 (]: On test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`customers`
where id is null



      
    ) dbt_internal_test
[0m08:15:06.913246 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b24464d4-05d2-4f59-b993-8aecb88f52a7&page=queryresults
[0m08:15:06.914605 [debug] [Thread-8 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16 (execute): 2023-05-04 08:15:05.104793 => 2023-05-04 08:15:06.914532
[0m08:15:06.915379 [info ] [Thread-8 (]: 8 of 11 PASS source_unique_coffee_shop_order_items_id .......................... [[32mPASS[0m in 1.89s]
[0m08:15:06.917159 [debug] [Thread-8 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_order_items_id.598dd6ec16
[0m08:15:06.917750 [debug] [Thread-8 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7
[0m08:15:06.918372 [info ] [Thread-8 (]: 9 of 11 START test source_unique_coffee_shop_orders_id ......................... [RUN]
[0m08:15:06.919188 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7'
[0m08:15:06.919476 [debug] [Thread-8 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7
[0m08:15:06.924236 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7"
[0m08:15:06.924720 [debug] [Thread-8 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7 (compile): 2023-05-04 08:15:06.919666 => 2023-05-04 08:15:06.924647
[0m08:15:06.925063 [debug] [Thread-8 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7
[0m08:15:06.927104 [debug] [Thread-8 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7"
[0m08:15:06.927561 [debug] [Thread-8 (]: Opening a new connection, currently in state closed
[0m08:15:06.927984 [debug] [Thread-8 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`orders`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:15:06.944884 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5eab651b-5dc4-4628-af0a-35b329000d7f&page=queryresults
[0m08:15:06.945889 [debug] [Thread-4 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2 (execute): 2023-05-04 08:15:05.061792 => 2023-05-04 08:15:06.945815
[0m08:15:06.957790 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fdfb44bc-2463-49b0-8335-4673b5ee845b&page=queryresults
[0m08:15:06.947986 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d956af37-4383-43e7-a775-314c11b08310&page=queryresults
[0m08:15:06.959113 [debug] [Thread-5 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21 (execute): 2023-05-04 08:15:05.111235 => 2023-05-04 08:15:06.959041
[0m08:15:06.953106 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a6040409-89a2-4b2a-94e7-0da9fa77bedb&page=queryresults
[0m08:15:06.962945 [debug] [Thread-2 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f (execute): 2023-05-04 08:15:05.095992 => 2023-05-04 08:15:06.962876
[0m08:15:06.958429 [debug] [Thread-6 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966 (execute): 2023-05-04 08:15:05.089315 => 2023-05-04 08:15:06.958356
[0m08:15:06.962309 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d7b85cae-3ec5-4abd-8206-583bbc3c4ef2&page=queryresults
[0m08:15:06.970282 [debug] [Thread-3 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108 (execute): 2023-05-04 08:15:05.092291 => 2023-05-04 08:15:06.970201
[0m08:15:06.969667 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d63ebbad-d73c-45e1-87ca-ddcf60c5fc51&page=queryresults
[0m08:15:06.972143 [debug] [Thread-7 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5 (execute): 2023-05-04 08:15:05.101969 => 2023-05-04 08:15:06.972058
[0m08:15:06.954932 [info ] [Thread-4 (]: 4 of 11 PASS source_not_null_coffee_shop_product_prices_id ..................... [[32mPASS[0m in 1.99s]
[0m08:15:06.973610 [debug] [Thread-4 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_id.056ebb10c2
[0m08:15:06.974122 [debug] [Thread-4 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc
[0m08:15:06.961242 [info ] [Thread-5 (]: 5 of 11 PASS source_not_null_coffee_shop_product_prices_product_id ............. [[32mPASS[0m in 1.90s]
[0m08:15:06.963996 [info ] [Thread-2 (]: 2 of 11 PASS source_not_null_coffee_shop_order_items_id ........................ [[32mPASS[0m in 1.93s]
[0m08:15:06.978085 [debug] [Thread-2 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_order_items_id.bbf42bb12f
[0m08:15:06.978572 [debug] [Thread-2 (]: Began running node test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9
[0m08:15:06.973151 [info ] [Thread-7 (]: 7 of 11 PASS source_unique_coffee_shop_customers_id ............................ [[32mPASS[0m in 1.95s]
[0m08:15:06.979512 [debug] [Thread-7 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5
[0m08:15:06.971293 [info ] [Thread-3 (]: 3 of 11 PASS source_not_null_coffee_shop_orders_id ............................. [[32mPASS[0m in 1.94s]
[0m08:15:06.979956 [debug] [Thread-3 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108
[0m08:15:06.977639 [debug] [Thread-5 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21
[0m08:15:06.965517 [info ] [Thread-6 (]: 6 of 11 PASS source_not_null_coffee_shop_products_id ........................... [[32mPASS[0m in 2.01s]
[0m08:15:06.980842 [debug] [Thread-6 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966
[0m08:15:06.977062 [info ] [Thread-4 (]: 10 of 11 START test source_unique_coffee_shop_product_prices_id ................ [RUN]
[0m08:15:06.979109 [info ] [Thread-2 (]: 11 of 11 START test source_unique_coffee_shop_products_id ...................... [RUN]
[0m08:15:06.983386 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9'
[0m08:15:06.983749 [debug] [Thread-2 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9
[0m08:15:06.982603 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc'
[0m08:15:06.991343 [debug] [Thread-4 (]: Began compiling node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc
[0m08:15:06.990872 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9"
[0m08:15:06.997713 [debug] [Thread-2 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9 (compile): 2023-05-04 08:15:06.984018 => 2023-05-04 08:15:06.997641
[0m08:15:06.998068 [debug] [Thread-2 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9
[0m08:15:06.997149 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc"
[0m08:15:07.002279 [debug] [Thread-4 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc (compile): 2023-05-04 08:15:06.991609 => 2023-05-04 08:15:07.002195
[0m08:15:07.002650 [debug] [Thread-4 (]: Began executing node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc
[0m08:15:07.001259 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9"
[0m08:15:07.008832 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:15:07.009271 [debug] [Thread-2 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`products`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:15:07.008126 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc"
[0m08:15:07.012006 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:15:07.012431 [debug] [Thread-4 (]: On test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`product_prices`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:15:07.093788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:63b24ffa-bdaa-4b00-af24-cb1e3a5ee0c0&page=queryresults
[0m08:15:07.094596 [debug] [Thread-1 (]: Timing info for test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0 (execute): 2023-05-04 08:15:05.121022 => 2023-05-04 08:15:07.094508
[0m08:15:07.095593 [info ] [Thread-1 (]: 1 of 11 PASS source_not_null_coffee_shop_customers_id .......................... [[32mPASS[0m in 2.14s]
[0m08:15:07.096546 [debug] [Thread-1 (]: Finished running node test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m08:15:08.418089 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ffec3b5a-15fc-4c42-a180-38d0690cd84c&page=queryresults
[0m08:15:08.418875 [debug] [Thread-4 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc (execute): 2023-05-04 08:15:07.002931 => 2023-05-04 08:15:08.418799
[0m08:15:08.419635 [info ] [Thread-4 (]: 10 of 11 PASS source_unique_coffee_shop_product_prices_id ...................... [[32mPASS[0m in 1.44s]
[0m08:15:08.420425 [debug] [Thread-4 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc
[0m08:15:08.462758 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5b67b1f5-c2f6-4f14-88e2-4977a4dceec6&page=queryresults
[0m08:15:08.463331 [debug] [Thread-2 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9 (execute): 2023-05-04 08:15:06.998309 => 2023-05-04 08:15:08.463272
[0m08:15:08.464015 [info ] [Thread-2 (]: 11 of 11 PASS source_unique_coffee_shop_products_id ............................ [[32mPASS[0m in 1.48s]
[0m08:15:08.464509 [debug] [Thread-2 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9
[0m08:15:08.717967 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d4c5dbce-4104-4693-b87e-a2ff2ab5f1b3&page=queryresults
[0m08:15:08.718781 [debug] [Thread-8 (]: Timing info for test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7 (execute): 2023-05-04 08:15:06.925300 => 2023-05-04 08:15:08.718708
[0m08:15:08.719624 [info ] [Thread-8 (]: 9 of 11 PASS source_unique_coffee_shop_orders_id ............................... [[32mPASS[0m in 1.80s]
[0m08:15:08.720481 [debug] [Thread-8 (]: Finished running node test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7
[0m08:15:08.722716 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:15:08.723248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:15:08.723770 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_customers_id.d265e0f7a0' was properly closed.
[0m08:15:08.723984 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_products_id.595b527966' was properly closed.
[0m08:15:08.724148 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_product_prices_id.223d586afc' was properly closed.
[0m08:15:08.724315 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_customers_id.33a28346d5' was properly closed.
[0m08:15:08.724481 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_orders_id.76bb24edf7' was properly closed.
[0m08:15:08.724680 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_unique_coffee_shop_products_id.cec53780a9' was properly closed.
[0m08:15:08.724841 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_orders_id.734c497108' was properly closed.
[0m08:15:08.724990 [debug] [MainThread]: Connection 'test.coffee_shop_kimwkho.source_not_null_coffee_shop_product_prices_product_id.307052ef21' was properly closed.
[0m08:15:08.725242 [info ] [MainThread]: 
[0m08:15:08.725619 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 4.94 seconds (4.94s).
[0m08:15:08.726444 [debug] [MainThread]: Command end result
[0m08:15:08.737872 [info ] [MainThread]: 
[0m08:15:08.738502 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:15:08.739912 [info ] [MainThread]: 
[0m08:15:08.740690 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m08:15:08.741503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000e2f8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f000e2f9e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffc72bc70>]}
[0m08:15:08.741908 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:15:15.597248 | 7f3a1fb6-63bc-46fb-98a3-c087aae4d812 ==============================
[0m08:15:15.597248 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:15:15.600052 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:15:15.600380 [debug] [MainThread]: Tracking: tracking
[0m08:15:15.606015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ebe618dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ebb4f8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ebb4f86a0>]}
[0m08:15:15.621634 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:15:15.656844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:15:15.657186 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:15:15.663035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f3a1fb6-63bc-46fb-98a3-c087aae4d812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ebb4e0af0>]}
[0m08:15:15.671243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f3a1fb6-63bc-46fb-98a3-c087aae4d812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ebb408fd0>]}
[0m08:15:15.671868 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:15:15.672948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f3a1fb6-63bc-46fb-98a3-c087aae4d812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ebb409030>]}
[0m08:15:15.675263 [info ] [MainThread]: 
[0m08:15:15.678528 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:15:15.680811 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:15:15.681428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:15:16.717695 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:15:16.718267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:15:16.984969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f3a1fb6-63bc-46fb-98a3-c087aae4d812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ebb4f9090>]}
[0m08:15:16.985778 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:15:16.986202 [info ] [MainThread]: 
[0m08:15:16.990574 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m08:15:16.990856 [debug] [Thread-2 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:15:16.991315 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m08:15:16.993182 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m08:15:16.991737 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:15:16.993659 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m08:15:16.994388 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:15:16.996830 [debug] [Thread-2 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:15:17.000151 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:15:17.042324 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m08:15:17.042869 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:15:16.997354 => 2023-05-04 08:15:17.042784
[0m08:15:17.043382 [debug] [Thread-2 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:15:17.054644 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-05-04 08:15:16.994758 => 2023-05-04 08:15:17.054575
[0m08:15:17.070530 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m08:15:17.074010 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:15:17.084122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:15:17.086333 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:15:17.087106 [debug] [Thread-2 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:15:17.506924 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m08:15:17.507625 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club`.`coffee_shop`.`customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id
    );
  
[0m08:15:17.555880 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:15:17.556943 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset aec-students:coffee_shop was not found in location US

Location: US
Job ID: f9775c43-bc3d-4728-bfef-cd1ab7a07e48

[0m08:15:17.557386 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:15:17.043745 => 2023-05-04 08:15:17.557316
[0m08:15:17.560376 [debug] [Thread-2 (]: Runtime Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  404 Not found: Dataset aec-students:coffee_shop was not found in location US
  
  Location: US
  Job ID: f9775c43-bc3d-4728-bfef-cd1ab7a07e48
  
[0m08:15:17.560789 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3a1fb6-63bc-46fb-98a3-c087aae4d812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ebb4ffb50>]}
[0m08:15:17.561267 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.57s]
[0m08:15:17.562971 [debug] [Thread-2 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:15:22.293734 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:58f2b516-b0ff-4339-b864-802c30833d9b&page=queryresults
[0m08:15:22.309786 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-05-04 08:15:17.074269 => 2023-05-04 08:15:22.309727
[0m08:15:22.310697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3a1fb6-63bc-46fb-98a3-c087aae4d812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ebb3b1870>]}
[0m08:15:22.311201 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_kimwkho.customers ........................ [[32mCREATE TABLE (174.4k rows, 21.3 MB processed)[0m in 5.32s]
[0m08:15:22.311721 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m08:15:22.312588 [debug] [Thread-4 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m08:15:22.312990 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m08:15:22.313801 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m08:15:22.314062 [debug] [Thread-4 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m08:15:22.317363 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m08:15:22.318223 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-05-04 08:15:22.314228 => 2023-05-04 08:15:22.318143
[0m08:15:22.318610 [debug] [Thread-4 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m08:15:22.322617 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m08:15:22.323386 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:15:22.323804 [debug] [Thread-4 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students`.`dbt_kimwkho`.`customers`
 
group by 1;


[0m08:15:23.171383 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3ccdfc29-8f5e-4e68-b234-9da9917a75d6&page=queryresults
[0m08:15:23.173484 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-05-04 08:15:22.318870 => 2023-05-04 08:15:23.173426
[0m08:15:23.174288 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3a1fb6-63bc-46fb-98a3-c087aae4d812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb82cbd30>]}
[0m08:15:23.174818 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 0.86s]
[0m08:15:23.175506 [debug] [Thread-4 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m08:15:23.177396 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:15:23.177948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:15:23.178162 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m08:15:23.178371 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:15:23.178564 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m08:15:23.178832 [info ] [MainThread]: 
[0m08:15:23.179201 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m08:15:23.179741 [debug] [MainThread]: Command end result
[0m08:15:23.188056 [info ] [MainThread]: 
[0m08:15:23.188568 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:15:23.189024 [info ] [MainThread]: 
[0m08:15:23.189465 [error] [MainThread]: [33mRuntime Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:15:23.189917 [error] [MainThread]:   404 Not found: Dataset aec-students:coffee_shop was not found in location US
[0m08:15:23.190309 [error] [MainThread]:   
[0m08:15:23.190723 [error] [MainThread]:   Location: US
[0m08:15:23.191363 [error] [MainThread]:   Job ID: f9775c43-bc3d-4728-bfef-cd1ab7a07e48
[0m08:15:23.192071 [error] [MainThread]:   
[0m08:15:23.192470 [info ] [MainThread]: 
[0m08:15:23.193180 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:15:23.193680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb82cbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb82cbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eb82cba30>]}
[0m08:15:23.194003 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:16:18.481969 | 9113af69-c874-43ed-bfcd-40ba768801e4 ==============================
[0m08:16:18.481969 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:16:18.484445 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:16:18.485038 [debug] [MainThread]: Tracking: tracking
[0m08:16:18.488300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdec85090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdec84520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdec85030>]}
[0m08:16:18.502555 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:16:18.546290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:16:18.546854 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m08:16:18.559057 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m08:16:18.620179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9113af69-c874-43ed-bfcd-40ba768801e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdeb395a0>]}
[0m08:16:18.627795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9113af69-c874-43ed-bfcd-40ba768801e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdea277f0>]}
[0m08:16:18.628243 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:16:18.628632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9113af69-c874-43ed-bfcd-40ba768801e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe1dc5b10>]}
[0m08:16:18.630117 [info ] [MainThread]: 
[0m08:16:18.632187 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:16:18.633630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:16:18.634063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:19.676534 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:16:19.677131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:19.941946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9113af69-c874-43ed-bfcd-40ba768801e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effdea26e30>]}
[0m08:16:19.942815 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:16:19.943317 [info ] [MainThread]: 
[0m08:16:19.947246 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m08:16:19.947539 [debug] [Thread-2 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:16:19.947924 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m08:16:19.949386 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m08:16:19.949784 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m08:16:19.948657 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:16:19.953464 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m08:16:19.954139 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:16:19.954654 [debug] [Thread-2 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:16:19.955313 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-05-04 08:16:19.950246 => 2023-05-04 08:16:19.955239
[0m08:16:19.957438 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m08:16:19.970783 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:16:19.974912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:19.977066 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:16:19.955487 => 2023-05-04 08:16:19.976988
[0m08:16:19.977513 [debug] [Thread-2 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:16:20.024555 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:16:20.032908 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:16:20.033873 [debug] [Thread-2 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:16:20.469442 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m08:16:20.470236 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club`.`coffee_shop`.`customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id
    );
  
[0m08:16:20.541481 [debug] [Thread-2 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 

left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id;


[0m08:16:20.542229 [debug] [Thread-2 (]: BigQuery adapter: 404 Not found: Dataset aec-students:coffee_shop was not found in location US

Location: US
Job ID: c30bae5f-f7ac-48c8-bd1b-d1b887ec8098

[0m08:16:20.542671 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:16:19.977898 => 2023-05-04 08:16:20.542602
[0m08:16:20.545132 [debug] [Thread-2 (]: Runtime Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  404 Not found: Dataset aec-students:coffee_shop was not found in location US
  
  Location: US
  Job ID: c30bae5f-f7ac-48c8-bd1b-d1b887ec8098
  
[0m08:16:20.545551 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113af69-c874-43ed-bfcd-40ba768801e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde53b7f0>]}
[0m08:16:20.546176 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.59s]
[0m08:16:20.548111 [debug] [Thread-2 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:16:25.252906 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:79c3baae-5ba6-444c-bc28-bda837d30099&page=queryresults
[0m08:16:25.269436 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-05-04 08:16:19.958298 => 2023-05-04 08:16:25.269373
[0m08:16:25.270266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113af69-c874-43ed-bfcd-40ba768801e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde539b40>]}
[0m08:16:25.270827 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_kimwkho.customers ........................ [[32mCREATE TABLE (174.4k rows, 21.3 MB processed)[0m in 5.32s]
[0m08:16:25.271407 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m08:16:25.272273 [debug] [Thread-4 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m08:16:25.272801 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m08:16:25.273564 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m08:16:25.273812 [debug] [Thread-4 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m08:16:25.276197 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m08:16:25.277370 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-05-04 08:16:25.273958 => 2023-05-04 08:16:25.277288
[0m08:16:25.277865 [debug] [Thread-4 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m08:16:25.280918 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m08:16:25.281687 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:16:25.282292 [debug] [Thread-4 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students`.`dbt_kimwkho`.`customers`
 
group by 1;


[0m08:16:26.099934 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b8da2b8f-280f-4a7e-a660-3b726794da84&page=queryresults
[0m08:16:26.102146 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-05-04 08:16:25.278250 => 2023-05-04 08:16:26.102088
[0m08:16:26.102928 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9113af69-c874-43ed-bfcd-40ba768801e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde55b730>]}
[0m08:16:26.103462 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m08:16:26.104392 [debug] [Thread-4 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m08:16:26.106614 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:16:26.107140 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:26.107364 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m08:16:26.107537 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:16:26.107694 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m08:16:26.107907 [info ] [MainThread]: 
[0m08:16:26.108681 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 7.48 seconds (7.48s).
[0m08:16:26.109698 [debug] [MainThread]: Command end result
[0m08:16:26.120467 [info ] [MainThread]: 
[0m08:16:26.121153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:16:26.121693 [info ] [MainThread]: 
[0m08:16:26.122211 [error] [MainThread]: [33mRuntime Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:16:26.122888 [error] [MainThread]:   404 Not found: Dataset aec-students:coffee_shop was not found in location US
[0m08:16:26.123365 [error] [MainThread]:   
[0m08:16:26.123999 [error] [MainThread]:   Location: US
[0m08:16:26.124455 [error] [MainThread]:   Job ID: c30bae5f-f7ac-48c8-bd1b-d1b887ec8098
[0m08:16:26.125133 [error] [MainThread]:   
[0m08:16:26.125588 [info ] [MainThread]: 
[0m08:16:26.126124 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:16:26.131660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effe1dc5b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde585240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effde586fb0>]}
[0m08:16:26.132116 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:16:48.080504 | 778b25a5-2080-498a-b4c5-9dd6ca8654ac ==============================
[0m08:16:48.080504 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:16:48.084304 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:16:48.086254 [debug] [MainThread]: Tracking: tracking
[0m08:16:48.095726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7e022050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7afe4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7afe4940>]}
[0m08:16:48.118639 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:16:48.150361 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:16:48.150897 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m08:16:48.163751 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m08:16:48.175094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7adb5c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7acf9480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7add9360>]}
[0m08:16:48.175466 [debug] [MainThread]: Flushing usage events
[0m08:16:48.577308 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop_kimwkho.weekly_revenue' (models/staging/weekly_revenue.sql) depends on a node named 'orders' in package 'coffee_shop' which was not found


============================== 2023-05-04 08:19:59.964480 | 8933ae16-3546-4054-a20a-5058bc5ebd45 ==============================
[0m08:19:59.964480 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:19:59.967289 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:19:59.968034 [debug] [MainThread]: Tracking: tracking
[0m08:19:59.971761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8eea81150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8eea805e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8eea810f0>]}
[0m08:19:59.986300 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:20:00.035528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:20:00.036512 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m08:20:00.085937 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m08:20:00.153557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8933ae16-3546-4054-a20a-5058bc5ebd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ee935570>]}
[0m08:20:00.161837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8933ae16-3546-4054-a20a-5058bc5ebd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ee8277f0>]}
[0m08:20:00.162292 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:20:00.162941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8933ae16-3546-4054-a20a-5058bc5ebd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ee827820>]}
[0m08:20:00.164451 [info ] [MainThread]: 
[0m08:20:00.166660 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:20:00.167776 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:20:00.168248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:01.267656 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:20:01.268257 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:01.586013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8933ae16-3546-4054-a20a-5058bc5ebd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ee827850>]}
[0m08:20:01.586807 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:20:01.587333 [info ] [MainThread]: 
[0m08:20:01.591360 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:01.591786 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:20:01.592677 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:20:01.592975 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:01.596963 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:20:01.597633 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:20:01.593161 => 2023-05-04 08:20:01.597541
[0m08:20:01.597940 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:01.631105 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:20:01.631781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:01.632408 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
)

with ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m08:20:01.925887 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [17:1]')
[0m08:20:03.075390 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:39d0871c-5b4d-4856-9bed-fa455efdd8c2&page=queryresults
[0m08:20:03.076306 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:20:01.598131 => 2023-05-04 08:20:03.076197
[0m08:20:03.079142 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [17:1]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:20:03.079569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8933ae16-3546-4054-a20a-5058bc5ebd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ee8638b0>]}
[0m08:20:03.080068 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.49s]
[0m08:20:03.082119 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:03.083881 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:20:03.084463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:03.084712 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:20:03.084974 [info ] [MainThread]: 
[0m08:20:03.085376 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m08:20:03.085868 [debug] [MainThread]: Command end result
[0m08:20:03.092738 [info ] [MainThread]: 
[0m08:20:03.093346 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:20:03.093887 [info ] [MainThread]: 
[0m08:20:03.094406 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:20:03.095135 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [17:1]
[0m08:20:03.095898 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:20:03.096353 [info ] [MainThread]: 
[0m08:20:03.097134 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:20:03.097918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8eea81030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8eea83850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8ee87f370>]}
[0m08:20:03.098315 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:20:15.225076 | bfafd7ad-610d-40bc-b706-e3bb4c1535ca ==============================
[0m08:20:15.225076 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:20:15.228144 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:20:15.228634 [debug] [MainThread]: Tracking: tracking
[0m08:20:15.233098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f7cf5540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f7cf5000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f7cf48e0>]}
[0m08:20:15.247927 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:20:15.283253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:20:15.283805 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m08:20:15.296055 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m08:20:15.352605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfafd7ad-610d-40bc-b706-e3bb4c1535ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f7c09240>]}
[0m08:20:15.360434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfafd7ad-610d-40bc-b706-e3bb4c1535ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f7c9f490>]}
[0m08:20:15.360849 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:20:15.361227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfafd7ad-610d-40bc-b706-e3bb4c1535ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45fae14790>]}
[0m08:20:15.362468 [info ] [MainThread]: 
[0m08:20:15.364894 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:20:15.366388 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:20:15.366834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:16.609866 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:20:16.610342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:16.888201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfafd7ad-610d-40bc-b706-e3bb4c1535ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f7c9e6b0>]}
[0m08:20:16.889032 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:20:16.889452 [info ] [MainThread]: 
[0m08:20:16.893445 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:16.893840 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:20:16.894747 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:20:16.895018 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:16.898962 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:20:16.899728 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:20:16.895183 => 2023-05-04 08:20:16.899644
[0m08:20:16.900094 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:16.932885 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:20:16.933803 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:16.934501 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
);

with ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m08:20:17.245498 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got ";" at [15:2]')
[0m08:20:18.280223 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:abf0ed21-3ad9-4fe0-8808-a9eabd3d9c96&page=queryresults
[0m08:20:18.281140 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:20:16.900344 => 2023-05-04 08:20:18.281029
[0m08:20:18.284199 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Expected "(" or "," or keyword SELECT but got ";" at [15:2]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:20:18.284701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfafd7ad-610d-40bc-b706-e3bb4c1535ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f7cd7970>]}
[0m08:20:18.285254 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.39s]
[0m08:20:18.287367 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:18.289156 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:20:18.289678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:18.289895 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:20:18.290110 [info ] [MainThread]: 
[0m08:20:18.290485 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m08:20:18.290981 [debug] [MainThread]: Command end result
[0m08:20:18.298083 [info ] [MainThread]: 
[0m08:20:18.298686 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:20:18.299238 [info ] [MainThread]: 
[0m08:20:18.299760 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:20:18.300222 [error] [MainThread]:   Syntax error: Expected "(" or "," or keyword SELECT but got ";" at [15:2]
[0m08:20:18.300979 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m08:20:18.301441 [info ] [MainThread]: 
[0m08:20:18.302193 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:20:18.302728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f7af1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f7af3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f7af14b0>]}
[0m08:20:18.303094 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 08:20:49.127072 | 0e03f68c-a31f-461b-8aab-5ad6a167aa4d ==============================
[0m08:20:49.127072 [info ] [MainThread]: Running with dbt=1.4.5
[0m08:20:49.129841 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m08:20:49.130330 [debug] [MainThread]: Tracking: tracking
[0m08:20:49.136165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b76717dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b735ec5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b735ec640>]}
[0m08:20:49.150180 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m08:20:49.186231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:20:49.186751 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m08:20:49.198878 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m08:20:49.258692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e03f68c-a31f-461b-8aab-5ad6a167aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b735018d0>]}
[0m08:20:49.266266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e03f68c-a31f-461b-8aab-5ad6a167aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b73597b50>]}
[0m08:20:49.266712 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m08:20:49.267098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e03f68c-a31f-461b-8aab-5ad6a167aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b73597b80>]}
[0m08:20:49.268412 [info ] [MainThread]: 
[0m08:20:49.270889 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:20:49.271976 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m08:20:49.272404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:50.348031 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m08:20:50.348508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:20:50.627196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e03f68c-a31f-461b-8aab-5ad6a167aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b73597280>]}
[0m08:20:50.627992 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m08:20:50.628408 [info ] [MainThread]: 
[0m08:20:50.632429 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:50.632884 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m08:20:50.633657 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m08:20:50.633941 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:50.637280 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:20:50.637937 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 08:20:50.634123 => 2023-05-04 08:20:50.637854
[0m08:20:50.638240 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:50.670525 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m08:20:50.671244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:20:50.671874 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m08:20:51.097856 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m08:20:51.098653 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset aec-students:coffee_shop was not found in location US

Location: US
Job ID: 0987559a-faa8-4854-9fe8-30923aacfacc

[0m08:20:51.099124 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 08:20:50.638420 => 2023-05-04 08:20:51.099049
[0m08:20:51.101687 [debug] [Thread-1 (]: Runtime Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  404 Not found: Dataset aec-students:coffee_shop was not found in location US
  
  Location: US
  Job ID: 0987559a-faa8-4854-9fe8-30923aacfacc
  
[0m08:20:51.102086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e03f68c-a31f-461b-8aab-5ad6a167aa4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b735d0250>]}
[0m08:20:51.102569 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.47s]
[0m08:20:51.104271 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m08:20:51.106628 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:20:51.107234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:51.107451 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m08:20:51.107675 [info ] [MainThread]: 
[0m08:20:51.108058 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m08:20:51.108535 [debug] [MainThread]: Command end result
[0m08:20:51.115631 [info ] [MainThread]: 
[0m08:20:51.116141 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:20:51.116609 [info ] [MainThread]: 
[0m08:20:51.117071 [error] [MainThread]: [33mRuntime Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m08:20:51.117529 [error] [MainThread]:   404 Not found: Dataset aec-students:coffee_shop was not found in location US
[0m08:20:51.117935 [error] [MainThread]:   
[0m08:20:51.118330 [error] [MainThread]:   Location: US
[0m08:20:51.118756 [error] [MainThread]:   Job ID: 0987559a-faa8-4854-9fe8-30923aacfacc
[0m08:20:51.119204 [error] [MainThread]:   
[0m08:20:51.119669 [info ] [MainThread]: 
[0m08:20:51.120060 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:20:51.120555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b735ed000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b735edf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6b76714fa0>]}
[0m08:20:51.120949 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 11:10:13.348743 | 4f16fdea-5e0a-453f-a5a3-f1fa991c6d40 ==============================
[0m11:10:13.348743 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:10:13.357522 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:10:13.359171 [debug] [MainThread]: Tracking: tracking
[0m11:10:13.367281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f7f31f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f7f1570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f7f0b20>]}
[0m11:10:13.385080 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:10:13.528586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:13.529069 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:13.537221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f16fdea-5e0a-453f-a5a3-f1fa991c6d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f7e00d0>]}
[0m11:10:13.546425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f16fdea-5e0a-453f-a5a3-f1fa991c6d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f7a45b0>]}
[0m11:10:13.546838 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m11:10:13.547690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f16fdea-5e0a-453f-a5a3-f1fa991c6d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f7a4610>]}
[0m11:10:13.549258 [info ] [MainThread]: 
[0m11:10:13.551721 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:10:13.552966 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:10:13.553535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:17.665262 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:10:17.666186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:17.945919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f16fdea-5e0a-453f-a5a3-f1fa991c6d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f809cf0>]}
[0m11:10:17.947087 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:10:17.948239 [info ] [MainThread]: 
[0m11:10:17.965912 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:10:17.966475 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m11:10:17.967872 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m11:10:17.968428 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m11:10:17.973951 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:10:17.974501 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 11:10:17.968825 => 2023-05-04 11:10:17.974398
[0m11:10:17.974919 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m11:10:18.070615 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:10:18.071408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:18.072160 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:10:18.500551 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:10:18.501514 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset aec-students:coffee_shop was not found in location US

Location: US
Job ID: 7d16a389-f7a2-4f69-9657-dbc874bfae82

[0m11:10:18.502068 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 11:10:17.975133 => 2023-05-04 11:10:18.501974
[0m11:10:18.534056 [debug] [Thread-1 (]: Runtime Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  404 Not found: Dataset aec-students:coffee_shop was not found in location US
  
  Location: US
  Job ID: 7d16a389-f7a2-4f69-9657-dbc874bfae82
  
[0m11:10:18.534594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f16fdea-5e0a-453f-a5a3-f1fa991c6d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f7c9ae0>]}
[0m11:10:18.535212 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.57s]
[0m11:10:18.538432 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:10:18.541077 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:10:18.542341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:18.542644 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m11:10:18.542934 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m11:10:18.543294 [info ] [MainThread]: 
[0m11:10:18.543777 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.99 seconds (4.99s).
[0m11:10:18.545194 [debug] [MainThread]: Command end result
[0m11:10:18.552445 [info ] [MainThread]: 
[0m11:10:18.553206 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:10:18.553930 [info ] [MainThread]: 
[0m11:10:18.554721 [error] [MainThread]: [33mRuntime Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m11:10:18.555230 [error] [MainThread]:   404 Not found: Dataset aec-students:coffee_shop was not found in location US
[0m11:10:18.555732 [error] [MainThread]:   
[0m11:10:18.556517 [error] [MainThread]:   Location: US
[0m11:10:18.557029 [error] [MainThread]:   Job ID: 7d16a389-f7a2-4f69-9657-dbc874bfae82
[0m11:10:18.557539 [error] [MainThread]:   
[0m11:10:18.558061 [info ] [MainThread]: 
[0m11:10:18.558856 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:10:18.559485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f809c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f7e3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f396f7e3100>]}
[0m11:10:18.559960 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 11:13:16.219475 | c40d398e-b8e2-4d14-adbf-ffcf1b13924b ==============================
[0m11:13:16.219475 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:13:16.223936 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:13:16.225623 [debug] [MainThread]: Tracking: tracking
[0m11:13:16.231594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d4851e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d484670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d485240>]}
[0m11:13:16.246928 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:13:16.283657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:16.283979 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:16.290294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c40d398e-b8e2-4d14-adbf-ffcf1b13924b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d277df0>]}
[0m11:13:16.298461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c40d398e-b8e2-4d14-adbf-ffcf1b13924b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d33cbe0>]}
[0m11:13:16.298901 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m11:13:16.299385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40d398e-b8e2-4d14-adbf-ffcf1b13924b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d33cc40>]}
[0m11:13:16.301244 [info ] [MainThread]: 
[0m11:13:16.303345 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:13:16.304830 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:13:16.305316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:17.564568 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:13:17.571043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:17.854823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40d398e-b8e2-4d14-adbf-ffcf1b13924b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d484940>]}
[0m11:13:17.855810 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:13:17.857291 [info ] [MainThread]: 
[0m11:13:17.862513 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:13:17.863004 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m11:13:17.863889 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m11:13:17.864225 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m11:13:17.869136 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:13:17.869716 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 11:13:17.864447 => 2023-05-04 11:13:17.869612
[0m11:13:17.870114 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m11:13:17.959124 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:13:17.959791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:13:17.960565 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:13:18.394428 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:13:18.395513 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset aec-students:coffee_shop was not found in location US

Location: US
Job ID: 08df1c92-ce07-4e2f-8acc-7f4d5f2e1148

[0m11:13:18.396192 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 11:13:17.870322 => 2023-05-04 11:13:18.396084
[0m11:13:18.399160 [debug] [Thread-1 (]: Runtime Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  404 Not found: Dataset aec-students:coffee_shop was not found in location US
  
  Location: US
  Job ID: 08df1c92-ce07-4e2f-8acc-7f4d5f2e1148
  
[0m11:13:18.399627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40d398e-b8e2-4d14-adbf-ffcf1b13924b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d25a4d0>]}
[0m11:13:18.400202 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.54s]
[0m11:13:18.402643 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:13:18.404710 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:13:18.405394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:18.405673 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m11:13:18.405954 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m11:13:18.406305 [info ] [MainThread]: 
[0m11:13:18.406749 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m11:13:18.408075 [debug] [MainThread]: Command end result
[0m11:13:18.415967 [info ] [MainThread]: 
[0m11:13:18.416495 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:13:18.417030 [info ] [MainThread]: 
[0m11:13:18.417575 [error] [MainThread]: [33mRuntime Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m11:13:18.418113 [error] [MainThread]:   404 Not found: Dataset aec-students:coffee_shop was not found in location US
[0m11:13:18.418637 [error] [MainThread]:   
[0m11:13:18.419152 [error] [MainThread]:   Location: US
[0m11:13:18.419664 [error] [MainThread]:   Job ID: 08df1c92-ce07-4e2f-8acc-7f4d5f2e1148
[0m11:13:18.420185 [error] [MainThread]:   
[0m11:13:18.420756 [info ] [MainThread]: 
[0m11:13:18.421279 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:13:18.422026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d33c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d33c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f787d49d060>]}
[0m11:13:18.422523 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 11:51:23.240263 | 8bf61e8a-00ec-457b-a715-a291cb0213a2 ==============================
[0m11:51:23.240263 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:51:23.247477 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:51:23.248799 [debug] [MainThread]: Tracking: tracking
[0m11:51:23.263154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99db03970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99abdc460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99abdc490>]}
[0m11:51:23.284530 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:51:23.457789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:23.458177 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:23.464555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bf61e8a-00ec-457b-a715-a291cb0213a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99a9d0d30>]}
[0m11:51:23.473539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bf61e8a-00ec-457b-a715-a291cb0213a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99aa5d210>]}
[0m11:51:23.473976 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m11:51:23.474420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bf61e8a-00ec-457b-a715-a291cb0213a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99aa5d270>]}
[0m11:51:23.476419 [info ] [MainThread]: 
[0m11:51:23.478676 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:51:23.480004 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:51:23.480723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:28.742049 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:51:28.742619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:29.037531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bf61e8a-00ec-457b-a715-a291cb0213a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99abdd540>]}
[0m11:51:29.038531 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:51:29.039459 [info ] [MainThread]: 
[0m11:51:29.063347 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:51:29.063898 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m11:51:29.064805 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m11:51:29.065126 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m11:51:29.072534 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:51:29.073136 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 11:51:29.065356 => 2023-05-04 11:51:29.073029
[0m11:51:29.073569 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m11:51:29.156697 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:51:29.157445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:29.158206 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:51:29.553587 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join coffee_shop.order_items on product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:51:29.555366 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Dataset aec-students:coffee_shop was not found in location US

Location: US
Job ID: 85fb6720-8194-4b4d-9fdd-1fb8f567dbe1

[0m11:51:29.556324 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 11:51:29.073881 => 2023-05-04 11:51:29.556158
[0m11:51:29.590677 [debug] [Thread-1 (]: Runtime Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  404 Not found: Dataset aec-students:coffee_shop was not found in location US
  
  Location: US
  Job ID: 85fb6720-8194-4b4d-9fdd-1fb8f567dbe1
  
[0m11:51:29.591318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bf61e8a-00ec-457b-a715-a291cb0213a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99a9b98a0>]}
[0m11:51:29.591960 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.53s]
[0m11:51:29.594760 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:51:29.596852 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:51:29.597503 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:29.597841 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m11:51:29.598215 [info ] [MainThread]: 
[0m11:51:29.598665 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m11:51:29.599253 [debug] [MainThread]: Command end result
[0m11:51:29.607989 [info ] [MainThread]: 
[0m11:51:29.608513 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:51:29.609046 [info ] [MainThread]: 
[0m11:51:29.609625 [error] [MainThread]: [33mRuntime Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m11:51:29.610152 [error] [MainThread]:   404 Not found: Dataset aec-students:coffee_shop was not found in location US
[0m11:51:29.610766 [error] [MainThread]:   
[0m11:51:29.611268 [error] [MainThread]:   Location: US
[0m11:51:29.612195 [error] [MainThread]:   Job ID: 85fb6720-8194-4b4d-9fdd-1fb8f567dbe1
[0m11:51:29.613221 [error] [MainThread]:   
[0m11:51:29.614092 [info ] [MainThread]: 
[0m11:51:29.614602 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:51:29.615272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99aa5d120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99aa5d1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb99a9bb070>]}
[0m11:51:29.615754 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 11:51:55.992992 | 7f3305c3-c06c-47a0-8c12-7996daa0d797 ==============================
[0m11:51:55.992992 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:51:55.995851 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:51:55.996204 [debug] [MainThread]: Tracking: tracking
[0m11:51:55.999915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe799701d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7967dc940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7967dce80>]}
[0m11:51:56.014931 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:51:56.054437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:51:56.055017 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m11:51:56.067693 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m11:51:56.144077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f3305c3-c06c-47a0-8c12-7996daa0d797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe79665d720>]}
[0m11:51:56.152027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f3305c3-c06c-47a0-8c12-7996daa0d797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe79658ba00>]}
[0m11:51:56.152476 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m11:51:56.152917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f3305c3-c06c-47a0-8c12-7996daa0d797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe79658ba30>]}
[0m11:51:56.154477 [info ] [MainThread]: 
[0m11:51:56.156820 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:51:56.158024 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:51:56.158538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:57.294185 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:51:57.294869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:57.597822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f3305c3-c06c-47a0-8c12-7996daa0d797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe79658bb50>]}
[0m11:51:57.598760 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:51:57.599258 [info ] [MainThread]: 
[0m11:51:57.604596 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:51:57.605040 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m11:51:57.606037 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m11:51:57.606324 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m11:51:57.611161 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:51:57.611993 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 11:51:57.606517 => 2023-05-04 11:51:57.611914
[0m11:51:57.612371 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m11:51:57.646764 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:51:57.647750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:57.648499 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join products on order_items.product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:51:57.972466 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "products" must be qualified with a dataset (e.g. dataset.table).')
[0m11:51:59.153659 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:eaf46a1f-e683-44c8-8c09-170b6c13a5bd&page=queryresults
[0m11:51:59.154855 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 11:51:57.612696 => 2023-05-04 11:51:59.154705
[0m11:51:59.158444 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Table "products" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m11:51:59.158976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f3305c3-c06c-47a0-8c12-7996daa0d797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7965c7370>]}
[0m11:51:59.159641 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.55s]
[0m11:51:59.161674 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:51:59.163762 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:51:59.164338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:59.164571 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m11:51:59.164821 [info ] [MainThread]: 
[0m11:51:59.165242 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m11:51:59.165904 [debug] [MainThread]: Command end result
[0m11:51:59.173854 [info ] [MainThread]: 
[0m11:51:59.174447 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:51:59.175002 [info ] [MainThread]: 
[0m11:51:59.175611 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m11:51:59.176327 [error] [MainThread]:   Table "products" must be qualified with a dataset (e.g. dataset.table).
[0m11:51:59.176923 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m11:51:59.177600 [info ] [MainThread]: 
[0m11:51:59.178338 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:51:59.179132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7967df670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7967dca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe799700dc0>]}
[0m11:51:59.179717 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 11:52:39.864982 | 3be0ca8c-1625-4df5-8642-f408e1119cb6 ==============================
[0m11:52:39.864982 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:52:39.868016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:52:39.868563 [debug] [MainThread]: Tracking: tracking
[0m11:52:39.874072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eda613970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed76e45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed76e4640>]}
[0m11:52:39.890892 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:52:39.926597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:39.927874 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m11:52:39.940743 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m11:52:40.049265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3be0ca8c-1625-4df5-8642-f408e1119cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed74018d0>]}
[0m11:52:40.062439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3be0ca8c-1625-4df5-8642-f408e1119cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed7493b50>]}
[0m11:52:40.063157 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m11:52:40.064406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3be0ca8c-1625-4df5-8642-f408e1119cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed7493b80>]}
[0m11:52:40.066428 [info ] [MainThread]: 
[0m11:52:40.069772 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:40.071822 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:52:40.072452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:41.286843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:52:41.287603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:41.558054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3be0ca8c-1625-4df5-8642-f408e1119cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed7493280>]}
[0m11:52:41.559614 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:52:41.560129 [info ] [MainThread]: 
[0m11:52:41.564933 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:52:41.565504 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m11:52:41.566469 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m11:52:41.566848 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m11:52:41.570472 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:52:41.571313 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 11:52:41.567144 => 2023-05-04 11:52:41.571226
[0m11:52:41.571729 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m11:52:41.613552 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:52:41.614900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:41.616014 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join `analytics-engineers-club`.`coffee_shop`.`products` on order_items.product_id = products.id 
left join `analytics-engineers-club`.`coffee_shop`.`weekly_revenue` on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:52:42.092741 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join `analytics-engineers-club`.`coffee_shop`.`products` on order_items.product_id = products.id 
left join `analytics-engineers-club`.`coffee_shop`.`weekly_revenue` on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:52:42.094216 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table analytics-engineers-club:coffee_shop.weekly_revenue was not found in location US

Location: US
Job ID: d966da48-45bd-4866-b796-a384fcc3bd36

[0m11:52:42.095059 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 11:52:41.572013 => 2023-05-04 11:52:42.094936
[0m11:52:42.100385 [debug] [Thread-1 (]: Runtime Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  404 Not found: Table analytics-engineers-club:coffee_shop.weekly_revenue was not found in location US
  
  Location: US
  Job ID: d966da48-45bd-4866-b796-a384fcc3bd36
  
[0m11:52:42.100955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3be0ca8c-1625-4df5-8642-f408e1119cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed74c9f00>]}
[0m11:52:42.101593 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.53s]
[0m11:52:42.103555 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:52:42.105875 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:42.106479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:42.106715 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m11:52:42.106962 [info ] [MainThread]: 
[0m11:52:42.107366 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m11:52:42.108620 [debug] [MainThread]: Command end result
[0m11:52:42.116684 [info ] [MainThread]: 
[0m11:52:42.117279 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:52:42.118132 [info ] [MainThread]: 
[0m11:52:42.118785 [error] [MainThread]: [33mRuntime Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m11:52:42.119439 [error] [MainThread]:   404 Not found: Table analytics-engineers-club:coffee_shop.weekly_revenue was not found in location US
[0m11:52:42.120038 [error] [MainThread]:   
[0m11:52:42.120714 [error] [MainThread]:   Location: US
[0m11:52:42.121261 [error] [MainThread]:   Job ID: d966da48-45bd-4866-b796-a384fcc3bd36
[0m11:52:42.121805 [error] [MainThread]:   
[0m11:52:42.122423 [info ] [MainThread]: 
[0m11:52:42.123034 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:52:42.123760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed76e5330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ed76f3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0eda611b10>]}
[0m11:52:42.124348 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 11:52:59.524729 | a5e90d07-94c4-4899-b8dc-f3b13f1bc574 ==============================
[0m11:52:59.524729 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:52:59.527457 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:52:59.527834 [debug] [MainThread]: Tracking: tracking
[0m11:52:59.532419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce3c03dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce0ce45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce0ce4640>]}
[0m11:52:59.548242 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:52:59.587263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:59.587998 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m11:52:59.600963 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m11:52:59.679497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5e90d07-94c4-4899-b8dc-f3b13f1bc574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce09fd8d0>]}
[0m11:52:59.687412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5e90d07-94c4-4899-b8dc-f3b13f1bc574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce0a93b50>]}
[0m11:52:59.687877 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m11:52:59.688337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e90d07-94c4-4899-b8dc-f3b13f1bc574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce0a93b80>]}
[0m11:52:59.689838 [info ] [MainThread]: 
[0m11:52:59.692507 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:52:59.693823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:52:59.694483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:00.791543 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:53:00.792249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:01.060245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5e90d07-94c4-4899-b8dc-f3b13f1bc574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce0a93280>]}
[0m11:53:01.061792 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:53:01.062315 [info ] [MainThread]: 
[0m11:53:01.069844 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:53:01.070532 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m11:53:01.072311 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m11:53:01.072663 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m11:53:01.077384 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:53:01.078354 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 11:53:01.072873 => 2023-05-04 11:53:01.078256
[0m11:53:01.078757 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m11:53:01.115139 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:53:01.116257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:01.117161 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join `analytics-engineers-club`.`coffee_shop`.`products` on order_items.product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:53:02.042368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cad52fdf-8d67-45c7-aed8-d37e721f4e6a&page=queryresults
[0m11:53:02.057681 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 11:53:01.079048 => 2023-05-04 11:53:02.057609
[0m11:53:02.058579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5e90d07-94c4-4899-b8dc-f3b13f1bc574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce09fcee0>]}
[0m11:53:02.059167 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_kimwkho.weekly_revenue .................... [[32mCREATE VIEW (0 processed)[0m in 0.99s]
[0m11:53:02.061323 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:53:02.063688 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:53:02.064263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:02.064503 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m11:53:02.064754 [info ] [MainThread]: 
[0m11:53:02.065181 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m11:53:02.065816 [debug] [MainThread]: Command end result
[0m11:53:02.074927 [info ] [MainThread]: 
[0m11:53:02.075463 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:02.075976 [info ] [MainThread]: 
[0m11:53:02.076490 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:53:02.077235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce3c03dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce0a93730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce0a93c10>]}
[0m11:53:02.077831 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 11:55:53.034447 | 70d3c0cb-da7a-4bfd-b173-56b682e4843b ==============================
[0m11:55:53.034447 [info ] [MainThread]: Running with dbt=1.4.5
[0m11:55:53.037162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m11:55:53.037579 [debug] [MainThread]: Tracking: tracking
[0m11:55:53.047666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d06a1cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d038f8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d038f8f10>]}
[0m11:55:53.063553 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m11:55:53.121170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:53.121854 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:53.142182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70d3c0cb-da7a-4bfd-b173-56b682e4843b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d038e49a0>]}
[0m11:55:53.169747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70d3c0cb-da7a-4bfd-b173-56b682e4843b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d0380ce80>]}
[0m11:55:53.170518 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m11:55:53.171927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70d3c0cb-da7a-4bfd-b173-56b682e4843b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d0380cee0>]}
[0m11:55:53.173934 [info ] [MainThread]: 
[0m11:55:53.179387 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:55:53.194438 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m11:55:53.195276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:54.321318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m11:55:54.322033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:54.620074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70d3c0cb-da7a-4bfd-b173-56b682e4843b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d038f8430>]}
[0m11:55:54.621089 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m11:55:54.621991 [info ] [MainThread]: 
[0m11:55:54.626917 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:55:54.627345 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m11:55:54.628233 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m11:55:54.628526 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m11:55:54.634823 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:55:54.635644 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 11:55:54.628725 => 2023-05-04 11:55:54.635563
[0m11:55:54.636008 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m11:55:54.754041 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m11:55:54.755122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:54.755905 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join `analytics-engineers-club`.`coffee_shop`.`products` on order_items.product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m11:55:55.727298 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:65539db6-b093-439a-8181-5c01b42704ce&page=queryresults
[0m11:55:55.755859 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 11:55:54.636288 => 2023-05-04 11:55:55.755748
[0m11:55:55.757031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70d3c0cb-da7a-4bfd-b173-56b682e4843b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d037b44f0>]}
[0m11:55:55.757807 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_kimwkho.weekly_revenue .................... [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m11:55:55.762882 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m11:55:55.765000 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:55:55.765720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:55.765966 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m11:55:55.766263 [info ] [MainThread]: 
[0m11:55:55.766711 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m11:55:55.768222 [debug] [MainThread]: Command end result
[0m11:55:55.776663 [info ] [MainThread]: 
[0m11:55:55.777219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:55.777834 [info ] [MainThread]: 
[0m11:55:55.779020 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:55:55.780048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d079d63b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d03910ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d03911360>]}
[0m11:55:55.780697 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:04:52.966158 | 1d566422-da2e-4f39-baee-2d37f70af3cd ==============================
[0m12:04:52.966158 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:04:52.968811 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:04:52.969177 [debug] [MainThread]: Tracking: tracking
[0m12:04:52.975877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f88287af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f88284e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f88285300>]}
[0m12:04:52.991383 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:04:53.028918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:04:53.029263 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:04:53.035338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d566422-da2e-4f39-baee-2d37f70af3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f88070610>]}
[0m12:04:53.047503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d566422-da2e-4f39-baee-2d37f70af3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f88138af0>]}
[0m12:04:53.048120 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:04:53.048685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d566422-da2e-4f39-baee-2d37f70af3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f88138b50>]}
[0m12:04:53.050601 [info ] [MainThread]: 
[0m12:04:53.054055 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:04:53.055711 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:04:53.056378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:54.351793 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:04:54.352612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:54.640485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d566422-da2e-4f39-baee-2d37f70af3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f88138520>]}
[0m12:04:54.641616 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:04:54.642216 [info ] [MainThread]: 
[0m12:04:54.647688 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:04:54.648160 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:04:54.649052 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:04:54.649349 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:04:54.654407 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:04:54.655008 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:04:54.649638 => 2023-05-04 12:04:54.654904
[0m12:04:54.655365 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:04:54.745667 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:04:54.746697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:54.747728 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        id 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1,2  
),

ordered_items as (
    select
        order_id
        , product_id
        , category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`order_items` 
left join `analytics-engineers-club`.`coffee_shop`.`products` on order_items.product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:04:55.707134 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a4b9db49-c6dd-4d37-bce1-b0966a49a721&page=queryresults
[0m12:04:55.723617 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:04:54.655572 => 2023-05-04 12:04:55.723548
[0m12:04:55.724516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d566422-da2e-4f39-baee-2d37f70af3cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f87f3c4f0>]}
[0m12:04:55.725137 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_kimwkho.weekly_revenue .................... [[32mCREATE VIEW (0 processed)[0m in 1.08s]
[0m12:04:55.727336 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:04:55.729668 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:04:55.730256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:55.730496 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m12:04:55.730738 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:04:55.731037 [info ] [MainThread]: 
[0m12:04:55.731425 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m12:04:55.731893 [debug] [MainThread]: Command end result
[0m12:04:55.739659 [info ] [MainThread]: 
[0m12:04:55.740159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:55.740670 [info ] [MainThread]: 
[0m12:04:55.741295 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:04:55.741978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f8802b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f881384c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f88138520>]}
[0m12:04:55.742444 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:07:13.413499 | 80aa9a55-1ea2-4a7d-b8ef-30babbd0e767 ==============================
[0m12:07:13.413499 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:07:13.416081 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:07:13.416443 [debug] [MainThread]: Tracking: tracking
[0m12:07:13.420599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551afb2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551af8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551af9300>]}
[0m12:07:13.435777 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:07:13.475195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:13.475849 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m12:07:13.488556 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m12:07:13.563236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80aa9a55-1ea2-4a7d-b8ef-30babbd0e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551a0d420>]}
[0m12:07:13.571053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80aa9a55-1ea2-4a7d-b8ef-30babbd0e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551aa36a0>]}
[0m12:07:13.571490 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:07:13.571936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80aa9a55-1ea2-4a7d-b8ef-30babbd0e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551aa36d0>]}
[0m12:07:13.573738 [info ] [MainThread]: 
[0m12:07:13.575760 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:13.577302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:07:13.577777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:14.674500 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:07:14.675063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:14.950012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80aa9a55-1ea2-4a7d-b8ef-30babbd0e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551aa2a70>]}
[0m12:07:14.951248 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:07:14.951877 [info ] [MainThread]: 
[0m12:07:14.957167 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:14.957705 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:07:14.958561 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:07:14.958885 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:14.962240 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:07:14.962798 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:07:14.959100 => 2023-05-04 12:07:14.962696
[0m12:07:14.963274 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:14.996983 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:07:14.997645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:14.998828 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        , timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenues
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`products` on order_items.product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:07:15.279226 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "," at [10:9]')
[0m12:07:15.596104 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:aa96a54b-dd90-4514-98b4-f04969b197cb&page=queryresults
[0m12:07:15.597141 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:07:14.963573 => 2023-05-04 12:07:15.596995
[0m12:07:15.601021 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Unexpected "," at [10:9]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:07:15.601577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80aa9a55-1ea2-4a7d-b8ef-30babbd0e767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551ade1d0>]}
[0m12:07:15.602266 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 0.64s]
[0m12:07:15.604286 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:15.606397 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:15.607083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:15.607329 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:07:15.607633 [info ] [MainThread]: 
[0m12:07:15.608104 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m12:07:15.608770 [debug] [MainThread]: Command end result
[0m12:07:15.616378 [info ] [MainThread]: 
[0m12:07:15.616899 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:07:15.617435 [info ] [MainThread]: 
[0m12:07:15.617961 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m12:07:15.618463 [error] [MainThread]:   Syntax error: Unexpected "," at [10:9]
[0m12:07:15.618960 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:07:15.619464 [info ] [MainThread]: 
[0m12:07:15.619964 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:07:15.620595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551af83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1551af9000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15518f9690>]}
[0m12:07:15.621122 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:07:32.773619 | 63d5379b-5edd-4ced-874e-6f6607c6efd5 ==============================
[0m12:07:32.773619 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:07:32.778588 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:07:32.778956 [debug] [MainThread]: Tracking: tracking
[0m12:07:32.786050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaeee1030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaeee04c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaeee0fd0>]}
[0m12:07:32.802042 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:07:32.839566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:32.840329 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m12:07:32.853653 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m12:07:32.941437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63d5379b-5edd-4ced-874e-6f6607c6efd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaebf9600>]}
[0m12:07:32.949625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63d5379b-5edd-4ced-874e-6f6607c6efd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaec8f880>]}
[0m12:07:32.950111 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:07:32.950566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63d5379b-5edd-4ced-874e-6f6607c6efd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaec8f8b0>]}
[0m12:07:32.952826 [info ] [MainThread]: 
[0m12:07:32.955154 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:32.956468 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:07:32.956977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:34.034992 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:07:34.035751 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:34.320368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63d5379b-5edd-4ced-874e-6f6607c6efd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaec8f8e0>]}
[0m12:07:34.321451 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:07:34.322309 [info ] [MainThread]: 
[0m12:07:34.327361 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:34.327827 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:07:34.328724 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:07:34.329052 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:34.332821 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:07:34.333428 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:07:34.329265 => 2023-05-04 12:07:34.333310
[0m12:07:34.333861 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:34.367087 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:07:34.367692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:34.368432 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenues
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`products` on order_items.product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:07:35.244426 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Duplicate table alias products in the same FROM clause at [20:11]')
[0m12:07:36.232277 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a958bb96-0c5c-495b-a5e4-08b7844b9ee0&page=queryresults
[0m12:07:36.233894 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:07:34.334162 => 2023-05-04 12:07:36.233729
[0m12:07:36.237630 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Duplicate table alias products in the same FROM clause at [20:11]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:07:36.238267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63d5379b-5edd-4ced-874e-6f6607c6efd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaae7bb400>]}
[0m12:07:36.239022 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.91s]
[0m12:07:36.241608 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:36.243711 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:36.244311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:36.244550 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:07:36.244800 [info ] [MainThread]: 
[0m12:07:36.245284 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m12:07:36.245869 [debug] [MainThread]: Command end result
[0m12:07:36.253822 [info ] [MainThread]: 
[0m12:07:36.254438 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:07:36.254981 [info ] [MainThread]: 
[0m12:07:36.255936 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m12:07:36.256464 [error] [MainThread]:   Duplicate table alias products in the same FROM clause at [20:11]
[0m12:07:36.256987 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:07:36.257964 [info ] [MainThread]: 
[0m12:07:36.258574 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:07:36.259335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaecfcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaecfc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaaecfd0f0>]}
[0m12:07:36.259925 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:07:53.568458 | d43deb1a-358f-4c1d-852f-5d9661a9b5be ==============================
[0m12:07:53.568458 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:07:53.571174 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:07:53.571637 [debug] [MainThread]: Tracking: tracking
[0m12:07:53.575249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f4fed060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f4fec4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f4fed000>]}
[0m12:07:53.590012 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:07:53.629481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:53.630137 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m12:07:53.643151 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m12:07:53.717079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd43deb1a-358f-4c1d-852f-5d9661a9b5be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f4f015d0>]}
[0m12:07:53.725512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd43deb1a-358f-4c1d-852f-5d9661a9b5be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f4f97820>]}
[0m12:07:53.725964 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:07:53.726398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43deb1a-358f-4c1d-852f-5d9661a9b5be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f8114790>]}
[0m12:07:53.727842 [info ] [MainThread]: 
[0m12:07:53.730395 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:53.731645 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:07:53.732129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:54.927604 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:07:54.928192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:07:55.239879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd43deb1a-358f-4c1d-852f-5d9661a9b5be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f4f978b0>]}
[0m12:07:55.240987 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:07:55.241857 [info ] [MainThread]: 
[0m12:07:55.247669 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:55.248150 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:07:55.248875 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:07:55.249199 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:55.253244 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:07:55.253940 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:07:55.249818 => 2023-05-04 12:07:55.253746
[0m12:07:55.254336 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:55.287632 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:07:55.288316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:07:55.289068 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenues
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`order_items` on order_items.product_id = products.id 
left join weekly_revenue on weekly_revenue.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:07:56.105521 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name id not found inside weekly_revenue at [21:44]')
[0m12:07:57.168896 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b7e1f13f-deca-4143-a5ab-123dafeccc5d&page=queryresults
[0m12:07:57.170225 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:07:55.254541 => 2023-05-04 12:07:57.170111
[0m12:07:57.173698 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Name id not found inside weekly_revenue at [21:44]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:07:57.174345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd43deb1a-358f-4c1d-852f-5d9661a9b5be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f4fd3ca0>]}
[0m12:07:57.174981 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.93s]
[0m12:07:57.177719 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:07:57.180128 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:07:57.180833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:57.181082 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:07:57.181349 [info ] [MainThread]: 
[0m12:07:57.181816 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m12:07:57.182419 [debug] [MainThread]: Command end result
[0m12:07:57.190355 [info ] [MainThread]: 
[0m12:07:57.190944 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:07:57.191538 [info ] [MainThread]: 
[0m12:07:57.192150 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m12:07:57.192760 [error] [MainThread]:   Name id not found inside weekly_revenue at [21:44]
[0m12:07:57.193427 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:07:57.194052 [info ] [MainThread]: 
[0m12:07:57.194617 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:07:57.195271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f4df2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f4df23b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68f4df2140>]}
[0m12:07:57.195898 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:08:31.873921 | a7bcf1ae-051c-401b-9beb-0ba56c68ca3b ==============================
[0m12:08:31.873921 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:08:31.876776 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:08:31.877129 [debug] [MainThread]: Tracking: tracking
[0m12:08:31.886644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b686080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b684940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b685270>]}
[0m12:08:31.902899 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:08:31.937421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:08:31.938118 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m12:08:31.951100 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m12:08:32.027280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7bcf1ae-051c-401b-9beb-0ba56c68ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b53d480>]}
[0m12:08:32.035232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7bcf1ae-051c-401b-9beb-0ba56c68ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b42b700>]}
[0m12:08:32.035667 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:08:32.036097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7bcf1ae-051c-401b-9beb-0ba56c68ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b42b730>]}
[0m12:08:32.037523 [info ] [MainThread]: 
[0m12:08:32.040027 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:08:32.042861 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:08:32.043394 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:33.176124 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:08:33.176701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:33.428848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7bcf1ae-051c-401b-9beb-0ba56c68ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b42aad0>]}
[0m12:08:33.429982 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:08:33.431018 [info ] [MainThread]: 
[0m12:08:33.436408 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:08:33.436992 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:08:33.438099 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:08:33.438434 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:08:33.442243 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:08:33.442900 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:08:33.438646 => 2023-05-04 12:08:33.442789
[0m12:08:33.443346 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:08:33.477461 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:08:33.478143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:33.478902 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenues
    from `analytics-engineers-club`.`coffee_shop`.`orders`  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`order_items` on order_items.product_id = products.id 
left join weekly_revenue on orders.id = order_items.order_id
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:08:34.391063 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: orders; Did you mean order_id? at [21:29]')
[0m12:08:36.107241 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e5ff1b3d-ec7e-4bf4-ad3b-e08275971e07&page=queryresults
[0m12:08:36.108741 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:08:33.443635 => 2023-05-04 12:08:36.108616
[0m12:08:36.112683 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Unrecognized name: orders; Did you mean order_id? at [21:29]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:08:36.113363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7bcf1ae-051c-401b-9beb-0ba56c68ca3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b4645b0>]}
[0m12:08:36.114147 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.68s]
[0m12:08:36.116962 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:08:36.119189 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:08:36.119785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:36.120034 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:08:36.120327 [info ] [MainThread]: 
[0m12:08:36.120761 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m12:08:36.121376 [debug] [MainThread]: Command end result
[0m12:08:36.129255 [info ] [MainThread]: 
[0m12:08:36.129912 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:08:36.130943 [info ] [MainThread]: 
[0m12:08:36.131705 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m12:08:36.132326 [error] [MainThread]:   Unrecognized name: orders; Did you mean order_id? at [21:29]
[0m12:08:36.133276 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:08:36.133851 [info ] [MainThread]: 
[0m12:08:36.134472 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:08:36.136416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b482c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b483070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f160b482b60>]}
[0m12:08:36.137019 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:09:58.570902 | e1e393cb-2875-48da-acf2-8f9ac440bdc1 ==============================
[0m12:09:58.570902 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:09:58.573966 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:09:58.574481 [debug] [MainThread]: Tracking: tracking
[0m12:09:58.582728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b38ee980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b077c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b077ce50>]}
[0m12:09:58.597891 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:09:58.633549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:09:58.634255 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m12:09:58.647535 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m12:09:58.724721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1e393cb-2875-48da-acf2-8f9ac440bdc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b0635810>]}
[0m12:09:58.732999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1e393cb-2875-48da-acf2-8f9ac440bdc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b0523a60>]}
[0m12:09:58.733503 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:09:58.733968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1e393cb-2875-48da-acf2-8f9ac440bdc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b38ee980>]}
[0m12:09:58.735399 [info ] [MainThread]: 
[0m12:09:58.737902 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:09:58.739206 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:09:58.739709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:59.945099 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:09:59.945814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:00.226120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1e393cb-2875-48da-acf2-8f9ac440bdc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b0523d00>]}
[0m12:10:00.227120 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:10:00.227615 [info ] [MainThread]: 
[0m12:10:00.232416 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:10:00.232923 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:10:00.233777 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:10:00.234074 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:10:00.237239 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:10:00.239034 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:10:00.234271 => 2023-05-04 12:10:00.238547
[0m12:10:00.239577 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:10:00.274587 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:10:00.275660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:00.276438 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenues
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    left join weekly_revenue on ordders.id = order_items.order_id  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`order_items` on order_items.product_id = products.id 
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:10:00.583019 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "weekly_revenue" must be qualified with a dataset (e.g. dataset.table).')
[0m12:10:01.703057 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9449992d-2dc7-496d-93b9-2327fd640473&page=queryresults
[0m12:10:01.704246 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:10:00.239884 => 2023-05-04 12:10:01.704140
[0m12:10:01.707801 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Table "weekly_revenue" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:10:01.708276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1e393cb-2875-48da-acf2-8f9ac440bdc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7abfa2020>]}
[0m12:10:01.708907 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.47s]
[0m12:10:01.711182 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:10:01.713214 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:10:01.714002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:01.714324 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:10:01.714695 [info ] [MainThread]: 
[0m12:10:01.722677 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m12:10:01.725620 [debug] [MainThread]: Command end result
[0m12:10:01.746145 [info ] [MainThread]: 
[0m12:10:01.746902 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:10:01.747488 [info ] [MainThread]: 
[0m12:10:01.747983 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m12:10:01.748445 [error] [MainThread]:   Table "weekly_revenue" must be qualified with a dataset (e.g. dataset.table).
[0m12:10:01.748896 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:10:01.749344 [info ] [MainThread]: 
[0m12:10:01.752303 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:10:01.754717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b077ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b077eef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7b0523940>]}
[0m12:10:01.755150 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:10:35.979909 | 94f1a1cb-5816-428a-968d-a771b0a32be2 ==============================
[0m12:10:35.979909 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:10:35.982782 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:10:35.983260 [debug] [MainThread]: Tracking: tracking
[0m12:10:36.016832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5257bc4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5254ae0610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5254ae06a0>]}
[0m12:10:36.032972 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:10:36.059916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:10:36.060687 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m12:10:36.074767 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m12:10:36.180818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94f1a1cb-5816-428a-968d-a771b0a32be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52547f9870>]}
[0m12:10:36.189317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94f1a1cb-5816-428a-968d-a771b0a32be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525488faf0>]}
[0m12:10:36.189906 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:10:36.190784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f1a1cb-5816-428a-968d-a771b0a32be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525488fb20>]}
[0m12:10:36.192496 [info ] [MainThread]: 
[0m12:10:36.194762 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:10:36.196141 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:10:36.196638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:37.296917 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:10:37.297714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:37.582230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f1a1cb-5816-428a-968d-a771b0a32be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f525488e8f0>]}
[0m12:10:37.583337 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:10:37.583917 [info ] [MainThread]: 
[0m12:10:37.588880 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:10:37.589363 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:10:37.590295 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:10:37.590594 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:10:37.594267 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:10:37.595109 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:10:37.590797 => 2023-05-04 12:10:37.595021
[0m12:10:37.595495 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:10:37.629611 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:10:37.630639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:37.631453 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenues
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    left join on orders.id = order_items.order_id  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`order_items` on order_items.product_id = products.id 
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:10:37.933210 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword ON at [13:15]')
[0m12:10:39.101255 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f4387cf9-f2a5-40be-94e2-7e00771aa175&page=queryresults
[0m12:10:39.102509 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:10:37.595806 => 2023-05-04 12:10:39.102359
[0m12:10:39.107050 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Syntax error: Unexpected keyword ON at [13:15]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:10:39.107716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f1a1cb-5816-428a-968d-a771b0a32be2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52547b69b0>]}
[0m12:10:39.108440 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.52s]
[0m12:10:39.110627 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:10:39.112810 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:10:39.113478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:39.113719 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:10:39.114037 [info ] [MainThread]: 
[0m12:10:39.114539 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m12:10:39.115344 [debug] [MainThread]: Command end result
[0m12:10:39.123506 [info ] [MainThread]: 
[0m12:10:39.124093 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:10:39.124618 [info ] [MainThread]: 
[0m12:10:39.125154 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m12:10:39.125784 [error] [MainThread]:   Syntax error: Unexpected keyword ON at [13:15]
[0m12:10:39.126390 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:10:39.126945 [info ] [MainThread]: 
[0m12:10:39.127561 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:10:39.128275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5254ae35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5254ae0220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5257bc6590>]}
[0m12:10:39.128714 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:11:03.726793 | 5cec2b72-ab5d-4f6a-b295-561cd89d0e1d ==============================
[0m12:11:03.726793 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:11:03.729692 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:11:03.730036 [debug] [MainThread]: Tracking: tracking
[0m12:11:03.741304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa9b14df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa69ec610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa69ec6a0>]}
[0m12:11:03.756918 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:11:03.791377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:03.792054 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m12:11:03.805956 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m12:11:03.885086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cec2b72-ab5d-4f6a-b295-561cd89d0e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa6901870>]}
[0m12:11:03.893253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cec2b72-ab5d-4f6a-b295-561cd89d0e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa6997af0>]}
[0m12:11:03.893759 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:11:03.894538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cec2b72-ab5d-4f6a-b295-561cd89d0e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa6997b20>]}
[0m12:11:03.896421 [info ] [MainThread]: 
[0m12:11:03.898785 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:03.900083 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:11:03.900561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:04.959376 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:11:04.960104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:05.270885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cec2b72-ab5d-4f6a-b295-561cd89d0e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa69968f0>]}
[0m12:11:05.271951 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:11:05.272842 [info ] [MainThread]: 
[0m12:11:05.278083 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:05.278553 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:11:05.279880 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:11:05.280295 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:05.284359 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:11:05.284933 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:11:05.280627 => 2023-05-04 12:11:05.284807
[0m12:11:05.285351 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:05.317372 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:11:05.318139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:05.318907 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenues
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    left join order_items on orders.id = order_items.order_id  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`order_items` on order_items.product_id = products.id 
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:11:05.991863 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "order_items" must be qualified with a dataset (e.g. dataset.table).')
[0m12:11:06.301995 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ba3afb03-d5c9-4ed7-b184-412a12f5aef8&page=queryresults
[0m12:11:06.303155 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:11:05.285607 => 2023-05-04 12:11:06.303036
[0m12:11:06.307199 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Table "order_items" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:11:06.307838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cec2b72-ab5d-4f6a-b295-561cd89d0e1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa69d3cd0>]}
[0m12:11:06.308610 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.03s]
[0m12:11:06.310884 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:06.313151 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:06.313789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:06.314035 [debug] [MainThread]: Connection 'list_aec-students' was properly closed.
[0m12:11:06.314336 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:11:06.314629 [info ] [MainThread]: 
[0m12:11:06.315076 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.42 seconds (2.42s).
[0m12:11:06.315638 [debug] [MainThread]: Command end result
[0m12:11:06.323271 [info ] [MainThread]: 
[0m12:11:06.323794 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:11:06.324274 [info ] [MainThread]: 
[0m12:11:06.324780 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m12:11:06.325640 [error] [MainThread]:   Table "order_items" must be qualified with a dataset (e.g. dataset.table).
[0m12:11:06.326109 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:11:06.326947 [info ] [MainThread]: 
[0m12:11:06.327416 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:11:06.328018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa9b14df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafaaa823e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafa6a06530>]}
[0m12:11:06.328722 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:11:21.959713 | 06bf336f-ad15-4931-ab54-60c9bc134c9c ==============================
[0m12:11:21.959713 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:11:21.962557 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:11:21.963045 [debug] [MainThread]: Tracking: tracking
[0m12:11:21.968715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc320715cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31d7886a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31d788970>]}
[0m12:11:21.984523 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:11:22.022677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:22.023415 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m12:11:22.036385 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m12:11:22.116774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06bf336f-ad15-4931-ab54-60c9bc134c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31d63d7e0>]}
[0m12:11:22.125231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06bf336f-ad15-4931-ab54-60c9bc134c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31d52fa60>]}
[0m12:11:22.125720 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:11:22.126172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06bf336f-ad15-4931-ab54-60c9bc134c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31d52fa90>]}
[0m12:11:22.127602 [info ] [MainThread]: 
[0m12:11:22.131011 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:22.132498 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:11:22.132998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:23.260462 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:11:23.261238 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:23.575435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06bf336f-ad15-4931-ab54-60c9bc134c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31d52fc70>]}
[0m12:11:23.576713 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:11:23.577470 [info ] [MainThread]: 
[0m12:11:23.583055 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:23.583561 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:11:23.584365 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:11:23.584686 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:23.590248 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:11:23.591088 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:11:23.584899 => 2023-05-04 12:11:23.590984
[0m12:11:23.591511 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:23.626623 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:11:23.627380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:23.628115 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenues
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    left join `analytics-engineers-club`.`coffee_shop`.`orders` on orders.id = order_items.order_id  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`order_items` on order_items.product_id = products.id 
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:11:24.477690 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Duplicate table alias orders in the same FROM clause at [13:15]')
[0m12:11:26.127688 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:104b7c3c-cb7f-4f94-8291-f8a2523cb893&page=queryresults
[0m12:11:26.128737 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:11:23.591857 => 2023-05-04 12:11:26.128596
[0m12:11:26.132188 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Duplicate table alias orders in the same FROM clause at [13:15]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:11:26.132738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06bf336f-ad15-4931-ab54-60c9bc134c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31d0529b0>]}
[0m12:11:26.133359 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 2.55s]
[0m12:11:26.136139 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:26.138273 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:26.138902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:26.139161 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:11:26.139511 [info ] [MainThread]: 
[0m12:11:26.139949 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m12:11:26.140553 [debug] [MainThread]: Command end result
[0m12:11:26.148635 [info ] [MainThread]: 
[0m12:11:26.149300 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:11:26.149883 [info ] [MainThread]: 
[0m12:11:26.150825 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m12:11:26.151752 [error] [MainThread]:   Duplicate table alias orders in the same FROM clause at [13:15]
[0m12:11:26.152587 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:11:26.153113 [info ] [MainThread]: 
[0m12:11:26.154220 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:11:26.157982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc320715cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31d52f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31d52f5b0>]}
[0m12:11:26.158591 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:11:56.842477 | ea498b91-fd6f-4daf-809e-90c8e374c142 ==============================
[0m12:11:56.842477 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:11:56.845150 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:11:56.845511 [debug] [MainThread]: Tracking: tracking
[0m12:11:56.851879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73ce4100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73ce57e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73ce5450>]}
[0m12:11:56.868362 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:11:56.904870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:56.905642 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m12:11:56.920152 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m12:11:57.004453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea498b91-fd6f-4daf-809e-90c8e374c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c739fcf10>]}
[0m12:11:57.015416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea498b91-fd6f-4daf-809e-90c8e374c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73a97190>]}
[0m12:11:57.015887 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:11:57.016337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea498b91-fd6f-4daf-809e-90c8e374c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73a971c0>]}
[0m12:11:57.017794 [info ] [MainThread]: 
[0m12:11:57.020437 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:11:57.021905 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:11:57.022342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:58.176360 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:11:58.177063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:58.476767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea498b91-fd6f-4daf-809e-90c8e374c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73a97790>]}
[0m12:11:58.477934 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:11:58.478904 [info ] [MainThread]: 
[0m12:11:58.483917 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:58.484373 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:11:58.485212 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:11:58.485573 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:58.489258 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:11:58.490109 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:11:58.485813 => 2023-05-04 12:11:58.490008
[0m12:11:58.490489 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:11:58.523535 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:11:58.524554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:58.525335 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenues
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    left join `analytics-engineers-club`.`coffee_shop`.`order_items` on orders.id = order_items.order_id  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`order_items` on order_items.product_id = products.id 
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:11:59.276727 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: weekly_total_revenue; Did you mean weekly_total_revenues? at [26:7]')
[0m12:12:00.172758 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b5056794-4d7f-44a5-83aa-8334f67bc3d0&page=queryresults
[0m12:12:00.174017 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:11:58.490769 => 2023-05-04 12:12:00.173864
[0m12:12:00.177536 [debug] [Thread-1 (]: Database Error in model weekly_revenue (models/staging/weekly_revenue.sql)
  Unrecognized name: weekly_total_revenue; Did you mean weekly_total_revenues? at [26:7]
  compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:12:00.178158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea498b91-fd6f-4daf-809e-90c8e374c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73acefb0>]}
[0m12:12:00.178994 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_kimwkho.weekly_revenue ................ [[31mERROR[0m in 1.69s]
[0m12:12:00.181469 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:12:00.183466 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:12:00.184080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:00.184320 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:12:00.184653 [info ] [MainThread]: 
[0m12:12:00.185114 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m12:12:00.185975 [debug] [MainThread]: Command end result
[0m12:12:00.193742 [info ] [MainThread]: 
[0m12:12:00.194395 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:12:00.194992 [info ] [MainThread]: 
[0m12:12:00.195765 [error] [MainThread]: [33mDatabase Error in model weekly_revenue (models/staging/weekly_revenue.sql)[0m
[0m12:12:00.196258 [error] [MainThread]:   Unrecognized name: weekly_total_revenue; Did you mean weekly_total_revenues? at [26:7]
[0m12:12:00.196740 [error] [MainThread]:   compiled Code at target/run/coffee_shop_kimwkho/models/staging/weekly_revenue.sql
[0m12:12:00.197548 [info ] [MainThread]: 
[0m12:12:00.198341 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:12:00.198968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73ce7160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73acf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c73acc790>]}
[0m12:12:00.199716 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 12:12:16.170327 | e703409c-ee08-4e77-adde-f07143c4483b ==============================
[0m12:12:16.170327 [info ] [MainThread]: Running with dbt=1.4.5
[0m12:12:16.173197 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['weekly_revenue'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m12:12:16.173591 [debug] [MainThread]: Tracking: tracking
[0m12:12:16.186674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2015ff08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2015ff0fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2015ff07f0>]}
[0m12:12:16.210886 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m12:12:16.256303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:12:16.257206 [debug] [MainThread]: Partial parsing: updated file: coffee_shop_kimwkho://models/staging/weekly_revenue.sql
[0m12:12:16.280168 [debug] [MainThread]: 1699: static parser successfully parsed staging/weekly_revenue.sql
[0m12:12:16.358657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e703409c-ee08-4e77-adde-f07143c4483b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2015f052a0>]}
[0m12:12:16.366717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e703409c-ee08-4e77-adde-f07143c4483b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2015f9b4f0>]}
[0m12:12:16.367150 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m12:12:16.367589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e703409c-ee08-4e77-adde-f07143c4483b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f201911a590>]}
[0m12:12:16.369536 [info ] [MainThread]: 
[0m12:12:16.371738 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:12:16.372990 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m12:12:16.373633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:17.573497 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m12:12:17.574185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:17.907978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e703409c-ee08-4e77-adde-f07143c4483b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2015f9a8c0>]}
[0m12:12:17.909556 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m12:12:17.910400 [info ] [MainThread]: 
[0m12:12:17.915367 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:12:17.915838 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m12:12:17.916749 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m12:12:17.917087 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m12:12:17.920668 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:12:17.921227 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 12:12:17.917297 => 2023-05-04 12:12:17.921126
[0m12:12:17.921641 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m12:12:17.958634 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m12:12:17.959338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:17.960103 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    left join `analytics-engineers-club`.`coffee_shop`.`order_items` on orders.id = order_items.order_id  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`order_items` on order_items.product_id = products.id 
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m12:12:19.014918 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7e1db494-41a9-42fb-9a06-e07c2f369e63&page=queryresults
[0m12:12:19.031890 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 12:12:17.921889 => 2023-05-04 12:12:19.031816
[0m12:12:19.032840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e703409c-ee08-4e77-adde-f07143c4483b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2015f07190>]}
[0m12:12:19.033598 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_kimwkho.weekly_revenue .................... [[32mCREATE VIEW (0 processed)[0m in 1.12s]
[0m12:12:19.035786 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m12:12:19.037997 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:12:19.039021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:19.039392 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m12:12:19.039774 [info ] [MainThread]: 
[0m12:12:19.040172 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m12:12:19.040651 [debug] [MainThread]: Command end result
[0m12:12:19.048438 [info ] [MainThread]: 
[0m12:12:19.049381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:19.049921 [info ] [MainThread]: 
[0m12:12:19.050486 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:12:19.051100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2015f9a200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2015f9b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2015f9bca0>]}
[0m12:12:19.051753 [debug] [MainThread]: Flushing usage events


============================== 2023-05-04 14:28:38.865777 | 1d7333dc-d2dd-4316-92eb-3b5516593a7c ==============================
[0m14:28:38.865777 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:28:38.883053 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:28:38.883755 [debug] [MainThread]: Tracking: tracking
[0m14:28:38.892726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ea810dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e76ec610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e76ec6a0>]}
[0m14:28:38.921814 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:28:39.114266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:28:39.114603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:28:39.120949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d7333dc-d2dd-4316-92eb-3b5516593a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e76d4af0>]}
[0m14:28:39.128625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d7333dc-d2dd-4316-92eb-3b5516593a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e75fcfd0>]}
[0m14:28:39.129058 [info ] [MainThread]: Found 3 models, 13 tests, 0 snapshots, 0 analyses, 337 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics
[0m14:28:39.129454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d7333dc-d2dd-4316-92eb-3b5516593a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e75fd030>]}
[0m14:28:39.131501 [info ] [MainThread]: 
[0m14:28:39.133680 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:28:39.135084 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:28:39.135586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:43.998802 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_kimwkho'
[0m14:28:43.999330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:44.282378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d7333dc-d2dd-4316-92eb-3b5516593a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e76ed060>]}
[0m14:28:44.283280 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:28:44.283716 [info ] [MainThread]: 
[0m14:28:44.307311 [debug] [Thread-1 (]: Began running node model.coffee_shop_kimwkho.customers
[0m14:28:44.307666 [debug] [Thread-2 (]: Began running node model.coffee_shop_kimwkho.weekly_revenue
[0m14:28:44.308134 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_kimwkho.customers ............................. [RUN]
[0m14:28:44.309692 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.customers'
[0m14:28:44.308573 [info ] [Thread-2 (]: 2 of 3 START sql view model dbt_kimwkho.weekly_revenue ......................... [RUN]
[0m14:28:44.312146 [debug] [Thread-1 (]: Began compiling node model.coffee_shop_kimwkho.customers
[0m14:28:44.312865 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.weekly_revenue'
[0m14:28:44.314235 [debug] [Thread-2 (]: Began compiling node model.coffee_shop_kimwkho.weekly_revenue
[0m14:28:44.317487 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m14:28:44.319193 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (compile): 2023-05-04 14:28:44.314515 => 2023-05-04 14:28:44.319065
[0m14:28:44.319920 [debug] [Thread-2 (]: Began executing node model.coffee_shop_kimwkho.weekly_revenue
[0m14:28:44.386903 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.customers"
[0m14:28:44.406405 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.weekly_revenue"
[0m14:28:44.407084 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:28:44.408047 [debug] [Thread-2 (]: On model.coffee_shop_kimwkho.weekly_revenue: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.weekly_revenue"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`weekly_revenue`
  OPTIONS()
  as -- show weekly revenue per product category

with weekly_revenue as (
    select 
        timestamp_trunc(created_at, week) as week_of
        , sum(total) as weekly_total_revenue
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    left join `analytics-engineers-club`.`coffee_shop`.`order_items` on orders.id = order_items.order_id  
    group by 1
),

ordered_items as (
    select
        category as product_category
    from `analytics-engineers-club`.`coffee_shop`.`products` 
left join `analytics-engineers-club`.`coffee_shop`.`order_items` on order_items.product_id = products.id 
)

select
    week_of
    , weekly_total_revenue
    , product_category
from weekly_revenue, ordered_items;


[0m14:28:44.408349 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (compile): 2023-05-04 14:28:44.313135 => 2023-05-04 14:28:44.408273
[0m14:28:44.410359 [debug] [Thread-1 (]: Began executing node model.coffee_shop_kimwkho.customers
[0m14:28:44.421483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:44.824336 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.customers"
[0m14:28:44.825340 [debug] [Thread-1 (]: On model.coffee_shop_kimwkho.customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.customers"} */

  
    

    create or replace table `aec-students`.`dbt_kimwkho`.`customers`
    
    
    OPTIONS()
    as (
      

with customer_orders as (
    select
        customer_id
        , count(*) as n_orders
        , min(created_at) as first_order_at
    from `analytics-engineers-club`.`coffee_shop`.`orders`
    group by 1
)

select 
    customers.id as customer_id
    , customers.name
    , customers.email
    , coalesce(customer_orders.n_orders, 0) as n_orders
    , customer_orders.first_order_at
from `analytics-engineers-club`.`coffee_shop`.`customers` as customers 
left join customer_orders
    on id = customer_orders.customer_id
    );
  
[0m14:28:45.462054 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:461f161a-1283-4797-b416-fc912cdcffd2&page=queryresults
[0m14:28:45.478964 [debug] [Thread-2 (]: Timing info for model.coffee_shop_kimwkho.weekly_revenue (execute): 2023-05-04 14:28:44.320243 => 2023-05-04 14:28:45.478887
[0m14:28:45.479933 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d7333dc-d2dd-4316-92eb-3b5516593a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e78664d0>]}
[0m14:28:45.480538 [info ] [Thread-2 (]: 2 of 3 OK created sql view model dbt_kimwkho.weekly_revenue .................... [[32mCREATE VIEW (0 processed)[0m in 1.17s]
[0m14:28:45.482772 [debug] [Thread-2 (]: Finished running node model.coffee_shop_kimwkho.weekly_revenue
[0m14:28:49.593227 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d9c9449c-ad7a-458e-a4d6-a2eca936f430&page=queryresults
[0m14:28:49.595253 [debug] [Thread-1 (]: Timing info for model.coffee_shop_kimwkho.customers (execute): 2023-05-04 14:28:44.410754 => 2023-05-04 14:28:49.595190
[0m14:28:49.596063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d7333dc-d2dd-4316-92eb-3b5516593a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e76bf580>]}
[0m14:28:49.596623 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_kimwkho.customers ........................ [[32mCREATE TABLE (174.4k rows, 21.3 MB processed)[0m in 5.29s]
[0m14:28:49.597481 [debug] [Thread-1 (]: Finished running node model.coffee_shop_kimwkho.customers
[0m14:28:49.598431 [debug] [Thread-4 (]: Began running node model.coffee_shop_kimwkho.monthly_customers
[0m14:28:49.598910 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_kimwkho.monthly_customers ...................... [RUN]
[0m14:28:49.599968 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop_kimwkho.monthly_customers'
[0m14:28:49.600237 [debug] [Thread-4 (]: Began compiling node model.coffee_shop_kimwkho.monthly_customers
[0m14:28:49.603362 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop_kimwkho.monthly_customers"
[0m14:28:49.603857 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (compile): 2023-05-04 14:28:49.600405 => 2023-05-04 14:28:49.603773
[0m14:28:49.604209 [debug] [Thread-4 (]: Began executing node model.coffee_shop_kimwkho.monthly_customers
[0m14:28:49.607059 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop_kimwkho.monthly_customers"
[0m14:28:49.608044 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:28:49.608459 [debug] [Thread-4 (]: On model.coffee_shop_kimwkho.monthly_customers: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "coffee_shop_kimwkho", "target_name": "dev", "node_id": "model.coffee_shop_kimwkho.monthly_customers"} */


  create or replace view `aec-students`.`dbt_kimwkho`.`monthly_customers`
  OPTIONS()
  as select
    date_trunc(first_order_at, month) as signup_month,
    count(*) as new_customers
 
from `aec-students`.`dbt_kimwkho`.`customers`
 
group by 1;


[0m14:28:50.442628 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5f1ec99e-6b29-4f0f-adef-1620cb6227dd&page=queryresults
[0m14:28:50.444765 [debug] [Thread-4 (]: Timing info for model.coffee_shop_kimwkho.monthly_customers (execute): 2023-05-04 14:28:49.604387 => 2023-05-04 14:28:50.444703
[0m14:28:50.445596 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d7333dc-d2dd-4316-92eb-3b5516593a7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e76d4130>]}
[0m14:28:50.446150 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_kimwkho.monthly_customers ................. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m14:28:50.446735 [debug] [Thread-4 (]: Finished running node model.coffee_shop_kimwkho.monthly_customers
[0m14:28:50.450112 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:28:50.450691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:50.450907 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.customers' was properly closed.
[0m14:28:50.451109 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.weekly_revenue' was properly closed.
[0m14:28:50.451615 [debug] [MainThread]: Connection 'model.coffee_shop_kimwkho.monthly_customers' was properly closed.
[0m14:28:50.452069 [info ] [MainThread]: 
[0m14:28:50.452452 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 11.32 seconds (11.32s).
[0m14:28:50.453546 [debug] [MainThread]: Command end result
[0m14:28:50.465904 [info ] [MainThread]: 
[0m14:28:50.466430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:28:50.466904 [info ] [MainThread]: 
[0m14:28:50.467395 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:28:50.467981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9eb7fe3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e7c48670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9e7c49750>]}
[0m14:28:50.468686 [debug] [MainThread]: Flushing usage events
